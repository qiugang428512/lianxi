!function(t,e,i){var s=(i.un,i.uns,i.static),n=i.class,h=i.getset,r=i.__newvec,o=laya.utils.Browser,a=laya.utils.Byte,l=laya.filters.ColorFilter,u=laya.events.Event,_=laya.events.EventDispatcher,c=(laya.display.Graphics,laya.html.dom.HTMLDivElement),d=laya.utils.Handler,f=laya.utils.HitArea,g=laya.display.Input,p=(laya.net.Loader,laya.utils.Log),m=(laya.display.Node,laya.maths.Point),v=laya.maths.Rectangle,y=laya.renders.Render,w=laya.media.SoundManager,b=laya.display.Sprite,C=(laya.display.Stage,laya.display.Text),x=laya.resource.Texture,S=laya.utils.Utils;i.interface("fairygui.IUISource"),i.interface("fairygui.gears.IColorGear"),i.interface("fairygui.gears.IAnimationGear");var I=function(){function t(){}return n(t,"fairygui.utils.ToolSet"),t.getFileName=function(t){var e=t.lastIndexOf("/");return-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("\\"),-1!=e&&(t=t.substr(e+1)),e=t.lastIndexOf("."),-1!=e?t.substring(0,e):t},t.startsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},t.endsWith=function(t,e,i){return void 0===i&&(i=!1),t?t.length<e.length?!1:(t=t.substring(t.length-e.length),i?t.toLowerCase()==e.toLowerCase():t==e):!1},t.trim=function(t){return fairygui.utils.ToolSet.trimLeft(fairygui.utils.ToolSet.trimRight(t))},t.trimLeft=function(t){for(var e="",i=0;i<t.length&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i++);return t.substr(i)},t.trimRight=function(t){for(var e="",i=t.length-1;i>=0&&(e=t.charAt(i)," "==e||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)},t.convertToHtmlColor=function(t,e){void 0===e&&(e=!1);var i;i=e?(t>>24&255).toString(16):"";var s=(t>>16&255).toString(16),n=(t>>8&255).toString(16),h=(255&t).toString(16);return 1==i.length&&(i="0"+i),1==s.length&&(s="0"+s),1==n.length&&(n="0"+n),1==h.length&&(h="0"+h),"#"+i+s+n+h},t.convertFromHtmlColor=function(t,e){return void 0===e&&(e=!1),t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16))},t.displayObjectToGObject=function(t){for(;null!=t&&!(t instanceof laya.display.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null},t.encodeHTML=function(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""},t.parseUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t)},t.removeUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t,!0)},t.clamp=function(t,e,i){return e>t?t=e:t>i&&(t=i),t},t.clamp01=function(t){return t>1?t=1:0>t&&(t=0),t},t.lerp=function(t,e,i){return t+i*(e-t)},s(t,["defaultUBBParser",function(){return this.defaultUBBParser=new O}]),t}(),k=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}n(t,"fairygui.Margin");var e=t.prototype;return e.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t}(),P=(function(){function t(){}return n(t,"fairygui.GroupLayoutType"),t.None=0,t.Horizontal=1,t.Vertical=2,t}(),function(){function t(){this.data=null,this.packageItem=null,this._x=0,this._y=0,this._alpha=1,this._rotation=0,this._visible=!0,this._touchable=!0,this._grayed=!1,this._draggable=!1,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._pivotX=0,this._pivotY=0,this._pivotAsAnchor=!1,this._pivotOffsetX=0,this._pivotOffsetY=0,this._sortingOrder=0,this._internalVisible=!0,this._handlingController=!1,this._focusable=!1,this._tooltips=null,this._pixelSnapping=!1,this._relations=null,this._group=null,this._gears=null,this._dragBounds=null,this._displayObject=null,this._yOffset=0,this.minWidth=0,this.minHeight=0,this.maxWidth=0,this.maxHeight=0,this.sourceWidth=0,this.sourceHeight=0,this.initWidth=0,this.initHeight=0,this._parent=null,this._width=0,this._height=0,this._rawWidth=0,this._rawHeight=0,this._id=null,this._name=null,this._underConstruct=!1,this._gearLocked=!1,this._sizePercentInGroup=0,this._touchDownPoint=null,this._id=""+fairygui.GObject._gInstanceCounter++,this._name="",this.createDisplayObject(),this._relations=new M(this),this._gears=r(8,null)}n(t,"fairygui.GObject");var e=t.prototype;return e.setXY=function(e,i){if(this._x!=e||this._y!=i){var s=e-this._x,n=i-this._y;this._x=e,this._y=i,this.handleXYChanged(),this instanceof fairygui.GGroup&&this.moveChildren(s,n),this.updateGear(1),!this._parent||this._parent instanceof fairygui.GList||(this._parent.setBoundsChangedFlag(),null!=this._group&&this._group.setBoundsChangedFlag(),this.displayObject.event("fui_xy_changed")),t.draggingObject!=this||t.sUpdateInDragging||this.localToGlobalRect(0,0,this.width,this.height,t.sGlobalRect)}},e.center=function(t){void 0===t&&(t=!1);var e;e=null!=this._parent?this.parent:this.root,this.setXY((e.width-this.width)/2,(e.height-this.height)/2),t&&(this.addRelation(e,3),this.addRelation(e,10))},e.setSize=function(t,e,i){if(void 0===i&&(i=!1),this._rawWidth!=t||this._rawHeight!=e){this._rawWidth=t,this._rawHeight=e,t<this.minWidth&&(t=this.minWidth),e<this.minHeight&&(e=this.minHeight),this.maxWidth>0&&t>this.maxWidth&&(t=this.maxWidth),this.maxHeight>0&&e>this.maxHeight&&(e=this.maxHeight);var s=t-this._width,n=e-this._height;this._width=t,this._height=e,this.handleSizeChanged(),(0!=this._pivotX||0!=this._pivotY)&&(this._pivotAsAnchor?this.applyPivot():(i||this.setXY(this.x-this._pivotX*s,this.y-this._pivotY*n),this.updatePivotOffset())),this instanceof fairygui.GGroup&&this.resizeChildren(s,n),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(s,n,this._pivotAsAnchor||!i),this._parent.setBoundsChangedFlag(),null!=this._group&&this._group.setBoundsChangedFlag(!0)),this.displayObject.event("fui_size_changed")}},e.ensureSizeCorrect=function(){},e.setScale=function(t,e){(this._scaleX!=t||this._scaleY!=e)&&(this._scaleX=t,this._scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))},e.setSkew=function(t,e){(this._skewX!=t||this._skewY!=e)&&(this._skewX=t,this._skewY=e,null!=this._displayObject&&(this._displayObject.skew(-t,e),this.applyPivot()))},e.setPivot=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),(this._pivotX!=t||this._pivotY!=e||this._pivotAsAnchor!=i)&&(this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())},e.internalSetPivot=function(t,e,i){this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this._pivotAsAnchor&&this.handleXYChanged()},e.updatePivotOffset=function(){if(null!=this._displayObject)if(!this._displayObject.transform||0==this._pivotX&&0==this._pivotY)this._pivotOffsetX=0,this._pivotOffsetY=0;else{fairygui.GObject.sHelperPoint.x=this._pivotX*this._width,fairygui.GObject.sHelperPoint.y=this._pivotY*this._height;var t=this._displayObject.transform.transformPoint(fairygui.GObject.sHelperPoint);this._pivotOffsetX=this._pivotX*this._width-t.x,this._pivotOffsetY=this._pivotY*this._height-t.y}},e.applyPivot=function(){(0!=this._pivotX||0!=this._pivotY)&&(this.updatePivotOffset(),this.handleXYChanged())},e.requestFocus=function(){for(var t=this;t&&!t._focusable;)t=t.parent;null!=t&&(this.root.focus=t)},e.__rollOver=function(){i.timer.once(100,this,this.__doShowTooltips)},e.__doShowTooltips=function(){var t=this.root;t&&this.root.showTooltips(this._tooltips)},e.__rollOut=function(){i.timer.clear(this,this.__doShowTooltips),this.root.hideTooltips()},e.getGear=function(t){var e=this._gears[t];if(null==e){switch(t){case 0:e=new Se(this);break;case 1:e=new we(this);break;case 2:e=new xe(this);break;case 3:e=new ge(this);break;case 4:e=new pe(this);break;case 5:e=new be(this);break;case 6:e=new ve(this);break;case 7:e=new de(this);break;default:throw new Error("FairyGUI: invalid gear index!")}this._gears[t]=e}return e},e.updateGear=function(t){if(!this._underConstruct&&!this._gearLocked){var e=this._gears[t];null!=e&&null!=e.controller&&e.updateState()}},e.checkGearController=function(t,e){return null!=this._gears[t]&&this._gears[t].controller==e},e.updateGearFromRelations=function(t,e,i){null!=this._gears[t]&&this._gears[t].updateFromRelations(e,i)},e.addDisplayLock=function(){var t=this._gears[0];if(t&&t.controller){var e=t.addLock();return this.checkGearDisplay(),e}return 0},e.releaseDisplayLock=function(t){var e=this._gears[0];e&&e.controller&&(e.releaseLock(t),this.checkGearDisplay())},e.checkGearDisplay=function(){if(!this._handlingController){var t=null==this._gears[0]||this._gears[0].connected;t!=this._internalVisible&&(this._internalVisible=t,this._parent&&this._parent.childStateChanged(this))}},e.addRelation=function(t,e,i){void 0===i&&(i=!1),this._relations.add(t,e,i)},e.removeRelation=function(t,e){void 0===e&&(e=0),this._relations.remove(t,e)},e.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},e.dispose=function(){this.removeFromParent(),this._relations.dispose(),this._displayObject.destroy(),this._displayObject=null;for(var t=0;8>t;t++){var e=this._gears[t];null!=e&&e.dispose()}},e.onClick=function(t,e,i){this.on("click",t,e,i)},e.offClick=function(t,e){this.off("click",t,e)},e.hasClickListener=function(){return this._displayObject.hasListener("click")},e.on=function(t,e,i,s){this._displayObject.on(t,e,i,s)},e.off=function(t,e,i){this._displayObject.off(t,e,i)},e.startDrag=function(t){void 0===t&&(t=-1),null!=this._displayObject.stage&&this.dragBegin()},e.stopDrag=function(){this.dragEnd()},e.localToGlobal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),this._pivotAsAnchor&&(t+=this._pivotX*this._width,e+=this._pivotY*this._height),i?(i.x=t,i.y=e,this._displayObject.localToGlobal(i,!1)):(i=fairygui.GObject.sHelperPoint,i.x=t,i.y=e,this._displayObject.localToGlobal(i,!0))},e.globalToLocal=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),i?(i.x=t,i.y=e,this._displayObject.globalToLocal(i,!1)):(i=fairygui.GObject.sHelperPoint,i.x=t,i.y=e,i=this._displayObject.globalToLocal(i,!0)),this._pivotAsAnchor&&(i.x-=this._pivotX*this._width,i.y-=this._pivotY*this._height),i},e.localToGlobalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new v);var h=this.localToGlobal(t,e);return n.x=h.x,n.y=h.y,h=this.localToGlobal(t+i,e+s),n.width=h.x-n.x,n.height=h.y-n.y,n},e.globalToLocalRect=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),null==n&&(n=new v);var h=this.globalToLocal(t,e);return n.x=h.x,n.y=h.y,h=this.globalToLocal(t+i,e+s),n.width=h.x-n.x,n.height=h.y-n.y,n},e.handleControllerChanged=function(t){this._handlingController=!0;for(var e=0;8>e;e++){var i=this._gears[e];null!=i&&i.controller==t&&i.apply()}this._handlingController=!1,this.checkGearDisplay()},e.createDisplayObject=function(){this._displayObject=new b,this._displayObject.$owner=this},e.handleXYChanged=function(){var t=this._x,e=this._y+this._yOffset;this._pivotAsAnchor&&(t-=this._pivotX*this._width,e-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._displayObject.pos(t+this._pivotOffsetX,e+this._pivotOffsetY)},e.handleSizeChanged=function(){null!=this._displayObject&&this._displayObject.size(this._width,this._height)},e.handleScaleChanged=function(){null!=this._displayObject&&this._displayObject.scale(this._scaleX,this._scaleY)},e.handleGrayedChanged=function(){this._displayObject&&(this._grayed?(null==t.grayFilter&&(t.grayFilter=new l([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])),this._displayObject.filters=[t.grayFilter]):this._displayObject.filters=null)},e.handleAlphaChanged=function(){this._displayObject&&(this._displayObject.alpha=this._alpha)},e.handleVisibleChanged=function(){this._displayObject&&(this._displayObject.visible=this.internalVisible2)},e.constructFromResource=function(){},e.setup_beforeAdd=function(t,e){t.seek(e,0),t.skip(5);var i=0/0,s=0/0;this._id=t.readS(),this._name=t.readS(),i=t.getInt32(),s=t.getInt32(),this.setXY(i,s),t.readBool()&&(this.initWidth=t.getInt32(),this.initHeight=t.getInt32(),this.setSize(this.initWidth,this.initHeight,!0)),t.readBool()&&(this.minWidth=t.getInt32(),this.maxWidth=t.getInt32(),this.minHeight=t.getInt32(),this.maxHeight=t.getInt32()),t.readBool()&&(i=t.getFloat32(),s=t.getFloat32(),this.setScale(i,s)),t.readBool()&&(i=t.getFloat32(),s=t.getFloat32(),this.setSkew(i,s)),t.readBool()&&(i=t.getFloat32(),s=t.getFloat32(),this.setPivot(i,s,t.readBool())),i=t.getFloat32(),1!=i&&(this.alpha=i),i=t.getFloat32(),0!=i&&(this.rotation=i),t.readBool()||(this.visible=!1),t.readBool()||(this.touchable=!1),t.readBool()&&(this.grayed=!0);var n=t.readByte();2==n&&(this.blendMode="lighter");var h=t.readByte();if(1==h){var r=new se;r.adjustBrightness(t.getFloat32()),r.adjustContrast(t.getFloat32()),r.adjustSaturation(t.getFloat32()),r.adjustHue(t.getFloat32());var o=new l(r);this.filters=[o]}var a=t.readS();null!=a&&(this.data=a)},e.setup_afterAdd=function(t,e){t.seek(e,1);var i=t.readS();null!=i&&(this.tooltips=i);var s=t.getInt16();s>=0&&(this.group=this.parent.getChildAt(s)),t.seek(e,2);for(var n=t.getInt16(),h=0;n>h;h++){var r=t.getInt16();r+=t.pos;var o=this.getGear(t.readByte());o.setup(t),t.pos=r}},e.initDrag=function(){this._draggable?this.on("mousedown",this,this.__begin):this.off("mousedown",this,this.__begin)},e.dragBegin=function(){null!=fairygui.GObject.draggingObject&&fairygui.GObject.draggingObject.stopDrag(),fairygui.GObject.sGlobalDragStart.x=i.stage.mouseX,fairygui.GObject.sGlobalDragStart.y=i.stage.mouseY,this.localToGlobalRect(0,0,this.width,this.height,fairygui.GObject.sGlobalRect),fairygui.GObject.draggingObject=this,i.stage.on("mousemove",this,this.__moving2),i.stage.on("mouseup",this,this.__end2)},e.dragEnd=function(){fairygui.GObject.draggingObject==this&&(i.stage.off("mousemove",this,this.__moving2),i.stage.off("mouseup",this,this.__end2),fairygui.GObject.draggingObject=null),fairygui.GObject.sDraggingQuery=!1},e.reset=function(){i.stage.off("mousemove",this,this.__moving),i.stage.off("mouseup",this,this.__end)},e.__begin=function(){null==this._touchDownPoint&&(this._touchDownPoint=new m),this._touchDownPoint.x=i.stage.mouseX,this._touchDownPoint.y=i.stage.mouseY,i.stage.on("mousemove",this,this.__moving),i.stage.on("mouseup",this,this.__end)},e.__end=function(){this.reset()},e.__moving=function(t){var e=ie.touchDragSensitivity;null!=this._touchDownPoint&&Math.abs(this._touchDownPoint.x-i.stage.mouseX)<e&&Math.abs(this._touchDownPoint.y-i.stage.mouseY)<e||(this.reset(),fairygui.GObject.sDraggingQuery=!0,j.dispatch("fui_drag_start",this._displayObject,t),fairygui.GObject.sDraggingQuery&&this.dragBegin())},e.__moving2=function(e){var s=i.stage.mouseX-fairygui.GObject.sGlobalDragStart.x+fairygui.GObject.sGlobalRect.x,n=i.stage.mouseY-fairygui.GObject.sGlobalDragStart.y+fairygui.GObject.sGlobalRect.y;if(null!=this._dragBounds){var h=je.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,fairygui.GObject.sDragHelperRect);s<h.x?s=h.x:s+fairygui.GObject.sGlobalRect.width>h.right&&(s=h.right-fairygui.GObject.sGlobalRect.width,s<h.x&&(s=h.x)),n<h.y?n=h.y:n+fairygui.GObject.sGlobalRect.height>h.bottom&&(n=h.bottom-fairygui.GObject.sGlobalRect.height,n<h.y&&(n=h.y))}t.sUpdateInDragging=!0;var r=this.parent.globalToLocal(s,n,fairygui.GObject.sHelperPoint);this.setXY(Math.round(r.x),Math.round(r.y)),t.sUpdateInDragging=!1,j.dispatch("fui_drag_move",this._displayObject,e)},e.__end2=function(t){fairygui.GObject.draggingObject==this&&(this.stopDrag(),j.dispatch("fui_drag_end",this._displayObject,t))},h(0,e,"yMin",function(){return this._pivotAsAnchor?this._y-this._height*this._pivotY:this._y},function(t){this._pivotAsAnchor?this.setXY(this._x,t+this._height*this._pivotY):this.setXY(this._x,t)}),h(0,e,"id",function(){return this._id}),h(0,e,"name",function(){return this._name},function(t){this._name=t}),h(0,e,"rotation",function(){return this._rotation},function(t){this._rotation!=t&&(this._rotation=t,null!=this._displayObject&&(this._displayObject.rotation=this.normalizeRotation,this.applyPivot()),this.updateGear(3))}),h(0,e,"width",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},function(t){this.setSize(t,this._rawHeight)}),h(0,e,"x",function(){return this._x},function(t){this.setXY(t,this._y)}),h(0,e,"draggable",function(){return this._draggable},function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())}),h(0,e,"y",function(){return this._y},function(t){this.setXY(this._x,t)}),h(0,e,"gearXY",function(){return this.getGear(1)}),h(0,e,"xMin",function(){return this._pivotAsAnchor?this._x-this._width*this._pivotX:this._x},function(t){this._pivotAsAnchor?this.setXY(t+this._width*this._pivotX,this._y):this.setXY(t,this._y)}),h(0,e,"pixelSnapping",function(){return this._pixelSnapping},function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())}),h(0,e,"height",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},function(t){this.setSize(this._rawWidth,t)}),h(0,e,"asButton",function(){return this}),h(0,e,"actualWidth",function(){return this.width*Math.abs(this._scaleX)}),h(0,e,"actualHeight",function(){return this.height*Math.abs(this._scaleY)}),h(0,e,"blendMode",function(){return this._displayObject.blendMode},function(t){this._displayObject.blendMode=t}),h(0,e,"scaleX",function(){return this._scaleX},function(t){this.setScale(t,this._scaleY)}),h(0,e,"scaleY",function(){return this._scaleY},function(t){this.setScale(this._scaleX,t)}),h(0,e,"skewX",function(){return this._skewX},function(t){this.setSkew(t,this._skewY)}),h(0,e,"skewY",function(){return this._skewY},function(t){this.setSkew(this._skewX,t)}),h(0,e,"pivotAsAnchor",function(){return this._pivotAsAnchor}),h(0,e,"pivotX",function(){return this._pivotX},function(t){this.setPivot(t,this._pivotY)}),h(0,e,"asTextInput",function(){return this}),h(0,e,"asLoader",function(){return this}),h(0,e,"pivotY",function(){return this._pivotY},function(t){this.setPivot(this._pivotX,t)}),h(0,e,"displayObject",function(){return this._displayObject}),h(0,e,"normalizeRotation",function(){var t=this._rotation%360;return t>180?t-=360:-180>t&&(t=360+t),t}),h(0,e,"touchable",function(){return this._touchable},function(t){if(this._touchable!=t){if(this._touchable=t,this.updateGear(3),this instanceof fairygui.GImage||this instanceof fairygui.GMovieClip||this instanceof fairygui.GTextField&&!(this instanceof fairygui.GTextInput)&&!(this instanceof fairygui.GRichTextField))return;null!=this._displayObject&&(this._displayObject.mouseEnabled=this._touchable)}}),h(0,e,"alpha",function(){return this._alpha},function(t){this._alpha!=t&&(this._alpha=t,this.handleAlphaChanged(),this.updateGear(3))}),h(0,e,"grayed",function(){return this._grayed},function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))}),h(0,e,"dragBounds",function(){return this._dragBounds},function(t){this._dragBounds=t}),h(0,e,"asProgress",function(){return this}),h(0,e,"enabled",function(){return!this._grayed&&this._touchable},function(t){this.grayed=!t,this.touchable=t}),h(0,e,"sortingOrder",function(){return this._sortingOrder},function(t){if(0>t&&(t=0),this._sortingOrder!=t){var e=this._sortingOrder;this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}}),h(0,e,"visible",function(){return this._visible},function(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag())}),h(0,e,"internalVisible",function(){return this._internalVisible&&(!this._group||this._group.internalVisible)&&!this._displayObject._cacheStyle.maskParent}),h(0,e,"internalVisible2",function(){return this._visible&&(!this._group||this._group.internalVisible2)}),h(0,e,"icon",function(){return null},function(){}),h(0,e,"asGraph",function(){return this}),h(0,e,"gearSize",function(){return this.getGear(2)}),h(0,e,"focusable",function(){return this._focusable},function(t){this._focusable=t}),h(0,e,"focused",function(){return this.root.focus==this}),h(0,e,"tooltips",function(){return this._tooltips},function(t){this._tooltips&&(this.off("mouseover",this,this.__rollOver),this.off("mouseout",this,this.__rollOut)),this._tooltips=t,this._tooltips&&(this.on("mouseover",this,this.__rollOver),this.on("mouseout",this,this.__rollOut))}),h(0,e,"dragging",function(){return fairygui.GObject.draggingObject==this}),h(0,e,"group",function(){return this._group},function(t){this._group!=t&&(null!=this._group&&this._group.setBoundsChangedFlag(!0),this._group=t,null!=this._group&&this._group.setBoundsChangedFlag(!0))}),h(0,e,"filters",function(){return this._displayObject.filters},function(t){this._displayObject.filters=t}),h(0,e,"inContainer",function(){return null!=this._displayObject&&null!=this._displayObject.parent}),h(0,e,"resourceURL",function(){return null!=this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null}),h(0,e,"onStage",function(){return null!=this._displayObject&&null!=this._displayObject.stage}),h(0,e,"root",function(){if(this instanceof fairygui.GRoot)return this;for(var t=this._parent;t;){if(t instanceof fairygui.GRoot)return t;t=t.parent}return je.inst}),h(0,e,"gearLook",function(){return this.getGear(3)}),h(0,e,"asCom",function(){return this}),h(0,e,"relations",function(){return this._relations}),h(0,e,"parent",function(){return this._parent},function(t){this._parent=t}),h(0,e,"asLabel",function(){return this}),h(0,e,"asTextField",function(){return this}),h(0,e,"asImage",function(){return this}),h(0,e,"asGroup",function(){return this}),h(0,e,"asRichTextField",function(){return this}),h(0,e,"asList",function(){return this}),h(0,e,"asSlider",function(){return this}),h(0,e,"asComboBox",function(){return this}),h(0,e,"asMovieClip",function(){return this}),h(0,e,"text",function(){return null},function(){}),h(0,e,"isDisposed",function(){return null==this._displayObject}),t.cast=function(t){return t.$owner},t.draggingObject=null,t._gInstanceCounter=0,t.grayFilter=null,t.sDraggingQuery=!1,t.sUpdateInDragging=!1,s(t,["sGlobalDragStart",function(){return this.sGlobalDragStart=new m},"sGlobalRect",function(){return this.sGlobalRect=new v},"sHelperPoint",function(){return this.sHelperPoint=new m},"sDragHelperRect",function(){return this.sDragHelperRect=new v}]),t}()),O=(function(){function t(){}return n(t,"fairygui.RelationType"),t.Left_Left=0,t.Left_Center=1,t.Left_Right=2,t.Center_Center=3,t.Right_Left=4,t.Right_Center=5,t.Right_Right=6,t.Top_Top=7,t.Top_Middle=8,t.Top_Bottom=9,t.Middle_Middle=10,t.Bottom_Top=11,t.Bottom_Middle=12,t.Bottom_Bottom=13,t.Width=14,t.Height=15,t.LeftExt_Left=16,t.LeftExt_Right=17,t.RightExt_Left=18,t.RightExt_Right=19,t.TopExt_Top=20,t.TopExt_Bottom=21,t.BottomExt_Top=22,t.BottomExt_Bottom=23,t.Size=24,t}(),function(){function t(){}return n(t,"fairygui.ChildrenRenderOrder"),t.Ascent=0,t.Descent=1,t.Arch=2,t}(),function(){function t(){this._text=null,this._readPos=0,this._handlers=null,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}n(t,"fairygui.utils.UBBParser");var e=t.prototype;return e.onTag_URL=function(t,e,i){if(e)return"</a>";if(null!=i)return'<a href="'+i+'" target="_blank">';var s=this.getTagText();return'<a href="'+s+'" target="_blank">'},e.onTag_IMG=function(t,e){if(e)return null;var i=this.getTagText(!0);return i?this.defaultImgWidth?'<img src="'+i+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+i+'"/>':null},e.onTag_Simple=function(t,e){return e?"</"+t+">":"<"+t+">"},e.onTag_COLOR=function(t,e,i){return e?"</span>":'<span style="color:'+i+'">'},e.onTag_FONT=function(t,e,i){return e?"</span>":'<span style="font-family:'+i+'">'},e.onTag_SIZE=function(t,e,i){return e?"</span>":("normal"==i?i=""+this.normalFontSize:"small"==i?i=""+this.smallFontSize:"large"==i?i=""+this.largeFontSize:i.length&&"+"==i.charAt(0)?i=""+(this.smallFontSize+parseInt(i.substr(1))):i.length&&"-"==i.charAt(0)&&(i=""+(this.smallFontSize-parseInt(i.substr(1)))),'<span style="font-size:'+i+'">')},e.getTagText=function(t){void 0===t&&(t=!1);for(var e=this._readPos,i=0,s="";-1!=(i=this._text.indexOf("[",e));){if(92!=this._text.charCodeAt(i-1)){s+=this._text.substring(e,i);break}s+=this._text.substring(e,i-1),s+="[",e=i+1}return-1==i?null:(t&&(this._readPos=i),s)},e.parse=function(t,e){void 0===e&&(e=!1),this._text=t;for(var i,s,n,h,r=0,o=0,a=0,l=!1,u="";-1!=(o=this._text.indexOf("[",r));)if(o>0&&92==this._text.charCodeAt(o-1))u+=this._text.substring(r,o-1),u+="[",r=o+1;else{if(u+=this._text.substring(r,o),r=o,o=this._text.indexOf("]",r),-1==o)break;l="/"==this._text.charAt(r+1),i=this._text.substring(l?r+2:r+1,o),this._readPos=o+1,s=null,n=null,a=i.indexOf("="),-1!=a&&(s=i.substring(a+1),i=i.substring(0,a)),i=i.toLowerCase(),h=this._handlers[i],null!=h?e||(n=h.call(this,i,l,s),null!=n&&(u+=n)):u+=this._text.substring(r,this._readPos),r=this._readPos}return r<this._text.length&&(u+=this._text.substr(r)),this._text=null,u},s(t,["inst",function(){return this.inst=new t}]),t}()),T=(function(){function t(){}return n(t,"fairygui.FlipType"),t.None=0,t.Horizontal=1,t.Vertical=2,t.Both=3,t}(),function(){function t(){}return n(t,"fairygui.tween.GTween"),t.to=function(t,e,i){return J.createTween()._to(t,e,i)},t.to2=function(t,e,i,s,n){return J.createTween()._to2(t,e,i,s,n)},t.to3=function(t,e,i,s,n,h,r){return J.createTween()._to3(t,e,i,s,n,h,r)},t.to4=function(t,e,i,s,n,h,r,o,a){return J.createTween()._to4(t,e,i,s,n,h,r,o,a)},t.toColor=function(t,e,i){return J.createTween()._toColor(t,e,i)},t.delayedCall=function(t){return J.createTween().setDelay(t)},t.shake=function(t,e,i,s){return J.createTween()._shake(t,e,i,s)},t.isTweening=function(t,e){return J.isTweening(t,e)},t.kill=function(t,e){void 0===e&&(e=!1),J.killTweens(t,!1,null)},t.getTween=function(t,e){return J.getTween(t,e)},t.catchCallbackExceptions=!0,t}()),j=function(){function t(){}return n(t,"fairygui.Events"),t.createEvent=function(t,e,i){return fairygui.Events.$event.setTo(t,e,i?i.target:e),i?(fairygui.Events.$event.touchId=i.touchId,fairygui.Events.$event.nativeEvent=i.nativeEvent):fairygui.Events.$event.nativeEvent=null,fairygui.Events.$event._stoped=!1,fairygui.Events.$event},t.dispatch=function(t,e,i){e.event(t,fairygui.Events.createEvent(t,e,i))},t.STATE_CHANGED="fui_state_changed",t.XY_CHANGED="fui_xy_changed",t.SIZE_CHANGED="fui_size_changed",t.SIZE_DELAY_CHANGE="fui_size_delay_change",t.CLICK_ITEM="fui_click_item",t.SCROLL="fui_scroll",t.SCROLL_END="fui_scroll_end",t.DROP="fui_drop",t.FOCUS_CHANGED="fui_focus_changed",t.DRAG_START="fui_drag_start",t.DRAG_MOVE="fui_drag_move",t.DRAG_END="fui_drag_end",t.PULL_DOWN_RELEASE="fui_pull_down_release",t.PULL_UP_RELEASE="fui_pull_up_release",t.GEAR_STOP="fui_gear_stop",s(t,["$event",function(){return this.$event=new u}]),t}(),z=function(){function t(){this._target=null,this._propType=null,this._killed=!1,this._paused=!1,this._delay=0/0,this._duration=0/0,this._breakpoint=0/0,this._easeType=0,this._easeOvershootOrAmplitude=0/0,this._easePeriod=0/0,this._repeat=0,this._yoyo=!1,this._timeScale=0/0,this._snapping=!1,this._userData=null,this._onUpdate=null,this._onUpdateCaller=null,this._onStart=null,this._onStartCaller=null,this._onComplete=null,this._onCompleteCaller=null,this._startValue=null,this._endValue=null,this._value=null,this._deltaValue=null,this._valueSize=0,this._started=!1,this._ended=0,this._elapsedTime=0/0,this._normalizedTime=0/0,this._startValue=new K,this._endValue=new K,this._value=new K,this._deltaValue=new K,this._reset()}n(t,"fairygui.tween.GTweener");var e=t.prototype;return e.setDelay=function(t){return this._delay=t,this},e.setDuration=function(t){return this._duration=t,this},e.setBreakpoint=function(t){return this._breakpoint=t,this},e.setEase=function(t){return this._easeType=t,this},e.setEasePeriod=function(t){return this._easePeriod=t,this},e.setEaseOvershootOrAmplitude=function(t){return this._easeOvershootOrAmplitude=t,this},e.setRepeat=function(t,e){return void 0===e&&(e=!1),this._repeat=t,this._yoyo=e,this},e.setTimeScale=function(t){return this._timeScale=t,this},e.setSnapping=function(t){return this._snapping=t,this},e.setTarget=function(t,e){return this._target=t,this._propType=e,this},e.setUserData=function(t){return this._userData=t,this},e.onUpdate=function(t,e){return this._onUpdate=t,this._onUpdateCaller=e,this},e.onStart=function(t,e){return this._onStart=t,this._onStartCaller=e,this},e.onComplete=function(t,e){return this._onComplete=t,this._onCompleteCaller=e,this},e.setPaused=function(t){return this._paused=t,this},e.seek=function(t){if(!this._killed){if(this._elapsedTime=t,this._elapsedTime<this._delay){if(!this._started)return;this._elapsedTime=this._delay}this.update()}},e.kill=function(t){void 0===t&&(t=!1),this._killed||(t&&(0==this._ended&&(this._elapsedTime=this._breakpoint>=0?this._delay+this._breakpoint:this._repeat>=0?this._delay+this._duration*(this._repeat+1):this._delay+2*this._duration,this.update()),this.callCompleteCallback()),this._killed=!0)},e._to=function(t,e,i){return this._valueSize=1,this._startValue.x=t,this._endValue.x=e,this._duration=i,this},e._to2=function(t,e,i,s,n){return this._valueSize=2,this._startValue.x=t,this._endValue.x=i,this._startValue.y=e,this._endValue.y=s,this._duration=n,this},e._to3=function(t,e,i,s,n,h,r){return this._valueSize=3,this._startValue.x=t,this._endValue.x=s,this._startValue.y=e,this._endValue.y=n,this._startValue.z=i,this._endValue.z=h,this._duration=r,this},e._to4=function(t,e,i,s,n,h,r,o,a){return this._valueSize=4,this._startValue.x=t,this._endValue.x=n,this._startValue.y=e,this._endValue.y=h,this._startValue.z=i,this._endValue.z=r,this._startValue.w=s,this._endValue.w=o,this._duration=a,this},e._toColor=function(t,e,i){return this._valueSize=4,this._startValue.color=t,this._endValue.color=e,this._duration=i,this},e._shake=function(t,e,i,s){return this._valueSize=5,this._startValue.x=t,this._startValue.y=e,this._startValue.w=i,this._duration=s,this._easeType=0,this},e._init=function(){this._delay=0,this._duration=0,this._breakpoint=-1,this._easeType=5,this._timeScale=1,this._easePeriod=0,this._easeOvershootOrAmplitude=1.70158,this._snapping=!1,this._repeat=0,this._yoyo=!1,this._valueSize=0,this._started=!1,this._paused=!1,this._killed=!1,this._elapsedTime=0,this._normalizedTime=0,this._ended=0},e._reset=function(){this._target=null,this._userData=null,this._onStart=this._onUpdate=this._onComplete=null,this._onStartCaller=this._onUpdateCaller=this._onCompleteCaller=null},e._update=function(t){if(1!=this._timeScale&&(t*=this._timeScale),0!=t){if(0!=this._ended)return this.callCompleteCallback(),this._killed=!0,void 0;this._elapsedTime+=t,this.update(),0!=this._ended&&(this._killed||(this.callCompleteCallback(),this._killed=!0))}},e.update=function(){if(this._ended=0,0==this._valueSize)return this._elapsedTime>=this._delay+this._duration&&(this._ended=1),void 0;if(!this._started){if(this._elapsedTime<this._delay)return;if(this._started=!0,this.callStartCallback(),this._killed)return}var t=!1,e=this._elapsedTime-this._delay;if(this._breakpoint>=0&&e>=this._breakpoint&&(e=this._breakpoint,this._ended=2),0!=this._repeat){var i=Math.floor(e/this._duration);e-=this._duration*i,this._yoyo&&(t=i%2==1),this._repeat>0&&this._repeat-i<0&&(this._yoyo&&(t=this._repeat%2==1),e=this._duration,this._ended=1)}else e>=this._duration&&(e=this._duration,this._ended=1);
if(this._normalizedTime=Y.evaluate(this._easeType,t?this._duration-e:e,this._duration,this._easeOvershootOrAmplitude,this._easePeriod),this._value.setZero(),this._deltaValue.setZero(),5==this._valueSize)if(0==this._ended){var s=this._startValue.w*(1-this._normalizedTime),n=(2*Math.random()-1)*s,h=(2*Math.random()-1)*s;n=n>0?Math.ceil(n):Math.floor(n),h=h>0?Math.ceil(h):Math.floor(h),this._deltaValue.x=n,this._deltaValue.y=h,this._value.x=this._startValue.x+n,this._value.y=this._startValue.y+h}else this._value.x=this._startValue.x,this._value.y=this._startValue.y;else for(var r=0;r<this._valueSize;r++){var o=this._startValue.getField(r),a=this._endValue.getField(r),l=o+(a-o)*this._normalizedTime;this._snapping&&(l=Math.round(l)),this._deltaValue.setField(r,l-this._value.getField(r)),this._value.setField(r,l)}if(null!=this._target&&null!=this._propType)if("function"==typeof this._propType)switch(this._valueSize){case 1:this._propType.call(this._target,this._value.x);break;case 2:this._propType.call(this._target,this._value.x,this._value.y);break;case 3:this._propType.call(this._target,this._value.x,this._value.y,this._value.z);break;case 4:this._propType.call(this._target,this._value.x,this._value.y,this._value.z,this._value.w);break;case 5:this._propType.call(this._target,this._value.color);break;case 6:this._propType.call(this._target,this._value.x,this._value.y)}else this._target[this._propType]=5==this._valueSize?this._value.color:this._value.x;this.callUpdateCallback()},e.callStartCallback=function(){if(null!=this._onStart)if(T.catchCallbackExceptions)try{this._onStart.call(this._onStartCaller,this)}catch(t){console.log("FairyGUI: error in start callback > "+t.message)}else this._onStart.call(this._onStartCaller,this)},e.callUpdateCallback=function(){if(null!=this._onUpdate)if(T.catchCallbackExceptions)try{this._onUpdate.call(this._onUpdateCaller,this)}catch(t){console.log("FairyGUI: error in update callback > "+t.message)}else this._onUpdate.call(this._onUpdateCaller,this)},e.callCompleteCallback=function(){if(null!=this._onComplete)if(T.catchCallbackExceptions)try{this._onComplete.call(this._onCompleteCaller,this)}catch(t){console.log("FairyGUI: error in complete callback > "+t.message)}else this._onComplete.call(this._onCompleteCaller,this)},h(0,e,"target",function(){return this._target}),h(0,e,"delay",function(){return this._delay}),h(0,e,"duration",function(){return this._duration}),h(0,e,"value",function(){return this._value}),h(0,e,"userData",function(){return this._userData}),h(0,e,"repeat",function(){return this._repeat}),h(0,e,"startValue",function(){return this._startValue}),h(0,e,"endValue",function(){return this._endValue}),h(0,e,"deltaValue",function(){return this._deltaValue}),h(0,e,"normalizedTime",function(){return this._normalizedTime}),h(0,e,"completed",function(){return 0!=this._ended}),h(0,e,"allCompleted",function(){return 1==this._ended}),t}(),B=function(){function t(){this.fromPage=null,this.toPage=null}n(t,"fairygui.action.ControllerAction");var e=t.prototype;return e.run=function(t,e,i){null!=this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||null!=this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)},e.enter=function(){},e.leave=function(){},e.setup=function(t){var e=0,i=0;for(e=t.getInt16(),this.fromPage=[],i=0;e>i;i++)this.fromPage[i]=t.readS();for(e=t.getInt16(),this.toPage=[],i=0;e>i;i++)this.toPage[i]=t.readS()},t.createAction=function(t){switch(t){case 0:return new me;case 1:return new ue}return null},t}(),M=function(){function t(t){this._owner=null,this._items=null,this.handling=null,this.sizeDirty=!1,this._owner=t,this._items=[]}n(t,"fairygui.Relations");var e=t.prototype;return e.add=function(t,e,i){void 0===i&&(i=!1);for(var s=this._items.length,n=0;s>n;n++){var h=this._items[n];if(h.target==t)return h.add(e,i),void 0}var r=new te(this._owner);r.target=t,r.add(e,i),this._items.push(r)},e.remove=function(t,e){void 0===e&&(e=0);for(var i=this._items.length,s=0;i>s;){var n=this._items[s];n.target==t?(n.remove(e),n.isEmpty?(n.dispose(),this._items.splice(s,1),i--):s++):s++}},e.contains=function(t){for(var e=this._items.length,i=0;e>i;i++){var s=this._items[i];if(s.target==t)return!0}return!1},e.clearFor=function(t){for(var e=this._items.length,i=0;e>i;){var s=this._items[i];s.target==t?(s.dispose(),this._items.splice(i,1),e--):i++}},e.clearAll=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.dispose()}this._items.length=0},e.copyFrom=function(t){this.clearAll();for(var e=t._items,i=e.length,s=0;i>s;s++){var n=e[s],h=new te(this._owner);h.copyFrom(n),this._items.push(h)}},e.dispose=function(){this.clearAll()},e.onOwnerSizeChanged=function(t,e,i){if(0!=this._items.length)for(var s=this._items.length,n=0;s>n;n++){var h=this._items[n];h.applyOnSelfResized(t,e,i)}},e.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.target.ensureSizeCorrect()}}},e.setup=function(t,e){for(var i,s=t.readByte(),n=0;s>n;n++){var h=t.getInt16();i=-1==h?this._owner.parent:e?this._owner.getChildAt(h):this._owner.parent.getChildAt(h);var r=new te(this._owner);r.target=i,this._items.push(r);for(var o=t.readByte(),a=0;o>a;a++){var l=t.readByte(),u=t.readBool();r.internalAdd(l,u)}}},h(0,e,"empty",function(){return 0==this._items.length}),t}(),A=function(){function t(){this.addDelay=0,this.texture=null}return n(t,"fairygui.display.Frame"),t}(),L=(function(){function t(){}return n(t,"fairygui.ObjectType"),t.Image=0,t.MovieClip=1,t.Swf=2,t.Graph=3,t.Loader=4,t.Group=5,t.Text=6,t.RichText=7,t.InputText=8,t.Component=9,t.List=10,t.Label=11,t.Button=12,t.ComboBox=13,t.ProgressBar=14,t.Slider=15,t.ScrollBar=16,t}(),function(){function t(t){this._owner=null,this._controller=null,this._tweenConfig=null,this._owner=t}n(t,"fairygui.gears.GearBase");var e=t.prototype;return e.dispose=function(){null!=this._tweenConfig&&null!=this._tweenConfig._tweener&&(this._tweenConfig._tweener.kill(),this._tweenConfig._tweener=null)},e.setup=function(t){this._controller=this._owner.parent.getControllerAt(t.getInt16()),this.init();var e,i=0,s=0;if(this instanceof fairygui.gears.GearDisplay){i=t.getInt16();var n=[];for(s=0;i>s;s++)n[s]=t.readS();this.pages=n}else{for(i=t.getInt16(),s=0;i>s;s++)e=t.readS(),null!=e&&this.addStatus(e,t);t.readBool()&&this.addStatus(null,t)}t.readBool()&&(this._tweenConfig=new V,this._tweenConfig.easeType=t.readByte(),this._tweenConfig.duration=t.getFloat32(),this._tweenConfig.delay=t.getFloat32())},e.updateFromRelations=function(){},e.addStatus=function(){},e.init=function(){},e.apply=function(){},e.updateState=function(){},h(0,e,"controller",function(){return this._controller},function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())}),h(0,e,"tweenConfig",function(){return null==this._tweenConfig&&(this._tweenConfig=new V),this._tweenConfig}),t.disableAllTweenEffect=!1,t}()),F=(function(){function t(){}return n(t,"fairygui.PackageItemType"),t.Image=0,t.MovieClip=1,t.Sound=2,t.Component=3,t.Atlas=4,t.Font=5,t.Swf=6,t.Misc=7,t.Unknown=8,t}(),function(){function t(){}return n(t,"fairygui.ListLayoutType"),t.SingleColumn=0,t.SingleRow=1,t.FlowHorizontal=2,t.FlowVertical=3,t.Pagination=4,t}(),function(){function t(t){this._list=null,this._root=null,this._indent=0,this.treeNodeCreateCell=null,this.treeNodeRender=null,this.treeNodeWillExpand=null,this.treeNodeClick=null,this._list=t,this._list.removeChildrenToPool(),this._list.on("fui_click_item",this,this.__clickItem),this._root=new ee(!0),this._root.setTree(this),this._root.setCell(this._list),this._root.expanded=!0,this._indent=15}n(t,"fairygui.tree.TreeView");var e=t.prototype;return e.getSelectedNode=function(){return-1!=this._list.selectedIndex?this._list.getChildAt(this._list.selectedIndex).data:null},e.getSelection=function(){for(var t=this._list.getSelection(),e=t.length,i=[],s=0;e>s;s++){var n=this._list.getChildAt(t[s]).data;i.push(n)}return i},e.addSelection=function(t,e){void 0===e&&(e=!1);for(var i=t.parent;null!=i&&i!=this._root;)i.expanded=!0,i=i.parent;t.cell&&this._list.addSelection(this._list.getChildIndex(t.cell),e)},e.removeSelection=function(t){t.cell&&this._list.removeSelection(this._list.getChildIndex(t.cell))},e.clearSelection=function(){this._list.clearSelection()},e.getNodeIndex=function(t){return this._list.getChildIndex(t.cell)},e.updateNode=function(t){null!=t.cell&&this.treeNodeRender&&this.treeNodeRender.runWith(t)},e.updateNodes=function(t){for(var e=t.length,i=0;e>i;i++){var s=t[i];if(null==s.cell)return;this.treeNodeRender&&this.treeNodeRender.runWith(s)}},e.expandAll=function(t){t.expanded=!0;for(var e=t.numChildren,i=0;e>i;i++){var s=t.getChildAt(i);s.isFolder&&this.expandAll(s)}},e.collapseAll=function(t){t!=this._root&&(t.expanded=!1);for(var e=t.numChildren,i=0;e>i;i++){var s=t.getChildAt(i);s.isFolder&&this.collapseAll(s)}},e.createCell=function(t){this.treeNodeCreateCell?t.setCell(this.treeNodeCreateCell.runWith(t)):t.setCell(this._list.itemPool.getObject(this._list.defaultItem)),t.cell.data=t;var e=t.cell.getChild("indent");null!=e&&(e.width=(t.level-1)*this._indent);var i=t.cell.getChild("expandButton");i&&(t.isFolder?(i.visible=!0,i.onClick(this,this.__clickExpandButton),i.data=t,i.selected=t.expanded):i.visible=!1),this.treeNodeRender&&this.treeNodeRender.runWith(t)},e.afterInserted=function(t){this.createCell(t);var e=this.getInsertIndexForNode(t);this._list.addChildAt(t.cell,e),this.treeNodeRender&&this.treeNodeRender.runWith(t),t.isFolder&&t.expanded&&this.checkChildren(t,e)},e.getInsertIndexForNode=function(t){var e=t.getPrevSibling();null==e&&(e=t.parent);for(var i=this._list.getChildIndex(e.cell)+1,s=t.level,n=this._list.numChildren,h=i;n>h;h++){var r=this._list.getChildAt(h).data;if(r.level<=s)break;i++}return i},e.afterRemoved=function(t){this.removeNode(t)},e.afterExpanded=function(t){if(t!=this._root&&this.treeNodeWillExpand&&this.treeNodeWillExpand(t),null!=t.cell){if(t!=this._root){this.treeNodeRender&&this.treeNodeRender.runWith(t);var e=t.cell.getChild("expandButton");e&&(e.selected=!0)}null!=t.cell.parent&&this.checkChildren(t,this._list.getChildIndex(t.cell))}},e.afterCollapsed=function(t){if(t!=this._root&&this.treeNodeWillExpand&&this.treeNodeWillExpand(t),null!=t.cell){if(t!=this._root){this.treeNodeRender&&this.treeNodeRender.runWith(t);var e=t.cell.getChild("expandButton");e&&(e.selected=!1)}null!=t.cell.parent&&this.hideFolderNode(t)}},e.afterMoved=function(t){t.isFolder?this.hideFolderNode(t):this._list.removeChild(t.cell);var e=this.getInsertIndexForNode(t);this._list.addChildAt(t.cell,e),t.isFolder&&t.expanded&&this.checkChildren(t,e)},e.checkChildren=function(t,e){for(var i=t.numChildren,s=0;i>s;s++){e++;var n=t.getChildAt(s);null==n.cell&&this.createCell(n),n.cell.parent||this._list.addChildAt(n.cell,e),n.isFolder&&n.expanded&&(e=this.checkChildren(n,e))}return e},e.hideFolderNode=function(t){for(var e=t.numChildren,i=0;e>i;i++){var s=t.getChildAt(i);s.cell&&null!=s.cell.parent&&this._list.removeChild(s.cell),s.isFolder&&s.expanded&&this.hideFolderNode(s)}},e.removeNode=function(t){if(null!=t.cell&&(null!=t.cell.parent&&this._list.removeChild(t.cell),this._list.returnToPool(t.cell),t.cell.data=null,t.setCell(null)),t.isFolder)for(var e=t.numChildren,i=0;e>i;i++){var s=t.getChildAt(i);this.removeNode(s)}},e.__clickExpandButton=function(t){t.stopPropagation();var e=P.cast(t.currentTarget),i=e.parent.data;if(null!=this._list.scrollPane){var s=this._list.scrollPane.posY;i.expanded=e.selected?!0:!1,this._list.scrollPane.posY=s,this._list.scrollPane.scrollToView(i.cell)}else i.expanded=e.selected?!0:!1},e.__clickItem=function(t,e){if(null!=this._list.scrollPane)var i=this._list.scrollPane.posY;var s=t.data;this.treeNodeClick&&this.treeNodeClick.runWith([s,e]),null!=this._list.scrollPane&&(this._list.scrollPane.posY=i,s.cell&&this._list.scrollPane.scrollToView(s.cell))},h(0,e,"list",function(){return this._list}),h(0,e,"root",function(){return this._root}),h(0,e,"indent",function(){return this._indent},function(t){this._indent=t}),t}(),function(){function t(){this.pixelWidth=0,this.scale=0/0,this.pixels=null}n(t,"fairygui.utils.PixelHitTestData");var e=t.prototype;return e.load=function(t){t.getInt32(),this.pixelWidth=t.getInt32(),this.scale=1/t.readByte();var e=t.getInt32();this.pixels=r(e);for(var i=0;e>i;i++){var s=t.readByte();0>s&&(s+=256),this.pixels[i]=s}},t}()),G=function(){function t(){this.owner=null,this.type=0,this.objectType=0,this.id=null,this.name=null,this.width=0,this.height=0,this.file=null,this.decoded=!1,this.rawData=null,this.scale9Grid=null,this.scaleByTile=!1,this.tileGridIndice=0,this.smoothing=!1,this.texture=null,this.pixelHitTestData=null,this.interval=0,this.repeatDelay=0,this.swing=!1,this.frames=null,this.extensionType=null,this.bitmapFont=null}n(t,"fairygui.PackageItem");var e=t.prototype;return e.load=function(){return this.owner.getItemAsset(this)},e.toString=function(){return this.name},t}(),R=(function(){function t(){}return n(t,"fairygui.FillOrigin"),t.Top=0,t.Bottom=1,t.Left=2,t.Right=3,t.TopLeft=0,t.TopRight=1,t.BottomLeft=2,t.BottomRight=3,t}(),function(){function t(){this._agent=null,this._sourceData=null,this._agent=new Ce,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align="center",this._agent.verticalAlign="middle",this._agent.sortingOrder=1e6,this._agent.on("fui_drag_end",this,this.__dragEnd)}n(t,"fairygui.DragDropManager");var e=t.prototype;return e.startDrag=function(t,e,s,n){if(void 0===n&&(n=-1),null==this._agent.parent){this._sourceData=s,this._agent.url=e,je.inst.addChild(this._agent);var h=je.inst.globalToLocal(i.stage.mouseX,i.stage.mouseY);this._agent.setXY(h.x,h.y),this._agent.startDrag(n)}},e.cancel=function(){null!=this._agent.parent&&(this._agent.stopDrag(),je.inst.removeChild(this._agent),this._sourceData=null)},e.__dragEnd=function(t){if(null!=this._agent.parent){je.inst.removeChild(this._agent);var e=this._sourceData;this._sourceData=null;for(var i=P.cast(t.target);null!=i;){if(i.displayObject.hasListener("fui_drop"))return i.requestFocus(),i.displayObject.event("fui_drop",[e,j.createEvent("fui_drop",i.displayObject,t)]),void 0;i=i.parent}}},h(0,e,"dragAgent",function(){return this._agent}),h(0,e,"dragging",function(){return null!=this._agent.parent}),h(1,t,"inst",function(){return null==fairygui.DragDropManager._inst&&(fairygui.DragDropManager._inst=new t),fairygui.DragDropManager._inst}),t._inst=null,t}(),function(){function t(){this.id=null,this.size=0,this.ttf=!1,this.glyphs=null,this.resizable=!1,this.glyphs={}}return n(t,"fairygui.display.BitmapFont",null,"BitmapFont$1"),t}()),E=function(){function t(){this._asset=null,this._asset=i.loader}n(t,"fairygui.AssetProxy");var e=t.prototype;return e.getRes=function(t){return this._asset.getRes(t)},e.load=function(t,e,i,s,n,h){void 0===n&&(n=1),void 0===h&&(h=!0),this._asset.load(t,e,i,s,n,h)},e.setAsset=function(t){this._asset=t},h(1,t,"inst",function(){return null==fairygui.AssetProxy._inst&&(t._inst=new t),fairygui.AssetProxy._inst}),t._inst=null,t}(),D=function(){function t(){this._controller=null,this._id=null}n(t,"fairygui.PageOption");var e=t.prototype;return e.clear=function(){this._id=null},h(0,e,"controller",null,function(t){this._controller=t}),h(0,e,"index",function(){return this._id?this._controller.getPageIndexById(this._id):-1},function(t){this._id=this._controller.getPageId(t)}),h(0,e,"name",function(){return this._id?this._controller.getPageNameById(this._id):null},function(t){this._id=this._controller.getPageIdByName(t)}),h(0,e,"id",function(){return this._id},function(t){this._id=t}),t}(),W=(function(){function t(){}return n(t,"fairygui.ScrollBarDisplayType"),t.Default=0,t.Visible=1,t.Auto=2,t.Hidden=3,t}(),function(){function t(){this.callback=null,this._itemList=null,this._objectPool=null,this._index=0,this._itemList=[],this._objectPool=[]}var e;n(t,"fairygui.AsyncOperation");var s=t.prototype;return s.createObject=function(t,e){var i=$.getByName(t);if(!i)throw new Error("package not found: "+t);var s=i.getItemByName(e);if(!s)throw new Error("resource not found: "+e);this.internalCreateObject(s)},s.createObjectFromURL=function(t){var e=$.getItemByURL(t);if(!e)throw new Error("resource not found: "+t);this.internalCreateObject(e)},s.cancel=function(){if(i.timer.clear(this,this.run),this._itemList.length=0,this._objectPool.length>0){for(var t=this._objectPool.length,e=0;t>e;e++)this._objectPool[e].dispose();this._objectPool.length=0}},s.internalCreateObject=function(t){this._itemList.length=0,this._objectPool.length=0;var s=new e(t,9);s.childCount=this.collectComponentChildren(t),this._itemList.push(s),this._index=0,i.timer.frameLoop(1,this,this.run)},s.collectComponentChildren=function(t){var i=t.rawData;i.seek(0,2);var s,n,h,r=0,o=0,a=0,l=i.getInt16();for(r=0;l>r;r++){o=i.getInt16(),a=i.pos,i.seek(a,0);var u=i.readByte(),_=i.readS(),c=i.readS();i.pos=a,null!=_?(h=null!=c?$.getById(c):t.owner,n=null!=h?h.getItemById(_):null,s=new e(n,u),null!=n&&3==n.type&&(s.childCount=this.collectComponentChildren(n))):(s=new e(null,u),10==u&&(s.listItemCount=this.collectListChildren(i))),this._itemList.push(s),i.pos=a+o}return l},s.collectListChildren=function(t){t.seek(t.pos,8);var i,s,n,h=0,r=0,o=0,a=t.readS(),l=t.getInt16();for(r=0;l>r;r++)o=t.getInt16(),o+=t.pos,i=t.readS(),null==i&&(i=a),i&&(s=$.getItemByURL(i),null!=s&&(n=new e(s,s.objectType),3==s.type&&(n.childCount=this.collectComponentChildren(s)),this._itemList.push(n),h++)),t.pos=o;return h},s.run=function(){for(var t,e,s=0,n=0,h=o.now(),r=ie.frameTimeForAsyncUIConstruction,a=this._itemList.length;this._index<a;){if(e=this._itemList[this._index],null!=e.packageItem)t=Q.newObject(e.packageItem),t.packageItem=e.packageItem,this._objectPool.push(t),$._constructing++,3==e.packageItem.type?(s=this._objectPool.length-e.childCount-1,t.constructFromResource2(this._objectPool,s),this._objectPool.splice(s,e.childCount)):t.constructFromResource(),$._constructing--;else if(t=Q.newObject2(e.type),this._objectPool.push(t),10==e.type&&e.listItemCount>0){for(s=this._objectPool.length-e.listItemCount-1,n=0;n<e.listItemCount;n++)t.itemPool.returnObject(this._objectPool[n+s]);this._objectPool.splice(s,e.listItemCount)}if(this._index++,this._index%5==0&&o.now()-h>=r)return}i.timer.clear(this,this.run);var l=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.runWith(l)},t.__init$=function(){e=function(){function t(t,e){this.packageItem=null,this.type=0,this.childCount=0,this.listItemCount=0,this.packageItem=t,this.type=e}return n(t,""),t}()},t}()),H=(function(){function t(){}return n(t,"fairygui.FillMethod"),t.None=0,t.Horizontal=1,t.Vertical=2,t.Radial90=3,t.Radial180=4,t.Radial360=5,t}(),function(){function t(){this._pool=null,this._count=0,this._pool={}}n(t,"fairygui.GObjectPool");var e=t.prototype;return e.clear=function(){for(var t in this._pool)for(var e=this._pool[t],i=e.length,s=0;i>s;s++)e[s].dispose();this._pool={},this._count=0},e.getObject=function(t){if(t=$.normalizeURL(t),null==t)return null;var e=this._pool[t];if(null!=e&&e.length>0)return this._count--,e.shift();var i=$.createObjectFromURL(t);return i},e.returnObject=function(t){var e=t.resourceURL;if(e){var i=this._pool[e];null==i&&(i=[],this._pool[e]=i),this._count++,i.push(t)}},h(0,e,"count",function(){return this._count}),t}()),V=(function(){function t(){}return n(t,"fairygui.ScrollType"),t.Horizontal=0,t.Vertical=1,t.Both=2,t}(),function(){function t(){}return n(t,"fairygui.OverflowType"),t.Visible=0,t.Hidden=1,t.Scroll=2,t}(),function(){function t(){this.tween=!1,this.easeType=0,this.duration=0/0,this.delay=0/0,this._displayLockToken=0/0,this._tweener=null,this.tween=!0,this.easeType=5,this.duration=.3,this.delay=0}return n(t,"fairygui.gears.GearTweenConfig"),t}()),N=function(){function t(t){this.name=null,this._owner=null,this._ownerBaseX=0/0,this._ownerBaseY=0/0,this._items=null,this._totalTimes=0,this._totalTasks=0,this._playing=!1,this._paused=!1,this._onComplete=null,this._options=0,this._reversed=!1,this._totalDuration=0/0,this._autoPlay=!1,this._autoPlayTimes=0,this._autoPlayDelay=0/0,this._timeScale=0/0,this._startTime=0/0,this._endTime=0/0,this.OPTION_IGNORE_DISPLAY_CONTROLLER=1,this.OPTION_AUTO_STOP_DISABLED=2,this.OPTION_AUTO_STOP_AT_END=4,this._owner=t,this._items=[],this._totalDuration=0,this._autoPlayTimes=1,this._autoPlayDelay=0,this._timeScale=1,this._startTime=0,this._endTime=0}var e,i,s,r,o,a,u,_,c,f;n(t,"fairygui.Transition");var g=t.prototype;return g.play=function(t,e,i,s,n){void 0===e&&(e=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=-1),this._play(t,e,i,s,n,!1)},g.playReverse=function(t,e,i,s,n){void 0===e&&(e=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=-1),this._play(t,1,i,s,n,!0)},g.changePlayTimes=function(t){this._totalTimes=t},g.setAutoPlay=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=0),this._autoPlay!=t&&(this._autoPlay=t,this._autoPlayTimes=e,this._autoPlayDelay=i,this._autoPlay?this._owner.onStage&&this.play(null,null,this._autoPlayTimes,this._autoPlayDelay):this._owner.onStage||this.stop(!1,!0))},g._play=function(t,e,i,s,n,h){void 0===e&&(e=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=-1),void 0===h&&(h=!1),this.stop(!0,!0),this._totalTimes=e,this._reversed=h,this._startTime=s,this._endTime=n,this._playing=!0,this._paused=!1,this._onComplete=t;for(var r=this._items.length,o=0;r>o;o++){var a=this._items[o];if(null==a.target?a.target=a.targetId?this._owner.getChildById(a.targetId):this._owner:a.target!=this._owner&&a.target.parent!=this._owner&&(a.target=null),null!=a.target&&10==a.type){var l=a.target.getTransition(a.value.transName);if(l==this&&(l=null),null!=l)if(0==a.value.playTimes){var u=0;for(u=o-1;u>=0;u--){var _=this._items[u];if(10==_.type&&_.value.trans==l){_.value.stopTime=a.time-_.time;break}}0>u?a.value.stopTime=0:l=null}else a.value.stopTime=-1;a.value.trans=l}}0==i?this.onDelayedPlay():T.delayedCall(i).onComplete(this.onDelayedPlay,this)},g.stop=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete;this._onComplete=null,T.kill(this);var s=this._items.length;if(this._reversed)for(var n=s-1;n>=0;n--){var h=this._items[n];null!=h.target&&this.stopItem(h,t)}else for(n=0;s>n;n++)h=this._items[n],null!=h.target&&this.stopItem(h,t);e&&null!=i&&i.run()}},g.stopItem=function(t,e){if(0!=t.displayLockToken&&(t.target.releaseDisplayLock(t.displayLockToken),t.displayLockToken=0),null!=t.tweener&&(t.tweener.kill(e),t.tweener=null,11!=t.type||e||(t.target._gearLocked=!0,t.target.setXY(t.target.x-t.value.lastOffsetX,t.target.y-t.value.lastOffsetY),t.target._gearLocked=!1)),10==t.type){var i=t.value.trans;null!=i&&i.stop(e,!1)}},g.setPaused=function(t){if(this._playing&&this._paused!=t){this._paused=t;var e=T.getTween(this);null!=e&&e.setPaused(t);for(var i=this._items.length,s=0;i>s;s++){var n=this._items[s];null!=n.target&&(10==n.type?null!=n.value.trans&&n.value.trans.setPaused(t):7==n.type&&(t?(n.value.flag=n.target.playing,n.target.playing=!1):n.target.playing=n.value.flag),null!=n.tweener&&n.tweener.setPaused(t))}}},g.dispose=function(){this._playing&&T.kill(this);for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];null!=i.tweener&&(i.tweener.kill(),i.tweener=null),i.target=null,i.hook=null,null!=i.tweenConfig&&(i.tweenConfig.endHook=null)}this._items.length=0,this._playing=!1,this._onComplete=null},g.setValue=function(t){for(var e=[],i=1,s=arguments.length;s>i;i++)e.push(arguments[i]);for(var n,h=this._items.length,r=!1,i=0;h>i;i++){var o=this._items[i];if(o.label==t)n=null!=o.tweenConfig?o.tweenConfig.startValue:o.value,r=!0;else{if(null==o.tweenConfig||o.tweenConfig.endLabel!=t)continue;n=o.tweenConfig.endValue,r=!0}switch(o.type){case 0:case 1:case 3:case 2:case 13:n.b1=!0,n.b2=!0,n.f1=parseFloat(e[0]),n.f2=parseFloat(e[1]);break;case 4:n.f1=parseFloat(e[0]);break;case 5:n.f1=parseFloat(e[0]);break;case 6:n.f1=parseFloat(e[0]);break;case 7:n.frame=parseInt(e[0]),e.length>1&&(n.playing=e[1]);break;case 8:n.visible=e[0];break;case 9:n.sound=e[0],e.length>1&&(n.volume=parseFloat(e[1]));break;case 10:n.transName=e[0],e.length>1&&(n.playTimes=parseInt(e[1]));break;case 11:n.amplitude=parseFloat(e[0]),e.length>1&&(n.duration=parseFloat(e[1]));break;case 12:n.f1=parseFloat(e[0]),n.f2=parseFloat(e[1]),n.f3=parseFloat(e[2]),n.f4=parseFloat(e[3]);break;case 14:case 15:n.text=e[0]}}if(!r)throw new Error("label not exists")},g.setHook=function(t,e){for(var i=this._items.length,s=!1,n=0;i>n;n++){var h=this._items[n];if(h.label==t){h.hook=e,s=!0;break}if(null!=h.tweenConfig&&h.tweenConfig.endLabel==t){h.tweenConfig.endHook=e,s=!0;break}}if(!s)throw new Error("label not exists")},g.clearHooks=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];i.hook=null,null!=i.tweenConfig&&(i.tweenConfig.endHook=null)}},g.setTarget=function(t,e){for(var i=this._items.length,s=!1,n=0;i>n;n++){var h=this._items[n];h.label==t&&(h.targetId=e==this._owner||null==e?"":e.id,h.target=this._playing?h.targetId.length>0?this._owner.getChildById(h.targetId):this._owner:null,s=!0)}if(!s)throw new Error("label not exists")},g.setDuration=function(t,e){for(var i=this._items.length,s=!1,n=0;i>n;n++){var h=this._items[n];null!=h.tweenConfig&&h.label==t&&(h.tweenConfig.duration=e,s=!0)}if(!s)throw new Error("label not exists")},g.getLabelTime=function(t){for(var e=this._items.length,i=0;e>i;i++){var s=this._items[i];if(s.label==t)return s.time;if(null!=s.tweenConfig&&s.tweenConfig.endLabel==t)return s.time+s.tweenConfig.duration}return Number.NaN},g.updateFromRelations=function(t,e,i){var s=this._items.length;if(0!=s)for(var n=0;s>n;n++){var h=this._items[n];0==h.type&&h.targetId==t&&(null!=h.tweenConfig?(h.tweenConfig.startValue.f1+=e,h.tweenConfig.startValue.f2+=i,h.tweenConfig.endValue.f1+=e,h.tweenConfig.endValue.f2+=i):(h.value.f1+=e,h.value.f2+=i))}},g.onOwnerAddedToStage=function(){this._autoPlay&&!this._playing&&this.play(null,this._autoPlayTimes,this._autoPlayDelay)},g.onOwnerRemovedFromStage=function(){0==(this._options&this.OPTION_AUTO_STOP_DISABLED)&&this.stop(0!=(this._options&this.OPTION_AUTO_STOP_AT_END)?!0:!1,!1)},g.onDelayedPlay=function(){if(this.internalPlay(),this._playing=this._totalTasks>0,this._playing){if(0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];null!=i.target&&i.target!=this._owner&&(i.displayLockToken=i.target.addDisplayLock())}}else if(null!=this._onComplete){var s=this._onComplete;this._onComplete=null,s.run()}},g.internalPlay=function(){this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;var t,e=this._items.length,i=!1;if(this._reversed)for(s=e-1;s>=0;s--)t=this._items[s],null!=t.target&&this.playItem(t);else for(var s=0;e>s;s++)t=this._items[s],null!=t.target&&(7==t.type&&0!=this._startTime&&t.time<=this._startTime?(i=!0,t.value.flag=!1):this.playItem(t));i&&this.skipAnimations()},g.playItem=function(t){var e=0/0;if(null!=t.tweenConfig){if(e=this._reversed?this._totalDuration-t.time-t.tweenConfig.duration:t.time,-1==this._endTime||e<=this._endTime){var i,s;switch(this._reversed?(i=t.tweenConfig.endValue,s=t.tweenConfig.startValue):(i=t.tweenConfig.startValue,s=t.tweenConfig.endValue),t.value.b1=i.b1||s.b1,t.value.b2=i.b2||s.b2,t.type){case 0:case 1:case 2:case 13:t.tweener=T.to2(i.f1,i.f2,s.f1,s.f2,t.tweenConfig.duration);break;case 4:case 5:t.tweener=T.to(i.f1,s.f1,t.tweenConfig.duration);break;case 6:t.tweener=T.toColor(i.f1,s.f1,t.tweenConfig.duration);break;case 12:t.tweener=T.to4(i.f1,i.f2,i.f3,i.f4,s.f1,s.f2,s.f3,s.f4,t.tweenConfig.duration)}t.tweener.setDelay(e).setEase(t.tweenConfig.easeType).setRepeat(t.tweenConfig.repeat,t.tweenConfig.yoyo).setTimeScale(this._timeScale).setTarget(t).onStart(this.onTweenStart,this).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),this._endTime>=0&&t.tweener.setBreakpoint(this._endTime-e),this._totalTasks++}}else 11==t.type?(e=this._reversed?this._totalDuration-t.time-t.value.duration:t.time,t.value.offsetX=t.value.offsetY=0,t.value.lastOffsetX=t.value.lastOffsetY=0,t.tweener=T.shake(0,0,t.value.amplitude,t.value.duration).setDelay(e).setTimeScale(this._timeScale).setTarget(t).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),this._endTime>=0&&t.tweener.setBreakpoint(this._endTime-t.time),this._totalTasks++):(e=this._reversed?this._totalDuration-t.time:t.time,e<=this._startTime?(this.applyValue(t),this.callHook(t,!1)):(-1==this._endTime||e<=this._endTime)&&(this._totalTasks++,t.tweener=T.delayedCall(e).setTimeScale(this._timeScale).setTarget(t).onComplete(this.onDelayedPlayItem,this)));null!=t.tweener&&t.tweener.seek(this._startTime)},g.skipAnimations=function(){for(var t,e,i,s=0,n=0/0,h=0/0,r=this._items.length,o=0;r>o;o++)if(i=this._items[o],!(7!=i.type||i.time>this._startTime||(t=i.value,t.flag))){e=i.target,s=e.frame,n=e.playing?0:-1,h=0;for(var a=o;r>a;a++)i=this._items[a],7!=i.type||i.target!=e||i.time>this._startTime||(t=i.value,t.flag=!0,-1!=t.frame?(s=t.frame,n=t.playing?i.time:-1,h=0):t.playing?0>n&&(n=i.time):(n>=0&&(h+=i.time-n),n=-1),this.callHook(i,!1));n>=0&&(h+=this._startTime-n),e.playing=n>=0,e.frame=s,h>0&&e.advance(1e3*h)}},g.onDelayedPlayItem=function(t){var e=t.target;e.tweener=null,this._totalTasks--,this.applyValue(e),this.callHook(e,!1),this.checkAllComplete()},g.onTweenStart=function(t){var e=t.target;if(0==e.type||1==e.type){var i,s;this._reversed?(i=e.tweenConfig.endValue,s=e.tweenConfig.startValue):(i=e.tweenConfig.startValue,s=e.tweenConfig.endValue),0==e.type?e.target!=this._owner?(i.b1||(i.f1=e.target.x),i.b2||(i.f2=e.target.y)):(i.b1||(i.f1=e.target.x-this._ownerBaseX),i.b2||(i.f2=e.target.y-this._ownerBaseY)):(i.b1||(i.f1=e.target.width),i.b2||(i.f2=e.target.height)),s.b1||(s.f1=i.f1),s.b2||(s.f2=i.f2),t.startValue.x=i.f1,t.startValue.y=i.f2,t.endValue.x=s.f1,t.endValue.y=s.f2}this.callHook(e,!1)},g.onTweenUpdate=function(t){var e=t.target;switch(e.type){case 0:case 1:case 2:case 13:e.value.f1=t.value.x,e.value.f2=t.value.y;break;case 4:case 5:e.value.f1=t.value.x;break;case 6:e.value.f1=t.value.color;break;case 12:e.value.f1=t.value.x,e.value.f2=t.value.y,e.value.f3=t.value.z,e.value.f4=t.value.w;break;case 11:e.value.offsetX=t.deltaValue.x,e.value.offsetY=t.deltaValue.y}this.applyValue(e)},g.onTweenComplete=function(t){var e=t.target;e.tweener=null,this._totalTasks--,t.allCompleted&&this.callHook(e,!0),this.checkAllComplete()},g.onPlayTransCompleted=function(){this._totalTasks--,this.checkAllComplete()},g.callHook=function(t,e){e?null!=t.tweenConfig&&null!=t.tweenConfig.endHook&&t.tweenConfig.endHook.run():t.time>=this._startTime&&null!=t.hook&&t.hook.run()},g.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)this.internalPlay();else if(this._totalTimes--,this._totalTimes>0)this.internalPlay();else{this._playing=!1;for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];null!=i.target&&0!=i.displayLockToken&&(i.target.releaseDisplayLock(i.displayLockToken),i.displayLockToken=0)}if(null!=this._onComplete){var s=this._onComplete;this._onComplete=null,s.run()}}},g.applyValue=function(t){switch(t.target._gearLocked=!0,t.type){case 0:if(t.target==this._owner){var e=0/0,i=0/0;e=t.value.b1?t.value.f1+this._ownerBaseX:t.target.x,i=t.value.b2?t.value.f2+this._ownerBaseY:t.target.y,t.target.setXY(e,i)}else t.value.b1||(t.value.f1=t.target.x),t.value.b2||(t.value.f2=t.target.y),t.target.setXY(t.value.f1,t.value.f2);break;case 1:t.value.b1||(t.value.f1=t.target.width),t.value.b2||(t.value.f2=t.target.height),t.target.setSize(t.value.f1,t.value.f2);break;case 3:t.target.setPivot(t.value.f1,t.value.f2,t.target.pivotAsAnchor);
break;case 4:t.target.alpha=t.value.f1;break;case 5:t.target.rotation=t.value.f1;break;case 2:t.target.setScale(t.value.f1,t.value.f2);break;case 13:t.target.setSkew(t.value.f1,t.value.f2);break;case 6:t.target.color=I.convertToHtmlColor(t.value.f1,!1);break;case 7:t.value.frame>=0&&(t.target.frame=t.value.frame),t.target.playing=t.value.playing,t.target.timeScale=this._timeScale;break;case 8:t.target.visible=t.value.visible;break;case 10:if(this._playing){var s=t.value.trans;if(null!=s){this._totalTasks++;var n=this._startTime>t.time?this._startTime-t.time:0,h=this._endTime>=0?this._endTime-t.time:-1;t.value.stopTime>=0&&(0>h||h>t.value.stopTime)&&(h=t.value.stopTime),s.timeScale=this._timeScale,s._play(d.create(this,this.onPlayTransCompleted,[t]),t.value.playTimes,0,n,h,this._reversed)}}break;case 9:if(this._playing&&t.time>=this._startTime){if(null==t.value.audioClip){var r=$.getItemByURL(t.value.sound);t.value.audioClip=r?r.file:t.value.sound}t.value.audioClip&&je.inst.playOneShotSound(t.value.audioClip,t.value.volume)}break;case 11:t.target.setXY(t.target.x-t.value.lastOffsetX+t.value.offsetX,t.target.y-t.value.lastOffsetY+t.value.offsetY),t.value.lastOffsetX=t.value.offsetX,t.value.lastOffsetY=t.value.offsetY;break;case 12:var o=t.target.filters,a=new se;a.adjustBrightness(t.value.f1),a.adjustContrast(t.value.f2),a.adjustSaturation(t.value.f3),a.adjustHue(t.value.f4),o=[new l(a)],t.target.filters=o;break;case 14:t.target.text=t.value.text;break;case 15:t.target.icon=t.value.text}t.target._gearLocked=!1},g.setup=function(t){this.name=t.readS(),this._options=t.getInt32(),this._autoPlay=t.readBool(),this._autoPlayTimes=t.getInt32(),this._autoPlayDelay=t.getFloat32();for(var e=t.getInt16(),n=0;e>n;n++){var h=t.getInt16(),r=t.pos;t.seek(r,0);var o=new i(t.readByte());this._items[n]=o,o.time=t.getFloat32();var a=t.getInt16();o.targetId=0>a?"":this._owner.getChildAt(a).id,o.label=t.readS(),t.readBool()?(t.seek(r,1),o.tweenConfig=new s,o.tweenConfig.duration=t.getFloat32(),o.time+o.tweenConfig.duration>this._totalDuration&&(this._totalDuration=o.time+o.tweenConfig.duration),o.tweenConfig.easeType=t.readByte(),o.tweenConfig.repeat=t.getInt32(),o.tweenConfig.yoyo=t.readBool(),o.tweenConfig.endLabel=t.readS(),t.seek(r,2),this.decodeValue(o,t,o.tweenConfig.startValue),t.seek(r,3),this.decodeValue(o,t,o.tweenConfig.endValue)):(o.time>this._totalDuration&&(this._totalDuration=o.time),t.seek(r,2),this.decodeValue(o,t,o.value)),t.pos=r+h}},g.decodeValue=function(t,e,i){switch(t.type){case 0:case 1:case 3:case 13:i.b1=e.readBool(),i.b2=e.readBool(),i.f1=e.getFloat32(),i.f2=e.getFloat32();break;case 4:case 5:i.f1=e.getFloat32();break;case 2:i.f1=e.getFloat32(),i.f2=e.getFloat32();break;case 6:i.f1=e.readColor();break;case 7:i.playing=e.readBool(),i.frame=e.getInt32();break;case 8:i.visible=e.readBool();break;case 9:i.sound=e.readS(),i.volume=e.getFloat32();break;case 10:i.transName=e.readS(),i.playTimes=e.getInt32();break;case 11:i.amplitude=e.getFloat32(),i.duration=e.getFloat32();break;case 12:i.f1=e.getFloat32(),i.f2=e.getFloat32(),i.f3=e.getFloat32(),i.f4=e.getFloat32();break;case 14:case 15:i.text=e.readS()}},h(0,g,"playing",function(){return this._playing}),h(0,g,"timeScale",function(){return this._timeScale},function(t){if(this._timeScale!=t&&(this._timeScale=t,this._playing))for(var e=this._items.length,i=0;e>i;i++){var s=this._items[i];null!=s.tweener?s.tweener.setTimeScale(t):10==s.type?null!=s.value.trans&&(s.value.trans.timeScale=t):7==s.type&&null!=s.target&&(s.target.timeScale=t)}}),t.__init$=function(){e=function(){function t(){}return n(t,""),t.XY=0,t.Size=1,t.Scale=2,t.Pivot=3,t.Alpha=4,t.Rotation=5,t.Color=6,t.Animation=7,t.Visible=8,t.Sound=9,t.Transition=10,t.Shake=11,t.ColorFilter=12,t.Skew=13,t.Text=14,t.Icon=15,t.Unknown=16,t}(),i=function(){function t(t){switch(this.time=0/0,this.targetId=null,this.type=0,this.tweenConfig=null,this.label=null,this.value=null,this.hook=null,this.tweener=null,this.target=null,this.displayLockToken=0,this.type=t,t){case 0:case 1:case 2:case 3:case 13:case 4:case 5:case 6:case 12:this.value=new f;break;case 7:this.value=new o;break;case 11:this.value=new _;break;case 9:this.value=new a;break;case 10:this.value=new u;break;case 8:this.value=new r;break;case 14:case 15:this.value=new c}}return n(t,""),t}(),s=function(){function t(){this.duration=0/0,this.easeType=0,this.repeat=0,this.yoyo=!1,this.startValue=null,this.endValue=null,this.endLabel=null,this.endHook=null,this.easeType=5,this.startValue=new f,this.endValue=new f}return n(t,""),t}(),r=function(){function t(){this.visible=!1}return n(t,""),t}(),o=function(){function t(){this.frame=0,this.playing=!1,this.flag=!1}return n(t,""),t}(),a=function(){function t(){this.sound=null,this.volume=0/0,this.audioClip=null}return n(t,""),t}(),u=function(){function t(){this.transName=null,this.playTimes=0,this.trans=null,this.stopTime=0/0}return n(t,""),t}(),_=function(){function t(){this.amplitude=0/0,this.duration=0/0,this.offsetX=0/0,this.offsetY=0/0,this.lastOffsetX=0/0,this.lastOffsetY=0/0}return n(t,""),t}(),c=function(){function t(){this.text=null}return n(t,""),t}(),f=function(){function t(){this.f1=0/0,this.f2=0/0,this.f3=0/0,this.f4=0/0,this.b1=!1,this.b2=!1,this.b1=this.b2=!0}return n(t,""),t}()},t}(),Y=(function(){function t(){}return n(t,"fairygui.LoaderFillType"),t.None=0,t.Scale=1,t.ScaleMatchHeight=2,t.ScaleMatchWidth=3,t.ScaleFree=4,t.ScaleNoBorder=5,t}(),function(){function t(){}var e;return n(t,"fairygui.tween.EaseManager"),t.evaluate=function(i,s,n,h,r){switch(i){case 0:return s/n;case 1:return-Math.cos(s/n*t._PiOver2)+1;case 2:return Math.sin(s/n*t._PiOver2);case 3:return-.5*(Math.cos(Math.PI*s/n)-1);case 4:return(s/=n)*s;case 5:return-(s/=n)*(s-2);case 6:return(s/=.5*n)<1?.5*s*s:-.5*(--s*(s-2)-1);case 7:return(s/=n)*s*s;case 8:return(s=s/n-1)*s*s+1;case 9:return(s/=.5*n)<1?.5*s*s*s:.5*((s-=2)*s*s+2);case 10:return(s/=n)*s*s*s;case 11:return-((s=s/n-1)*s*s*s-1);case 12:return(s/=.5*n)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2);case 13:return(s/=n)*s*s*s*s;case 14:return(s=s/n-1)*s*s*s*s+1;case 15:return(s/=.5*n)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2);case 16:return 0==s?0:Math.pow(2,10*(s/n-1));case 17:return s==n?1:-Math.pow(2,-10*s/n)+1;case 18:return 0==s?0:s==n?1:(s/=.5*n)<1?.5*Math.pow(2,10*(s-1)):.5*(-Math.pow(2,-10*--s)+2);case 19:return-(Math.sqrt(1-(s/=n)*s)-1);case 20:return Math.sqrt(1-(s=s/n-1)*s);case 21:return(s/=.5*n)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1);case 22:var o=0/0;return 0==s?0:1==(s/=n)?1:(0==r&&(r=.3*n),1>h?(h=1,o=r/4):o=r/t._TwoPi*Math.asin(1/h),-(h*Math.pow(2,10*(s-=1))*Math.sin((s*n-o)*t._TwoPi/r)));case 23:var a=0/0;return 0==s?0:1==(s/=n)?1:(0==r&&(r=.3*n),1>h?(h=1,a=r/4):a=r/t._TwoPi*Math.asin(1/h),h*Math.pow(2,-10*s)*Math.sin((s*n-a)*t._TwoPi/r)+1);case 24:var l=0/0;return 0==s?0:2==(s/=.5*n)?1:(0==r&&(r=.3*n*1.5),1>h?(h=1,l=r/4):l=r/t._TwoPi*Math.asin(1/h),1>s?-.5*h*Math.pow(2,10*(s-=1))*Math.sin((s*n-l)*t._TwoPi/r):h*Math.pow(2,-10*(s-=1))*Math.sin((s*n-l)*t._TwoPi/r)*.5+1);case 25:return(s/=n)*s*((h+1)*s-h);case 26:return(s=s/n-1)*s*((h+1)*s+h)+1;case 27:return(s/=.5*n)<1?.5*s*s*(((h*=1.525)+1)*s-h):.5*((s-=2)*s*(((h*=1.525)+1)*s+h)+2);case 28:return e.easeIn(s,n);case 29:return e.easeOut(s,n);case 30:return e.easeInOut(s,n);default:return-(s/=n)*(s-2)}},s(t,["_PiOver2",function(){return this._PiOver2=.5*Math.PI},"_TwoPi",function(){return this._TwoPi=2*Math.PI}]),t.__init$=function(){e=function(){function t(){}return n(t,""),t.easeIn=function(e,i){return 1-t.easeOut(i-e,i)},t.easeOut=function(t,e){return(t/=e)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},t.easeInOut=function(e,i){return.5*i>e?.5*t.easeIn(2*e,i):.5*t.easeOut(2*e-i,i)+.5},t}()},t}()),U=function(){function t(){this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0,this.texture=null}return n(t,"fairygui.display.BMGlyph"),t}(),X=function(){function t(t){this._owner=null,this._container=null,this._maskContainer=null,this._alignContainer=null,this._scrollType=0,this._scrollStep=0,this._mouseWheelStep=0,this._decelerationRate=0/0,this._scrollBarMargin=null,this._bouncebackEffect=!1,this._touchEffect=!1,this._scrollBarDisplayAuto=!1,this._vScrollNone=!1,this._hScrollNone=!1,this._needRefresh=!1,this._refreshBarAxis=null,this._displayOnLeft=!1,this._snapToItem=!1,this._displayInDemand=!1,this._mouseWheelEnabled=!1,this._pageMode=!1,this._inertiaDisabled=!1,this._xPos=0/0,this._yPos=0/0,this._viewSize=null,this._contentSize=null,this._overlapSize=null,this._pageSize=null,this._containerPos=null,this._beginTouchPos=null,this._lastTouchPos=null,this._lastTouchGlobalPos=null,this._velocity=null,this._velocityScale=0/0,this._lastMoveTime=0/0,this._isHoldAreaDone=!1,this._aniFlag=0,this._scrollBarVisible=!1,this._loop=0,this._headerLockedSize=0,this._footerLockedSize=0,this._refreshEventDispatching=!1,this._tweening=0,this._tweenTime=null,this._tweenDuration=null,this._tweenStart=null,this._tweenChange=null,this._pageController=null,this._hzScrollBar=null,this._vtScrollBar=null,this._header=null,this._footer=null,this.isDragged=!1,this._owner=t,this._maskContainer=new b,this._owner.displayObject.addChild(this._maskContainer),this._container=this._owner._container,this._container.pos(0,0),this._maskContainer.addChild(this._container),this._scrollBarVisible=!0,this._mouseWheelEnabled=!0,this._xPos=0,this._yPos=0,this._aniFlag=0,this._footerLockedSize=0,this._headerLockedSize=0,this._scrollBarMargin=new k,this._viewSize=new m,this._contentSize=new m,this._pageSize=new m(1,1),this._overlapSize=new m,this._tweenTime=new m,this._tweenStart=new m,this._tweenDuration=new m,this._tweenChange=new m,this._velocity=new m,this._containerPos=new m,this._beginTouchPos=new m,this._lastTouchPos=new m,this._lastTouchGlobalPos=new m,this._scrollStep=ie.defaultScrollStep,this._mouseWheelStep=2*this._scrollStep,this._decelerationRate=ie.defaultScrollDecelerationRate,this._owner.on("mousedown",this,this.__mouseDown),this._owner.on("mousewheel",this,this.__mouseWheel)}n(t,"fairygui.ScrollPane");var e=t.prototype;return e.setup=function(t){this._scrollType=t.readByte();var e=t.readByte(),i=t.getInt32();t.readBool()&&(this._scrollBarMargin.top=t.getInt32(),this._scrollBarMargin.bottom=t.getInt32(),this._scrollBarMargin.left=t.getInt32(),this._scrollBarMargin.right=t.getInt32());var s=t.readS(),n=t.readS(),h=t.readS(),r=t.readS();if(this._displayOnLeft=0!=(1&i),this._snapToItem=0!=(2&i),this._displayInDemand=0!=(4&i),this._pageMode=0!=(8&i),this._touchEffect=16&i?!0:32&i?!1:ie.defaultScrollTouchEffect,this._bouncebackEffect=64&i?!0:128&i?!1:ie.defaultScrollBounceEffect,this._inertiaDisabled=0!=(256&i),0==(512&i)&&(this._maskContainer.scrollRect=new v),0==e&&(e=ie.defaultScrollBarDisplay),3!=e){if(2==this._scrollType||1==this._scrollType){var o=s?s:ie.verticalScrollBar;if(o){if(this._vtScrollBar=$.createObjectFromURL(o),!this._vtScrollBar)throw"cannot create scrollbar from "+o;this._vtScrollBar.setScrollPane(this,!0),this._owner.displayObject.addChild(this._vtScrollBar.displayObject)}}if((2==this._scrollType||0==this._scrollType)&&(o=n?n:ie.horizontalScrollBar)){if(this._hzScrollBar=$.createObjectFromURL(o),!this._hzScrollBar)throw"cannot create scrollbar from "+o;this._hzScrollBar.setScrollPane(this,!1),this._owner.displayObject.addChild(this._hzScrollBar.displayObject)}this._scrollBarDisplayAuto=2==e,this._scrollBarDisplayAuto&&(this._scrollBarVisible=!1,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=!1))}else this._mouseWheelEnabled=!1;if(h&&(this._header=$.createObjectFromURL(h),null==this._header))throw new Error("FairyGUI: cannot create scrollPane header from "+h);if(r&&(this._footer=$.createObjectFromURL(r),null==this._footer))throw new Error("FairyGUI: cannot create scrollPane footer from "+r);(null!=this._header||null!=this._footer)&&(this._refreshBarAxis=2==this._scrollType||1==this._scrollType?"y":"x"),this.setSize(this.owner.width,this.owner.height)},e.dispose=function(){0!=this._tweening&&i.timer.clear(this,this.tweenUpdate),this._pageController=null,null!=this._hzScrollBar&&this._hzScrollBar.dispose(),null!=this._vtScrollBar&&this._vtScrollBar.dispose(),null!=this._header&&this._header.dispose(),null!=this._footer&&this._footer.dispose()},e.setPercX=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),this.setPosX(this._overlapSize.x*I.clamp01(t),e)},e.setPercY=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),this.setPosY(this._overlapSize.y*I.clamp01(t),e)},e.setPosX=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"x")),t=I.clamp(t,0,this._overlapSize.x),t!=this._xPos&&(this._xPos=t,this.posChanged(e))},e.setPosY=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"y")),t=I.clamp(t,0,this._overlapSize.y),t!=this._yPos&&(this._yPos=t,this.posChanged(e))},e.setCurrentPageX=function(t,e){this._pageMode&&this._overlapSize.x>0&&this.setPosX(t*this._pageSize.x,e)},e.setCurrentPageY=function(t,e){this._pageMode&&this._overlapSize.y>0&&this.setPosY(t*this._pageSize.y,e)},e.scrollTop=function(t){void 0===t&&(t=!1),this.setPercY(0,t)},e.scrollBottom=function(t){void 0===t&&(t=!1),this.setPercY(1,t)},e.scrollUp=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this._pageMode?this.setPosY(this._yPos-this._pageSize.y*t,e):this.setPosY(this._yPos-this._scrollStep*t,e)},e.scrollDown=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this._pageMode?this.setPosY(this._yPos+this._pageSize.y*t,e):this.setPosY(this._yPos+this._scrollStep*t,e)},e.scrollLeft=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this._pageMode?this.setPosX(this._xPos-this._pageSize.x*t,e):this.setPosX(this._xPos-this._scrollStep*t,e)},e.scrollRight=function(t,e){void 0===t&&(t=1),void 0===e&&(e=!1),this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,e):this.setPosX(this._xPos+this._scrollStep*t,e)},e.scrollToView=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh();var s;if(t instanceof fairygui.GObject?t.parent!=this._owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,fairygui.ScrollPane.sHelperRect),s=this._owner.globalToLocalRect(fairygui.ScrollPane.sHelperRect.x,fairygui.ScrollPane.sHelperRect.y,fairygui.ScrollPane.sHelperRect.width,fairygui.ScrollPane.sHelperRect.height,fairygui.ScrollPane.sHelperRect)):(s=fairygui.ScrollPane.sHelperRect,s.setTo(t.x,t.y,t.width,t.height)):s=t,this._overlapSize.y>0){var n=this._yPos+this._viewSize.y;i||s.y<=this._yPos||s.height>=this._viewSize.y?this._pageMode?this.setPosY(Math.floor(s.y/this._pageSize.y)*this._pageSize.y,e):this.setPosY(s.y,e):s.y+s.height>n&&(this._pageMode?this.setPosY(Math.floor(s.y/this._pageSize.y)*this._pageSize.y,e):s.height<=this._viewSize.y/2?this.setPosY(s.y+2*s.height-this._viewSize.y,e):this.setPosY(s.y+s.height-this._viewSize.y,e))}if(this._overlapSize.x>0){var h=this._xPos+this._viewSize.x;i||s.x<=this._xPos||s.width>=this._viewSize.x?this._pageMode?this.setPosX(Math.floor(s.x/this._pageSize.x)*this._pageSize.x,e):this.setPosX(s.x,e):s.x+s.width>h&&(this._pageMode?this.setPosX(Math.floor(s.x/this._pageSize.x)*this._pageSize.x,e):s.width<=this._viewSize.x/2?this.setPosX(s.x+2*s.width-this._viewSize.x,e):this.setPosX(s.x+s.width-this._viewSize.x,e))}!e&&this._needRefresh&&this.refresh()},e.isChildInView=function(t){if(this._overlapSize.y>0){var e=t.y+this._container.y;if(e<-t.height||e>this._viewSize.y)return!1}return this._overlapSize.x>0&&(e=t.x+this._container.x,e<-t.width||e>this._viewSize.x)?!1:!0},e.cancelDragging=function(){this._owner.displayObject.stage.off("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.off("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.off("click",this,this.__click),t.draggingPane==this&&(t.draggingPane=null),t._gestureFlag=0,this.isDragged=!1,this._maskContainer.mouseEnabled=!0},e.lockHeader=function(t){this._headerLockedSize!=t&&(this._headerLockedSize=t,!this._refreshEventDispatching&&this._container[this._refreshBarAxis]>=0&&(this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0),this._tweenChange[this._refreshBarAxis]=this._headerLockedSize-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(.3,.3),this._tweenTime.setTo(0,0),this._tweening=2,i.timer.frameLoop(1,this,this.tweenUpdate)))},e.lockFooter=function(t){if(this._footerLockedSize!=t&&(this._footerLockedSize=t,!this._refreshEventDispatching&&this._container[this._refreshBarAxis]<=-this._overlapSize[this._refreshBarAxis])){this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0);var e=this._overlapSize[this._refreshBarAxis];0==e?e=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):e+=this._footerLockedSize,this._tweenChange[this._refreshBarAxis]=-e-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(.3,.3),this._tweenTime.setTo(0,0),this._tweening=2,i.timer.frameLoop(1,this,this.tweenUpdate)}},e.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},e.handleControllerChanged=function(t){this._pageController==t&&(0==this._scrollType?this.setCurrentPageX(t.selectedIndex,!0):this.setCurrentPageY(t.selectedIndex,!0))},e.updatePageController=function(){if(null!=this._pageController&&!this._pageController.changing){var t=0;if(t=0==this._scrollType?this.currentPageX:this.currentPageY,t<this._pageController.pageCount){var e=this._pageController;this._pageController=null,e.selectedIndex=t,this._pageController=e}}},e.adjustMaskContainer=function(){var t=0/0,e=0/0;t=this._displayOnLeft&&null!=this._vtScrollBar?Math.floor(this._owner.margin.left+this._vtScrollBar.width):Math.floor(this._owner.margin.left),e=Math.floor(this._owner.margin.top),this._maskContainer.pos(t,e),0!=this._owner._alignOffset.x||0!=this._owner._alignOffset.y?(null==this._alignContainer&&(this._alignContainer=new b,this._maskContainer.addChild(this._alignContainer),this._alignContainer.addChild(this._container)),this._alignContainer.pos(this._owner._alignOffset.x,this._owner._alignOffset.y)):this._alignContainer&&this._alignContainer.pos(0,0)},e.setSize=function(t,e){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._displayOnLeft?this._scrollBarMargin.left+this._vtScrollBar.width:this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._vtScrollBar.height=this._hzScrollBar?e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewSize.x=t,this._viewSize.y=e,this._hzScrollBar&&!this._hScrollNone&&(this._viewSize.y-=this._hzScrollBar.height),this._vtScrollBar&&!this._vScrollNone&&(this._viewSize.x-=this._vtScrollBar.width),this._viewSize.x-=this._owner.margin.left+this._owner.margin.right,this._viewSize.y-=this._owner.margin.top+this._owner.margin.bottom,this._viewSize.x=Math.max(1,this._viewSize.x),this._viewSize.y=Math.max(1,this._viewSize.y),this._pageSize.x=this._viewSize.x,this._pageSize.y=this._viewSize.y,this.handleSizeChanged()},e.setContentSize=function(t,e){(this._contentSize.x!=t||this._contentSize.y!=e)&&(this._contentSize.x=t,this._contentSize.y=e,this.handleSizeChanged())},e.changeContentSizeOnScrolling=function(t,e,i,s){var n=this._xPos==this._overlapSize.x,h=this._yPos==this._overlapSize.y;this._contentSize.x+=t,this._contentSize.y+=e,this.handleSizeChanged(),1==this._tweening?(0!=t&&n&&this._tweenChange.x<0&&(this._xPos=this._overlapSize.x,this._tweenChange.x=-this._xPos-this._tweenStart.x),0!=e&&h&&this._tweenChange.y<0&&(this._yPos=this._overlapSize.y,this._tweenChange.y=-this._yPos-this._tweenStart.y)):2==this._tweening?(0!=i&&(this._container.x-=i,this._tweenStart.x-=i,this._xPos=-this._container.x),0!=s&&(this._container.y-=s,this._tweenStart.y-=s,this._yPos=-this._container.y)):this.isDragged?(0!=i&&(this._container.x-=i,this._containerPos.x-=i,this._xPos=-this._container.x),0!=s&&(this._container.y-=s,this._containerPos.y-=s,this._yPos=-this._container.y)):(0!=t&&n&&(this._xPos=this._overlapSize.x,this._container.x=-this._xPos),0!=e&&h&&(this._yPos=this._overlapSize.y,this._container.y=-this._yPos)),this._pageMode&&this.updatePageController()},e.handleSizeChanged=function(t){void 0===t&&(t=!1),this._displayInDemand&&(this._vtScrollBar&&(this._contentSize.y<=this._viewSize.y?this._vScrollNone||(this._vScrollNone=!0,this._viewSize.x+=this._vtScrollBar.width):this._vScrollNone&&(this._vScrollNone=!1,this._viewSize.x-=this._vtScrollBar.width)),this._hzScrollBar&&(this._contentSize.x<=this._viewSize.x?this._hScrollNone||(this._hScrollNone=!0,this._viewSize.y+=this._hzScrollBar.height):this._hScrollNone&&(this._hScrollNone=!1,this._viewSize.y-=this._hzScrollBar.height))),this._vtScrollBar&&(this._viewSize.y<this._vtScrollBar.minSize?this._vtScrollBar.displayObject.visible=!1:(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone,this._vtScrollBar.displayPerc=0==this._contentSize.y?0:Math.min(1,this._viewSize.y/this._contentSize.y))),this._hzScrollBar&&(this._viewSize.x<this._hzScrollBar.minSize?this._hzScrollBar.displayObject.visible=!1:(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone,this._hzScrollBar.displayPerc=0==this._contentSize.x?0:Math.min(1,this._viewSize.x/this._contentSize.x)));var e=this._maskContainer.scrollRect;if(e&&(e.width=this._viewSize.x,e.height=this._viewSize.y,this._maskContainer.scrollRect=e),this._overlapSize.x=0==this._scrollType||2==this._scrollType?Math.ceil(Math.max(0,this._contentSize.x-this._viewSize.x)):0,this._overlapSize.y=1==this._scrollType||2==this._scrollType?Math.ceil(Math.max(0,this._contentSize.y-this._viewSize.y)):0,this._xPos=I.clamp(this._xPos,0,this._overlapSize.x),this._yPos=I.clamp(this._yPos,0,this._overlapSize.y),null!=this._refreshBarAxis){var i=this._overlapSize[this._refreshBarAxis];0==i?i=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):i+=this._footerLockedSize,"x"==this._refreshBarAxis?this._container.pos(I.clamp(this._container.x,-i,this._headerLockedSize),I.clamp(this._container.y,-this._overlapSize.y,0)):this._container.pos(I.clamp(this._container.x,-this._overlapSize.x,0),I.clamp(this._container.y,-i,this._headerLockedSize)),null!=this._header&&("x"==this._refreshBarAxis?this._header.height=this._viewSize.y:this._header.width=this._viewSize.x),null!=this._footer&&("y"==this._refreshBarAxis?this._footer.height=this._viewSize.y:this._footer.width=this._viewSize.x)}else this._container.pos(I.clamp(this._container.x,-this._overlapSize.x,0),I.clamp(this._container.y,-this._overlapSize.y,0));this.syncScrollBar(!0),this.checkRefreshBar(),this._pageMode&&this.updatePageController()},e.posChanged=function(t){0==this._aniFlag?this._aniFlag=t?1:-1:1!=this._aniFlag||t||(this._aniFlag=-1),this._needRefresh=!0,i.timer.callLater(this,this.refresh)},e.refresh=function(){this._needRefresh=!1,i.timer.clear(this,this.refresh),(this._pageMode||this._snapToItem)&&(t.sEndPos.setTo(-this._xPos,-this._yPos),this.alignPosition(t.sEndPos,!1),this._xPos=-t.sEndPos.x,this._yPos=-t.sEndPos.y),this.refresh2(),j.dispatch("fui_scroll",this._owner.displayObject),this._needRefresh&&(this._needRefresh=!1,i.timer.clear(this,this.refresh),this.refresh2()),this.syncScrollBar(),this._aniFlag=0},e.refresh2=function(){if(1!=this._aniFlag||this.isDragged)0!=this._tweening&&this.killTween(),this._container.pos(Math.floor(-this._xPos),Math.floor(-this._yPos)),this.loopCheckingCurrent();else{var t=0/0,e=0/0;this._overlapSize.x>0?t=-Math.floor(this._xPos):(0!=this._container.x&&(this._container.x=0),t=0),this._overlapSize.y>0?e=-Math.floor(this._yPos):(0!=this._container.y&&(this._container.y=0),e=0),t!=this._container.x||e!=this._container.y?(this._tweening=1,this._tweenTime.setTo(0,0),this._tweenDuration.setTo(.5,.5),this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(t-this._tweenStart.x,e-this._tweenStart.y),i.timer.frameLoop(1,this,this.tweenUpdate)):0!=this._tweening&&this.killTween()}this._pageMode&&this.updatePageController()},e.syncScrollBar=function(t){void 0===t&&(t=!1),null!=this._vtScrollBar&&(this._vtScrollBar.scrollPerc=0==this._overlapSize.y?0:I.clamp(-this._container.y,0,this._overlapSize.y)/this._overlapSize.y,this._scrollBarDisplayAuto&&this.showScrollBar(!t)),null!=this._hzScrollBar&&(this._hzScrollBar.scrollPerc=0==this._overlapSize.x?0:I.clamp(-this._container.x,0,this._overlapSize.x)/this._overlapSize.x,this._scrollBarDisplayAuto&&this.showScrollBar(!t)),t&&(this._maskContainer.mouseEnabled=!0)},e.__mouseDown=function(){if(this._touchEffect){0!=this._tweening?(this.killTween(),this.isDragged=!0):this.isDragged=!1;var t=this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint);this._containerPos.setTo(this._container.x,this._container.y),this._beginTouchPos.setTo(t.x,t.y),this._lastTouchPos.setTo(t.x,t.y),this._lastTouchGlobalPos.setTo(i.stage.mouseX,i.stage.mouseY),this._isHoldAreaDone=!1,this._velocity.setTo(0,0),this._velocityScale=1,this._lastMoveTime=i.timer.currTimer/1e3,this._owner.displayObject.stage.on("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.on("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.on("click",this,this.__click)}},e.__mouseMove=function(){if(this._touchEffect&&(null==t.draggingPane||t.draggingPane==this)&&null==P.draggingObject){var e=ie.touchScrollSensitivity,s=this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint),n=0/0,h=0/0,r=!1,o=!1;if(1==this._scrollType){if(!this._isHoldAreaDone){if(t._gestureFlag|=1,n=Math.abs(this._beginTouchPos.y-s.y),e>n)return;if(0!=(2&t._gestureFlag)&&(h=Math.abs(this._beginTouchPos.x-s.x),h>n))return}r=!0}else if(0==this._scrollType){if(!this._isHoldAreaDone){if(t._gestureFlag|=2,n=Math.abs(this._beginTouchPos.x-s.x),e>n)return;if(0!=(1&t._gestureFlag)&&(h=Math.abs(this._beginTouchPos.y-s.y),h>n))return}o=!0}else{if(t._gestureFlag=3,!this._isHoldAreaDone&&(n=Math.abs(this._beginTouchPos.y-s.y),e>n&&(n=Math.abs(this._beginTouchPos.x-s.x),e>n)))return;r=o=!0}var a=Math.floor(this._containerPos.x+s.x-this._beginTouchPos.x),l=Math.floor(this._containerPos.y+s.y-this._beginTouchPos.y);r&&(this._container.y=l>0?this._bouncebackEffect?null!=this._header&&0!=this._header.maxHeight?Math.floor(Math.min(.5*l,this._header.maxHeight)):Math.floor(Math.min(.5*l,.5*this._viewSize.y)):0:l<-this._overlapSize.y?this._bouncebackEffect?null!=this._footer&&this._footer.maxHeight>0?Math.floor(Math.max(.5*(l+this._overlapSize.y),-this._footer.maxHeight)-this._overlapSize.y):Math.floor(Math.max(.5*(l+this._overlapSize.y),.5*-this._viewSize.y)-this._overlapSize.y):-this._overlapSize.y:l),o&&(this._container.x=a>0?this._bouncebackEffect?null!=this._header&&0!=this._header.maxWidth?Math.floor(Math.min(.5*a,this._header.maxWidth)):Math.floor(Math.min(.5*a,.5*this._viewSize.x)):0:a<0-this._overlapSize.x?this._bouncebackEffect?null!=this._footer&&this._footer.maxWidth>0?Math.floor(Math.max(.5*(a+this._overlapSize.x),-this._footer.maxWidth)-this._overlapSize.x):Math.floor(Math.max(.5*(a+this._overlapSize.x),.5*-this._viewSize.x)-this._overlapSize.x):-this._overlapSize.x:a);var u="slow"==i.stage.frameRate?30:60,_=i.timer.currTimer/1e3,c=Math.max(_-this._lastMoveTime,1/u),d=s.x-this._lastTouchPos.x,f=s.y-this._lastTouchPos.y;if(o||(d=0),r||(f=0),0!=c){var g=c*u-1;if(g>1){var p=Math.pow(.833,g);this._velocity.x=this._velocity.x*p,this._velocity.y=this._velocity.y*p}this._velocity.x=I.lerp(this._velocity.x,60*d/u/c,10*c),this._velocity.y=I.lerp(this._velocity.y,60*f/u/c,10*c)}var m=this._lastTouchGlobalPos.x-i.stage.mouseX,v=this._lastTouchGlobalPos.y-i.stage.mouseY;0!=d?this._velocityScale=Math.abs(m/d):0!=f&&(this._velocityScale=Math.abs(v/f)),this._lastTouchPos.setTo(s.x,s.y),this._lastTouchGlobalPos.setTo(i.stage.mouseX,i.stage.mouseY),this._lastMoveTime=_,this._overlapSize.x>0&&(this._xPos=I.clamp(-this._container.x,0,this._overlapSize.x)),this._overlapSize.y>0&&(this._yPos=I.clamp(-this._container.y,0,this._overlapSize.y)),0!=this._loop&&(a=this._container.x,l=this._container.y,this.loopCheckingCurrent()&&(this._containerPos.x+=this._container.x-a,this._containerPos.y+=this._container.y-l)),t.draggingPane=this,this._isHoldAreaDone=!0,this.isDragged=!0,this._maskContainer.mouseEnabled=!1,this.syncScrollBar(),this.checkRefreshBar(),this._pageMode&&this.updatePageController(),j.dispatch("fui_scroll",this._owner.displayObject)}},e.__mouseUp=function(){if(this._owner.displayObject.stage.off("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.off("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.off("click",this,this.__click),t.draggingPane==this&&(t.draggingPane=null),t._gestureFlag=0,!this.isDragged||!this._touchEffect)return this.isDragged=!1,this._maskContainer.mouseEnabled=!0,void 0;this.isDragged=!1,this._maskContainer.mouseEnabled=!0,this._tweenStart.setTo(this._container.x,this._container.y),t.sEndPos.setTo(this._tweenStart.x,this._tweenStart.y);var e=!1;if(this._container.x>0?(t.sEndPos.x=0,e=!0):this._container.x<-this._overlapSize.x&&(t.sEndPos.x=-this._overlapSize.x,e=!0),this._container.y>0?(t.sEndPos.y=0,e=!0):this._container.y<-this._overlapSize.y&&(t.sEndPos.y=-this._overlapSize.y,e=!0),e){if(this._tweenChange.setTo(t.sEndPos.x-this._tweenStart.x,t.sEndPos.y-this._tweenStart.y),this._tweenChange.x<-ie.touchDragSensitivity||this._tweenChange.y<-ie.touchDragSensitivity?(this._refreshEventDispatching=!0,j.dispatch("fui_pull_down_release",this._owner.displayObject),this._refreshEventDispatching=!1):(this._tweenChange.x>ie.touchDragSensitivity||this._tweenChange.y>ie.touchDragSensitivity)&&(this._refreshEventDispatching=!0,j.dispatch("fui_pull_up_release",this._owner.displayObject),this._refreshEventDispatching=!1),this._headerLockedSize>0&&0==t.sEndPos[this._refreshBarAxis])t.sEndPos[this._refreshBarAxis]=this._headerLockedSize,this._tweenChange.x=t.sEndPos.x-this._tweenStart.x,this._tweenChange.y=t.sEndPos.y-this._tweenStart.y;else if(this._footerLockedSize>0&&t.sEndPos[this._refreshBarAxis]==-this._overlapSize[this._refreshBarAxis]){var s=this._overlapSize[this._refreshBarAxis];0==s?s=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):s+=this._footerLockedSize,t.sEndPos[this._refreshBarAxis]=-s,this._tweenChange.x=t.sEndPos.x-this._tweenStart.x,this._tweenChange.y=t.sEndPos.y-this._tweenStart.y}this._tweenDuration.setTo(.3,.3)}else{if(this._inertiaDisabled)this._tweenDuration.setTo(.3,.3);else{var n="slow"==i.stage.frameRate?30:60,h=(i.timer.currTimer/1e3-this._lastMoveTime)*n-1;if(h>1){var r=Math.pow(.833,h);this._velocity.x=this._velocity.x*r,this._velocity.y=this._velocity.y*r}this.updateTargetAndDuration(this._tweenStart,t.sEndPos)}if(t.sOldChange.setTo(t.sEndPos.x-this._tweenStart.x,t.sEndPos.y-this._tweenStart.y),this.loopCheckingTarget(t.sEndPos),(this._pageMode||this._snapToItem)&&this.alignPosition(t.sEndPos,!0),this._tweenChange.x=t.sEndPos.x-this._tweenStart.x,this._tweenChange.y=t.sEndPos.y-this._tweenStart.y,0==this._tweenChange.x&&0==this._tweenChange.y)return this._scrollBarDisplayAuto&&this.showScrollBar(!1),void 0;
(this._pageMode||this._snapToItem)&&(this.fixDuration("x",t.sOldChange.x),this.fixDuration("y",t.sOldChange.y))}this._tweening=2,this._tweenTime.setTo(0,0),i.timer.frameLoop(1,this,this.tweenUpdate)},e.__click=function(){this.isDragged=!1},e.__mouseWheel=function(t){if(this._mouseWheelEnabled){var e=(this._owner.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.ScrollPane.sHelperPoint),t.delta);e=e>0?-1:0>e?1:0,this._overlapSize.x>0&&0==this._overlapSize.y?this._pageMode?this.setPosX(this._xPos+this._pageSize.x*e,!1):this.setPosX(this._xPos+this._mouseWheelStep*e,!1):this._pageMode?this.setPosY(this._yPos+this._pageSize.y*e,!1):this.setPosY(this._yPos+this._mouseWheelStep*e,!1)}},e.__rollOver=function(){this.showScrollBar(!0)},e.__rollOut=function(){this.showScrollBar(!1)},e.showScrollBar=function(t){t?(this.__showScrollBar(!0),i.timer.clear(this,this.__showScrollBar)):i.timer.once(500,this,this.__showScrollBar,[t])},e.__showScrollBar=function(t){this._scrollBarVisible=t&&this._viewSize.x>0&&this._viewSize.y>0,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone)},e.getLoopPartSize=function(t,e){return(this._contentSize[e]+("x"==e?this._owner.columnGap:this._owner.lineGap))/t},e.loopCheckingCurrent=function(){var t=!1;return 1==this._loop&&this._overlapSize.x>0?this._xPos<.001?(this._xPos+=this.getLoopPartSize(2,"x"),t=!0):this._xPos>=this._overlapSize.x&&(this._xPos-=this.getLoopPartSize(2,"x"),t=!0):2==this._loop&&this._overlapSize.y>0&&(this._yPos<.001?(this._yPos+=this.getLoopPartSize(2,"y"),t=!0):this._yPos>=this._overlapSize.y&&(this._yPos-=this.getLoopPartSize(2,"y"),t=!0)),t&&this._container.pos(Math.floor(-this._xPos),Math.floor(-this._yPos)),t},e.loopCheckingTarget=function(t){1==this._loop&&this.loopCheckingTarget2(t,"x"),2==this._loop&&this.loopCheckingTarget2(t,"y")},e.loopCheckingTarget2=function(t,e){var i=0/0,s=0/0;t[e]>0?(i=this.getLoopPartSize(2,e),s=this._tweenStart[e]-i,0>=s&&s>=-this._overlapSize[e]&&(t[e]-=i,this._tweenStart[e]=s)):t[e]<-this._overlapSize[e]&&(i=this.getLoopPartSize(2,e),s=this._tweenStart[e]+i,0>=s&&s>=-this._overlapSize[e]&&(t[e]+=i,this._tweenStart[e]=s))},e.loopCheckingNewPos=function(t,e){if(0==this._overlapSize[e])return t;var i="x"==e?this._xPos:this._yPos,s=!1,n=0/0;return.001>t?(t+=this.getLoopPartSize(2,e),t>i&&(n=this.getLoopPartSize(6,e),n=Math.ceil((t-i)/n)*n,i=I.clamp(i+n,0,this._overlapSize[e]),s=!0)):t>=this._overlapSize[e]&&(t-=this.getLoopPartSize(2,e),i>t&&(n=this.getLoopPartSize(6,e),n=Math.ceil((i-t)/n)*n,i=I.clamp(i-n,0,this._overlapSize[e]),s=!0)),s&&("x"==e?this._container.x=-Math.floor(i):this._container.y=-Math.floor(i)),t},e.alignPosition=function(e,i){if(this._pageMode)e.x=this.alignByPage(e.x,"x",i),e.y=this.alignByPage(e.y,"y",i);else if(this._snapToItem){var s=0,n=0;i&&(s=e.x-this._containerPos.x,n=e.y-this._containerPos.y);var h=this._owner.getSnappingPositionWithDir(-e.x,-e.y,s,n,t.sHelperPoint);e.x<0&&e.x>-this._overlapSize.x&&(e.x=-h.x),e.y<0&&e.y>-this._overlapSize.y&&(e.y=-h.y)}},e.alignByPage=function(t,e,i){var s=0;if(t>0)s=0;else if(t<-this._overlapSize[e])s=Math.ceil(this._contentSize[e]/this._pageSize[e])-1;else{s=Math.floor(-t/this._pageSize[e]);var n=i?t-this._containerPos[e]:t-this._container[e],h=Math.min(this._pageSize[e],this._contentSize[e]-(s+1)*this._pageSize[e]),r=-t-s*this._pageSize[e];Math.abs(n)>this._pageSize[e]?r>.5*h&&s++:r>h*(0>n?ie.defaultScrollPagingThreshold:1-ie.defaultScrollPagingThreshold)&&s++,t=-s*this._pageSize[e],t<-this._overlapSize[e]&&(t=-this._overlapSize[e])}if(i){var o=this._tweenStart[e],a=0;a=o>0?0:o<-this._overlapSize[e]?Math.ceil(this._contentSize[e]/this._pageSize[e])-1:Math.floor(-o/this._pageSize[e]);var l=Math.floor(-this._containerPos[e]/this._pageSize[e]);Math.abs(s-l)>1&&Math.abs(a-l)<=1&&(s=s>l?l+1:l-1,t=-s*this._pageSize[e])}return t},e.updateTargetAndDuration=function(t,e){e.x=this.updateTargetAndDuration2(t.x,"x"),e.y=this.updateTargetAndDuration2(t.y,"y")},e.updateTargetAndDuration2=function(t,e){var s=this._velocity[e],n=0;if(t>0)t=0;else if(t<-this._overlapSize[e])t=-this._overlapSize[e];else{var h=Math.abs(s)*this._velocityScale;o.onMobile&&(h*=1136/Math.max(i.stage.width,i.stage.height));var r=0;if(this._pageMode||!o.onMobile?h>500&&(r=Math.pow((h-500)/500,2)):h>1e3&&(r=Math.pow((h-1e3)/1e3,2)),0!=r){r>1&&(r=1),h*=r,s*=r,this._velocity[e]=s,n=Math.log(60/h)/Math.log(this._decelerationRate)/60;var a=Math.floor(s*n*.4);t+=a}}return.3>n&&(n=.3),this._tweenDuration[e]=n,t},e.fixDuration=function(t,e){if(!(0==this._tweenChange[t]||Math.abs(this._tweenChange[t])>=Math.abs(e))){var i=Math.abs(this._tweenChange[t]/e)*this._tweenDuration[t];.3>i&&(i=.3),this._tweenDuration[t]=i}},e.killTween=function(){1==this._tweening&&(this._container.pos(this._tweenStart.x+this._tweenChange.x,this._tweenStart.y+this._tweenChange.y),j.dispatch("fui_scroll",this._owner.displayObject)),this._tweening=0,i.timer.clear(this,this.tweenUpdate),j.dispatch("fui_scroll_end",this._owner.displayObject)},e.checkRefreshBar=function(){if(null!=this._header||null!=this._footer){var e=this._container[this._refreshBarAxis];if(null!=this._header)if(e>0){null==this._header.displayObject.parent&&this._maskContainer.addChildAt(this._header.displayObject,0);var i=t.sHelperPoint;i.setTo(this._header.width,this._header.height),i[this._refreshBarAxis]=e,this._header.setSize(i.x,i.y)}else null!=this._header.displayObject.parent&&this._maskContainer.removeChild(this._header.displayObject);if(null!=this._footer){var s=this._overlapSize[this._refreshBarAxis];-s>e||0==s&&this._footerLockedSize>0?(null==this._footer.displayObject.parent&&this._maskContainer.addChildAt(this._footer.displayObject,0),i=t.sHelperPoint,i.setTo(this._footer.x,this._footer.y),i[this._refreshBarAxis]=s>0?e+this._contentSize[this._refreshBarAxis]:Math.max(Math.min(e+this._viewSize[this._refreshBarAxis],this._viewSize[this._refreshBarAxis]-this._footerLockedSize),this._viewSize[this._refreshBarAxis]-this._contentSize[this._refreshBarAxis]),this._footer.setXY(i.x,i.y),i.setTo(this._footer.width,this._footer.height),i[this._refreshBarAxis]=s>0?-s-e:this._viewSize[this._refreshBarAxis]-this._footer[this._refreshBarAxis],this._footer.setSize(i.x,i.y)):null!=this._footer.displayObject.parent&&this._maskContainer.removeChild(this._footer.displayObject)}}},e.tweenUpdate=function(){var t=this.runTween("x"),e=this.runTween("y");this._container.pos(t,e),2==this._tweening&&(this._overlapSize.x>0&&(this._xPos=I.clamp(-t,0,this._overlapSize.x)),this._overlapSize.y>0&&(this._yPos=I.clamp(-e,0,this._overlapSize.y)),this._pageMode&&this.updatePageController()),0==this._tweenChange.x&&0==this._tweenChange.y?(this._tweening=0,i.timer.clear(this,this.tweenUpdate),this.loopCheckingCurrent(),this.syncScrollBar(!0),this.checkRefreshBar(),j.dispatch("fui_scroll",this._owner.displayObject),j.dispatch("fui_scroll_end",this._owner.displayObject)):(this.syncScrollBar(!1),this.checkRefreshBar(),j.dispatch("fui_scroll",this._owner.displayObject))},e.runTween=function(e){var s=0/0;if(0!=this._tweenChange[e]){if(this._tweenTime[e]+=i.timer.delta/1e3,this._tweenTime[e]>=this._tweenDuration[e])s=this._tweenStart[e]+this._tweenChange[e],this._tweenChange[e]=0;else{var n=t.easeFunc(this._tweenTime[e],this._tweenDuration[e]);s=this._tweenStart[e]+Math.floor(this._tweenChange[e]*n)}var h=0,r=-this._overlapSize[e];if(this._headerLockedSize>0&&this._refreshBarAxis==e&&(h=this._headerLockedSize),this._footerLockedSize>0&&this._refreshBarAxis==e){var o=this._overlapSize[this._refreshBarAxis];0==o?o=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):o+=this._footerLockedSize,r=-o}2==this._tweening&&this._bouncebackEffect?s>20+h&&this._tweenChange[e]>0||s>h&&0==this._tweenChange[e]?(this._tweenTime[e]=0,this._tweenDuration[e]=.3,this._tweenChange[e]=-s+h,this._tweenStart[e]=s):(r-20>s&&this._tweenChange[e]<0||r>s&&0==this._tweenChange[e])&&(this._tweenTime[e]=0,this._tweenDuration[e]=.3,this._tweenChange[e]=r-s,this._tweenStart[e]=s):s>h?(s=h,this._tweenChange[e]=0):r>s&&(s=r,this._tweenChange[e]=0)}else s=this._container[e];return s},h(0,e,"viewWidth",function(){return this._viewSize.x},function(t){t=t+this._owner.margin.left+this._owner.margin.right,null!=this._vtScrollBar&&(t+=this._vtScrollBar.width),this._owner.width=t}),h(0,e,"percY",function(){return 0==this._overlapSize.y?0:this._yPos/this._overlapSize.y},function(t){this.setPercY(t,!1)}),h(0,e,"owner",function(){return this._owner}),h(0,e,"bouncebackEffect",function(){return this._bouncebackEffect},function(t){this._bouncebackEffect=t}),h(0,e,"vtScrollBar",function(){return this._vtScrollBar}),h(0,e,"hzScrollBar",function(){return this._hzScrollBar}),h(0,e,"header",function(){return this._header}),h(0,e,"footer",function(){return this._footer}),h(0,e,"isBottomMost",function(){return this._yPos==this._overlapSize.y||0==this._overlapSize.y}),h(0,e,"touchEffect",function(){return this._touchEffect},function(t){this._touchEffect=t}),h(0,e,"contentWidth",function(){return this._contentSize.x}),h(0,e,"scrollStep",function(){return this._scrollStep},function(t){this._scrollStep=t,0==this._scrollStep&&(this._scrollStep=ie.defaultScrollStep),this._mouseWheelStep=2*this._scrollStep}),h(0,e,"viewHeight",function(){return this._viewSize.y},function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,null!=this._hzScrollBar&&(t+=this._hzScrollBar.height),this._owner.height=t}),h(0,e,"posX",function(){return this._xPos},function(t){this.setPosX(t,!1)}),h(0,e,"snapToItem",function(){return this._snapToItem},function(t){this._snapToItem=t}),h(0,e,"mouseWheelEnabled",function(){return this._mouseWheelEnabled},function(t){this._mouseWheelEnabled=t}),h(0,e,"decelerationRate",function(){return this._decelerationRate},function(t){this._decelerationRate=t}),h(0,e,"percX",function(){return 0==this._overlapSize.x?0:this._xPos/this._overlapSize.x},function(t){this.setPercX(t,!1)}),h(0,e,"posY",function(){return this._yPos},function(t){this.setPosY(t,!1)}),h(0,e,"contentHeight",function(){return this._contentSize.y}),h(0,e,"currentPageX",function(){if(!this._pageMode)return 0;var t=Math.floor(this._xPos/this._pageSize.x);return this._xPos-t*this._pageSize.x>.5*this._pageSize.x&&t++,t},function(t){this.setCurrentPageX(t,!1)}),h(0,e,"currentPageY",function(){if(!this._pageMode)return 0;var t=Math.floor(this._yPos/this._pageSize.y);return this._yPos-t*this._pageSize.y>.5*this._pageSize.y&&t++,t},function(t){this.setCurrentPageY(t,!1)}),h(0,e,"isRightMost",function(){return this._xPos==this._overlapSize.x||0==this._overlapSize.x}),h(0,e,"pageController",function(){return this._pageController},function(t){this._pageController=t}),h(0,e,"scrollingPosX",function(){return I.clamp(-this._container.x,0,this._overlapSize.x)}),h(0,e,"scrollingPosY",function(){return I.clamp(-this._container.y,0,this._overlapSize.y)}),t.easeFunc=function(t,e){return(t=t/e-1)*t*t+1},t.draggingPane=null,t._gestureFlag=0,t.TWEEN_TIME_GO=.5,t.TWEEN_TIME_DEFAULT=.3,t.PULL_RATIO=.5,s(t,["sHelperPoint",function(){return this.sHelperPoint=new m},"sHelperRect",function(){return this.sHelperRect=new v},"sEndPos",function(){return this.sEndPos=new m},"sOldChange",function(){return this.sOldChange=new m}]),t}(),$=(function(){function t(){}return n(t,"fairygui.ButtonMode"),t.Common=0,t.Check=1,t.Radio=2,t}(),function(){function t(){this._id=null,this._name=null,this._items=null,this._itemsById=null,this._itemsByName=null,this._customId=null,this._sprites=null,this._items=[],this._itemsById={},this._itemsByName={},this._sprites={}}var e;n(t,"fairygui.UIPackage");var s=t.prototype;return s.loadPackage=function(t,i){if(1179080009!=t.getUint32())throw new Error("FairyGUI: old package format found in '"+i+"'");t.version=t.getInt32();var s=t.readBool();if(this._id=t.readUTFString(),this._name=t.readUTFString(),t.skip(20),s){var n=new Uint8Array(t.buffer,t.pos,t.length-t.pos),h=new Zlib.RawInflate(n);n=h.decompress(),t=new ce(n)}var o=t.pos,a=0,l=0,u=0;t.seek(o,4),a=t.getInt32();var _=r(a);for(l=0;a>l;l++)_[l]=t.readUTFString();t.stringTable=_,t.seek(o,1);var c;for(i+="_",a=t.getUint16(),l=0;a>l;l++){switch(u=t.getInt32(),u+=t.pos,c=new G,c.owner=this,c.type=t.readByte(),c.id=t.readS(),c.name=t.readS(),t.readS(),c.file=t.readS(),t.readBool(),c.width=t.getInt32(),c.height=t.getInt32(),c.type){case 0:c.objectType=0;var d=t.readByte();1==d?(c.scale9Grid=new laya.maths.Rectangle,c.scale9Grid.x=t.getInt32(),c.scale9Grid.y=t.getInt32(),c.scale9Grid.width=t.getInt32(),c.scale9Grid.height=t.getInt32(),c.tileGridIndice=t.getInt32()):2==d&&(c.scaleByTile=!0),c.smoothing=t.readBool();break;case 1:c.smoothing=t.readBool(),c.objectType=1,c.rawData=t.readBuffer();break;case 5:c.rawData=t.readBuffer();break;case 3:var f=t.readByte();c.objectType=f>0?f:9,c.rawData=t.readBuffer(),Q.resolvePackageItemExtension(c);break;case 4:case 2:case 7:c.file=i+c.file}this._items.push(c),this._itemsById[c.id]=c,null!=c.name&&(this._itemsByName[c.name]=c),t.pos=u}for(t.seek(o,2),a=t.getUint16(),l=0;a>l;l++){u=t.getUint16(),u+=t.pos;var g=t.readS();c=this._itemsById[t.readS()];var p=new e;p.atlas=c,p.rect.x=t.getInt32(),p.rect.y=t.getInt32(),p.rect.width=t.getInt32(),p.rect.height=t.getInt32(),p.rotated=t.readBool(),this._sprites[g]=p,t.pos=u}if(t.seek(o,3))for(a=t.getUint16(),l=0;a>l;l++)u=t.getInt32(),u+=t.pos,c=this._itemsById[t.readS()],c&&0==c.type&&(c.pixelHitTestData=new F,c.pixelHitTestData.load(t)),t.pos=u},s.loadAllAssets=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];this.getItemAsset(i)}},s.unloadAssets=function(){for(var t=this._items.length,e=0;t>e;e++){var s=this._items[e];4==s.type&&null!=s.texture&&i.loader.clearTextureRes(s.texture.url)}},s.dispose=function(){for(var t=this._items.length,e=0;t>e;e++){var i=this._items[e];4==i.type?null!=i.texture&&(i.texture.destroy(),i.texture=null):2==i.type&&w.destroySound(i.file)}},s.createObject=function(t,e){var i=this._itemsByName[t];return i?this.internalCreateObject(i,e):null},s.internalCreateObject=function(t,e){var i;return i=3==t.type?null!=e?new e:Q.newObject(t):Q.newObject(t),null==i?null:(fairygui.UIPackage._constructing++,i.packageItem=t,i.constructFromResource(),fairygui.UIPackage._constructing--,i)},s.getItemById=function(t){return this._itemsById[t]},s.getItemByName=function(t){return this._itemsByName[t]},s.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},s.getItemAsset=function(t){switch(t.type){case 0:if(!t.decoded){t.decoded=!0;var e=this._sprites[t.id];if(null!=e){var i=this.getItemAsset(e.atlas);t.texture=x.create(i,e.rect.x,e.rect.y,e.rect.width,e.rect.height)}else t.texture=null}return t.texture;case 4:return t.decoded||(t.decoded=!0,t.texture=E.inst.getRes(t.file)),t.texture;case 5:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case 1:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case 3:return t.rawData;case 7:return t.file?E.inst.getRes(t.file):null;default:return null}},s.loadMovieClip=function(t){var e=t.rawData;e.seek(0,0),t.interval=e.getInt32(),t.swing=e.readBool(),t.repeatDelay=e.getInt32(),e.seek(0,1);var i=e.getInt16();t.frames=r(i);for(var s,n,h,o=0/0,a=0/0,l=0;i>l;l++){var u=e.getInt16();if(u+=e.pos,n=new A,o=e.getInt32(),a=e.getInt32(),e.getInt32(),e.getInt32(),n.addDelay=e.getInt32(),s=e.readS(),null!=s&&null!=(h=this._sprites[s])){var _=this.getItemAsset(h.atlas);n.texture=x.create(_,h.rect.x,h.rect.y,h.rect.width,h.rect.height,o,a,t.width,t.height)}t.frames[l]=n,e.pos=u}},s.loadFont=function(t){var e=new R;t.bitmapFont=e;var i=t.rawData;i.seek(0,0),e.ttf=i.readBool(),i.readBool(),e.resizable=i.readBool(),i.readBool(),e.size=i.getInt32();var s=i.getInt32(),n=i.getInt32(),h=null,r=this._sprites[t.id];null!=r&&(h=this.getItemAsset(r.atlas)),i.seek(0,1);for(var o=null,a=i.getInt32(),l=0;a>l;l++){var u=i.getInt16();u+=i.pos,o=new U;var _=i.readChar();e.glyphs[_]=o;var c=i.readS(),d=i.getInt32(),f=i.getInt32();if(o.offsetX=i.getInt32(),o.offsetY=i.getInt32(),o.width=i.getInt32(),o.height=i.getInt32(),o.advance=i.getInt32(),o.channel=i.readByte(),1==o.channel?o.channel=3:2==o.channel?o.channel=2:3==o.channel&&(o.channel=1),e.ttf)o.texture=x.create(h,d+r.rect.x,f+r.rect.y,o.width,o.height);else{var g=this._itemsById[c];g&&(this.getItemAsset(g),o.width=g.width,o.height=g.height,o.texture=g.texture)}e.ttf?o.lineHeight=n:(0==o.advance&&(o.advance=0==s?o.offsetX+o.width:s),o.lineHeight=o.offsetY<0?o.height:o.offsetY+o.height,o.lineHeight<e.size&&(o.lineHeight=e.size)),i.pos=u}},h(0,s,"id",function(){return this._id}),h(0,s,"name",function(){return this._name}),h(0,s,"customId",function(){return this._customId},function(t){null!=this._customId&&delete fairygui.UIPackage._packageInstById[this._customId],this._customId=t,null!=this._customId&&(fairygui.UIPackage._packageInstById[this._customId]=this)}),t.getById=function(t){return fairygui.UIPackage._packageInstById[t]},t.getByName=function(t){return fairygui.UIPackage._packageInstByName[t]},t.addPackage=function(e,i){if(!i&&(i=E.inst.getRes(e+"."+ie.packageFileExtension),!i||0==i.byteLength))throw new Error("package resource not ready: "+e);var s=new ce(i),n=new t;return n.loadPackage(s,e),fairygui.UIPackage._packageInstById[n.id]=n,fairygui.UIPackage._packageInstByName[n.name]=n,n.customId=e,n},t.removePackage=function(t){var e=fairygui.UIPackage._packageInstById[t];if(e||(e=fairygui.UIPackage._packageInstByName[t]),!e)throw new Error("unknown package: "+t);e.dispose(),delete fairygui.UIPackage._packageInstById[e.id],null!=e._customId&&delete fairygui.UIPackage._packageInstById[e._customId],delete fairygui.UIPackage._packageInstByName[e.name]},t.createObject=function(t,e,i){var s=fairygui.UIPackage.getByName(t);return s?s.createObject(e,i):null},t.createObjectFromURL=function(t,e){var i=fairygui.UIPackage.getItemByURL(t);return i?i.owner.internalCreateObject(i,e):null},t.getItemURL=function(t,e){var i=fairygui.UIPackage.getByName(t);if(!i)return null;var s=i._itemsByName[e];return s?"ui://"+i.id+s.id:null},t.getItemByURL=function(e){var i=e.indexOf("//");if(-1==i)return null;var s=e.indexOf("/",i+2);if(-1==s){if(e.length>13){var n=e.substr(5,8),h=t.getById(n);if(null!=h){var r=e.substr(13);return h.getItemById(r)}}}else{var o=e.substr(i+2,s-i-2);if(h=t.getByName(o),null!=h){var a=e.substr(s+1);return h.getItemByName(a)}}return null},t.getItemAssetByURL=function(e){var i=t.getItemByURL(e);return null==i?null:i.owner.getItemAsset(i)},t.normalizeURL=function(e){if(null==e)return null;var i=e.indexOf("//");if(-1==i)return null;var s=e.indexOf("/",i+2);if(-1==s)return e;var n=e.substr(i+2,s-i-2),h=e.substr(s+1);return t.getItemURL(n,h)},t.setStringsSource=function(t){q.loadFromXML(t)},t._constructing=0,t._packageInstById={},t._packageInstByName={},t.__init$=function(){e=function(){function t(){this.atlas=null,this.rect=null,this.rotated=!1,this.rect=new v}return n(t,""),t}()},t}()),q=function(){function t(){}return n(t,"fairygui.TranslationHelper"),t.loadFromXML=function(e){t.strings={};for(var i=S.parseXMLFromString(e),s=t.findChildNode(i,"resources"),n=s.childNodes,h=n.length,r=0;h>r;r++){var o=n[r];if("string"==o.nodeName){var a=o.getAttribute("name"),l=o.textContent,u=a.indexOf("-");if(-1==u)continue;var _=a.substr(0,u),c=a.substr(u+1),d=t.strings[_];d||(d={},t.strings[_]=d),d[c]=l}}},t.translateComponent=function(e){if(null!=t.strings){var i=t.strings[e.owner.id+e.id];if(null!=i){var s,n,h,r=e.rawData,o=0,a=0,l=0,u=0,_=0,c=0,d=0,f=0;r.seek(0,2);var g=r.getInt16();for(l=0;g>l;l++){c=r.getInt16(),d=r.pos,r.seek(d,0);var p=r.readByte();r.skip(4),s=r.readS(),9==p&&r.seek(d,6)&&(p=r.readByte()),r.seek(d,1),null!=(n=i[s+"-tips"])&&r.writeS(n),r.seek(d,2);var m=r.getInt16();for(u=0;m>u;u++){if(o=r.getInt16(),o+=r.pos,6==r.readByte()){for(r.skip(2),f=r.getInt16(),_=0;f>_;_++)h=r.readS(),null!=h&&(null!=(n=i[s+"-texts_"+_])?r.writeS(n):r.skip(2));r.readBool()&&null!=(n=i[s+"-texts_def"])&&r.writeS(n)}r.pos=o}switch(p){case 6:case 7:case 8:null!=(n=i[s])&&(r.seek(d,6),r.writeS(n)),null!=(n=i[s+"-prompt"])&&(r.seek(d,4),r.writeS(n));break;case 10:for(r.seek(d,8),r.skip(2),a=r.getInt16(),u=0;a>u;u++)o=r.getInt16(),o+=r.pos,r.skip(2),null!=(n=i[s+"-"+u])?r.writeS(n):r.skip(2),null!=(n=i[s+"-"+u+"-0"])&&r.writeS(n),r.pos=o;break;case 11:r.seek(d,6)&&r.readByte()==p&&(null!=(n=i[s])?r.writeS(n):r.skip(2),r.skip(2),r.readBool()&&r.skip(4),r.skip(4),r.readBool()&&null!=(n=i[s+"-prompt"])&&r.writeS(n));break;case 12:r.seek(d,6)&&r.readByte()==p&&(null!=(n=i[s])?r.writeS(n):r.skip(2),null!=(n=i[s+"-0"])&&r.writeS(n));break;case 13:if(r.seek(d,6)&&r.readByte()==p){for(a=r.getInt16(),u=0;a>u;u++)o=r.getInt16(),o+=r.pos,null!=(n=i[s+"-"+u])&&r.writeS(n),r.pos=o;null!=(n=i[s])&&r.writeS(n)}}r.pos=d+c}}}},t.findChildNode=function(t,e){var i=t.childNodes,s=i.length;if(s>0)for(var n=0;s>n;n++){var h=i[n];if(h.nodeName==e)return h}return null},t.strings=null,t}(),Q=(function(){function t(){}return n(t,"fairygui.PopupDirection"),t.Auto=0,t.Up=1,t.Down=2,t}(),function(){function t(){}return n(t,"fairygui.UIObjectFactory"),t.setPackageItemExtension=function(e,i){if(null==e)throw new Error("Invaild url: "+e);var s=$.getItemByURL(e);null!=s&&(s.extensionType=i),t.packageItemExtensions[e]=i},t.setLoaderExtension=function(t){fairygui.UIObjectFactory.loaderType=t},t.resolvePackageItemExtension=function(e){e.extensionType=t.packageItemExtensions["ui://"+e.owner.id+e.id],e.extensionType||(e.extensionType=t.packageItemExtensions["ui://"+e.owner.name+"/"+e.name])},t.newObject=function(e){return null!=e.extensionType?new e.extensionType:t.newObject2(e.objectType)},t.newObject2=function(t){switch(t){case 0:return new ye;case 1:return new fe;case 9:return new oe;case 6:return new Le;case 7:return new Be;case 8:return new Me;case 5:return new ae;case 10:return new ke;case 3:return new _e;case 4:return null!=fairygui.UIObjectFactory.loaderType?new fairygui.UIObjectFactory.loaderType:new Ce;case 12:return new Ae;case 11:return new Pe;case 14:return new Oe;case 15:return new Ie;case 16:return new Te;case 13:return new ze;default:return null}},t.packageItemExtensions={},t.loaderType=null,t}()),Z=function(){function t(){}return n(t,"fairygui.display.FillUtils"),t.fill=function(t,e,i,s,n,h){if(0>=h)return null;if(h>=.9999)return[0,0,t,0,t,e,0,e];var r;switch(i){case 1:r=fairygui.display.FillUtils.fillHorizontal(t,e,s,h);break;case 2:r=fairygui.display.FillUtils.fillVertical(t,e,s,h);break;case 3:r=fairygui.display.FillUtils.fillRadial90(t,e,s,n,h);break;case 4:r=fairygui.display.FillUtils.fillRadial180(t,e,s,n,h);break;case 5:r=fairygui.display.FillUtils.fillRadial360(t,e,s,n,h)}return r},t.fillHorizontal=function(t,e,i,s){var n=t*s;return 2==i||0==i?[0,0,n,0,n,e,0,e]:[t,0,t,e,t-n,e,t-n,0]},t.fillVertical=function(t,e,i,s){var n=e*s;return 2==i||0==i?[0,0,0,n,t,n,t,0]:[0,e,t,e,t,e-n,0,e-n]},t.fillRadial90=function(t,e,i,s,n){(s&&(1==i||2==i)||!s&&(0==i||3==i))&&(n=1-n);var h=0/0,r=0/0,o=0/0;h=Math.tan(Math.PI/2*n),o=t*h,r=(o-e)/o;var a;switch(i){case 0:a=s?e>=o?[0,0,t,o,t,0]:[0,0,t*(1-r),e,t,e,t,0]:e>=o?[0,0,t,o,t,e,0,e]:[0,0,t*(1-r),e,0,e];break;case 1:a=s?e>=o?[t,0,0,o,0,e,t,e]:[t,0,t*r,e,t,e]:e>=o?[t,0,0,o,0,0]:[t,0,t*r,e,0,e,0,0];break;case 2:a=s?e>=o?[0,e,t,e-o,t,0,0,0]:[0,e,t*(1-r),0,0,0]:e>=o?[0,e,t,e-o,t,e]:[0,e,t*(1-r),0,t,0,t,e];break;case 3:a=s?e>=o?[t,e,0,e-o,0,e]:[t,e,t*r,0,0,0,0,e]:e>=o?[t,e,0,e-o,0,0,t,0]:[t,e,t*r,0,t,0]}return a},t.movePoints=function(t,e,i){for(var s=t.length,n=0;s>n;n+=2)t[n]+=e,t[n+1]+=i},t.fillRadial180=function(e,i,s,n,h){var r;switch(s){case 0:.5>=h?(h/=.5,r=t.fillRadial90(e/2,i,n?0:1,n,h),n&&t.movePoints(r,e/2,0)):(h=(h-.5)/.5,r=t.fillRadial90(e/2,i,n?1:0,n,h),n?r.push(e,i,e,0):(t.movePoints(r,e/2,0),r.push(0,i,0,0)));break;case 1:.5>=h?(h/=.5,r=t.fillRadial90(e/2,i,n?3:2,n,h),n||t.movePoints(r,e/2,0)):(h=(h-.5)/.5,r=t.fillRadial90(e/2,i,n?2:3,n,h),n?(t.movePoints(r,e/2,0),r.push(0,0,0,i)):r.push(e,0,e,i));break;case 2:.5>=h?(h/=.5,r=t.fillRadial90(e,i/2,n?2:0,n,h),n||t.movePoints(r,0,i/2)):(h=(h-.5)/.5,r=t.fillRadial90(e,i/2,n?0:2,n,h),n?(t.movePoints(r,0,i/2),r.push(e,0,0,0)):r.push(e,i,0,i));break;case 3:.5>=h?(h/=.5,r=t.fillRadial90(e,i/2,n?1:3,n,h),n&&t.movePoints(r,0,i/2)):(h=(h-.5)/.5,r=t.fillRadial90(e,i/2,n?3:1,n,h),n?r.push(0,i,e,i):(t.movePoints(r,0,i/2),r.push(0,0,e,0)))}return r},t.fillRadial360=function(e,i,s,n,h){var r;switch(s){case 0:.5>=h?(h/=.5,r=t.fillRadial180(e/2,i,n?2:3,n,h),n&&t.movePoints(r,e/2,0)):(h=(h-.5)/.5,r=t.fillRadial180(e/2,i,n?3:2,n,h),n?r.push(e,i,e,0,e/2,0):(t.movePoints(r,e/2,0),r.push(0,i,0,0,e/2,0)));break;case 1:.5>=h?(h/=.5,r=t.fillRadial180(e/2,i,n?3:2,n,h),n||t.movePoints(r,e/2,0)):(h=(h-.5)/.5,r=t.fillRadial180(e/2,i,n?2:3,n,h),n?(t.movePoints(r,e/2,0),r.push(0,0,0,i,e/2,i)):r.push(e,0,e,i,e/2,i));break;case 2:.5>=h?(h/=.5,r=t.fillRadial180(e,i/2,n?1:0,n,h),n||t.movePoints(r,0,i/2)):(h=(h-.5)/.5,r=t.fillRadial180(e,i/2,n?0:1,n,h),n?(t.movePoints(r,0,i/2),r.push(e,0,0,0,0,i/2)):r.push(e,i,0,i,0,i/2));break;case 3:.5>=h?(h/=.5,r=t.fillRadial180(e,i/2,n?0:1,n,h),n&&t.movePoints(r,0,i/2)):(h=(h-.5)/.5,r=t.fillRadial180(e,i/2,n?1:0,n,h),n?r.push(0,i,e,i,e,i/2):(t.movePoints(r,0,i/2),r.push(0,0,e,0,e,i/2)))}return r},t}(),K=function(){function t(){this.x=0/0,this.y=0/0,this.z=0/0,this.w=0/0,this.x=this.y=this.z=this.w=0}n(t,"fairygui.tween.TweenValue");var e=t.prototype;return e.getField=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("Index out of bounds: "+t)}},e.setField=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("Index out of bounds: "+t)}},e.setZero=function(){this.x=this.y=this.z=this.w=0},h(0,e,"color",function(){return(this.w<<24)+(this.x<<16)+(this.y<<8)+this.z},function(t){this.x=(16711680&t)>>16,this.y=(65280&t)>>8,this.z=255&t,this.w=(4278190080&t)>>24}),t}(),J=(function(){function t(){}return n(t,"fairygui.AutoSizeType"),t.None=0,t.Both=1,t.Height=2,t.Shrink=3,t}(),function(){function t(){}return n(t,"fairygui.tween.EaseType"),t.Linear=0,t.SineIn=1,t.SineOut=2,t.SineInOut=3,t.QuadIn=4,t.QuadOut=5,t.QuadInOut=6,t.CubicIn=7,t.CubicOut=8,t.CubicInOut=9,t.QuartIn=10,t.QuartOut=11,t.QuartInOut=12,t.QuintIn=13,t.QuintOut=14,t.QuintInOut=15,t.ExpoIn=16,t.ExpoOut=17,t.ExpoInOut=18,t.CircIn=19,t.CircOut=20,t.CircInOut=21,t.ElasticIn=22,t.ElasticOut=23,t.ElasticInOut=24,t.BackIn=25,t.BackOut=26,t.BackInOut=27,t.BounceIn=28,t.BounceOut=29,t.BounceInOut=30,t.Custom=31,t}(),function(){function t(){}return n(t,"fairygui.tween.TweenManager"),t.createTween=function(){t._inited||(i.timer.frameLoop(1,null,t.update),t._inited=!0);var e,s=t._tweenerPool.length;return e=s>0?t._tweenerPool.pop():new z,e._init(),t._activeTweens[t._totalActiveTweens++]=e,t._totalActiveTweens==t._activeTweens.length&&(t._activeTweens.length=t._activeTweens.length+Math.ceil(.5*t._activeTweens.length)),e},t.isTweening=function(e,i){if(null==e)return!1;for(var s=null==i,n=0;n<t._totalActiveTweens;n++){var h=t._activeTweens[n];if(null!=h&&h.target==e&&!h._killed&&(s||h._propType==i))return!0}return!1},t.killTweens=function(e,i,s){if(null==e)return!1;for(var n=!1,h=t._totalActiveTweens,r=null==s,o=0;h>o;o++){var a=t._activeTweens[o];null==a||a.target!=e||a._killed||!r&&a._propType!=s||(a.kill(i),n=!0)}return n},t.getTween=function(e,i){if(null==e)return null;for(var s=t._totalActiveTweens,n=null==i,h=0;s>h;h++){var r=t._activeTweens[h];if(null!=r&&r.target==e&&!r._killed&&(n||r._propType==i))return r}return null},t.update=function(){for(var e=i.timer.delta/1e3,s=t._totalActiveTweens,n=-1,h=0,r=0;s>r;r++){var o=t._activeTweens[r];null==o?(-1==n&&(n=r),h++):o._killed?(o._reset(),t._tweenerPool.push(o),t._activeTweens[r]=null,-1==n&&(n=r),h++):(o._target instanceof fairygui.GObject&&o._target.isDisposed?o._killed=!0:o._paused||o._update(e),-1!=n&&(t._activeTweens[n]=o,t._activeTweens[r]=null,n++))}if(n>=0){if(t._totalActiveTweens!=s){var a=s;for(s=t._totalActiveTweens-s,r=0;s>r;r++)t._activeTweens[n++]=t._activeTweens[a++]}t._totalActiveTweens=n}},t._tweenerPool=[],t._totalActiveTweens=0,t._inited=!1,s(t,["_activeTweens",function(){return this._activeTweens=new Array(30)}]),t}()),te=function(){function t(t){this._owner=null,this._target=null,this._defs=null,this._targetX=0/0,this._targetY=0/0,this._targetWidth=0/0,this._targetHeight=0/0,this._owner=t,this._defs=[]}var e;n(t,"fairygui.RelationItem");var i=t.prototype;return i.add=function(t,e){if(24==t)return this.add(14,e),this.add(15,e),void 0;for(var i=this._defs.length,s=0;i>s;s++)if(this._defs[s].type==t)return;this.internalAdd(t,e)},i.internalAdd=function(t,i){if(24==t)return this.internalAdd(14,i),this.internalAdd(15,i),void 0;var s=new e;s.percent=i,s.type=t,s.axis=6>=t||14==t||t>=16&&19>=t?0:1,this._defs.push(s),(i||1==t||3==t||5==t||8==t||10==t||12==t)&&(this._owner.pixelSnapping=!0)},i.remove=function(t){if(24==t)return this.remove(14),this.remove(15),void 0;for(var e=this._defs.length,i=0;e>i;i++)if(this._defs[i].type==t){this._defs.splice(i,1);break}},i.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var i=t._defs.length,s=0;i>s;s++){var n=t._defs[s],h=new e;h.copyFrom(n),this._defs.push(h)}},i.dispose=function(){null!=this._target&&(this.releaseRefTarget(this._target),this._target=null)},i.applyOnSelfResized=function(t,e,i){var s=this._defs.length;if(0!=s){for(var n=this._owner.x,h=this._owner.y,r=0;s>r;r++){var o=this._defs[r];switch(o.type){case 3:this._owner.x-=(.5-(i?this._owner.pivotX:0))*t;break;case 5:case 4:case 6:this._owner.x-=(1-(i?this._owner.pivotX:0))*t;break;case 10:this._owner.y-=(.5-(i?this._owner.pivotY:0))*e;break;case 12:case 11:case 13:this._owner.y-=(1-(i?this._owner.pivotY:0))*e}}if((n!=this._owner.x||h!=this._owner.y)&&(n=this._owner.x-n,h=this._owner.y-h,this._owner.updateGearFromRelations(1,n,h),null!=this._owner.parent&&this._owner.parent._transitions.length>0)){s=this._owner.parent._transitions.length;for(var a=0;s>a;a++){var l=this._owner.parent._transitions[a];l.updateFromRelations(this._owner.id,n,h)}}}},i.applyOnXYChanged=function(t,e,i){var s=0/0;switch(t.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:this._owner.x+=e;break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:this._owner.y+=i;break;case 14:case 15:break;case 16:case 17:s=this._owner.xMin,this._owner.width=this._owner._rawWidth-e,this._owner.xMin=s+e;break;case 18:case 19:s=this._owner.xMin,this._owner.width=this._owner._rawWidth+e,this._owner.xMin=s;break;case 20:case 21:s=this._owner.yMin,this._owner.height=this._owner._rawHeight-i,this._owner.yMin=s+i;break;case 22:case 23:s=this._owner.yMin,this._owner.height=this._owner._rawHeight+i,this._owner.yMin=s}},i.applyOnSizeChanged=function(t){var e=0,i=0,s=0,n=0/0,h=0/0;switch(0==t.axis?(this._target!=this._owner.parent&&(e=this._target.x,this._target.pivotAsAnchor&&(i=this._target.pivotX)),t.percent?0!=this._targetWidth&&(s=this._target._width/this._targetWidth):s=this._target._width-this._targetWidth):(this._target!=this._owner.parent&&(e=this._target.y,this._target.pivotAsAnchor&&(i=this._target.pivotY)),t.percent?0!=this._targetHeight&&(s=this._target._height/this._targetHeight):s=this._target._height-this._targetHeight),t.type){case 0:t.percent?this._owner.xMin=e+(this._owner.xMin-e)*s:0!=i&&(this._owner.x+=s*-i);break;case 1:t.percent?this._owner.xMin=e+(this._owner.xMin-e)*s:this._owner.x+=s*(.5-i);break;case 2:t.percent?this._owner.xMin=e+(this._owner.xMin-e)*s:this._owner.x+=s*(1-i);break;case 3:t.percent?this._owner.xMin=e+(this._owner.xMin+.5*this._owner._rawWidth-e)*s-.5*this._owner._rawWidth:this._owner.x+=s*(.5-i);break;
case 4:t.percent?this._owner.xMin=e+(this._owner.xMin+this._owner._rawWidth-e)*s-this._owner._rawWidth:0!=i&&(this._owner.x+=s*-i);break;case 5:t.percent?this._owner.xMin=e+(this._owner.xMin+this._owner._rawWidth-e)*s-this._owner._rawWidth:this._owner.x+=s*(.5-i);break;case 6:t.percent?this._owner.xMin=e+(this._owner.xMin+this._owner._rawWidth-e)*s-this._owner._rawWidth:this._owner.x+=s*(1-i);break;case 7:t.percent?this._owner.yMin=e+(this._owner.yMin-e)*s:0!=i&&(this._owner.y+=s*-i);break;case 8:t.percent?this._owner.yMin=e+(this._owner.yMin-e)*s:this._owner.y+=s*(.5-i);break;case 9:t.percent?this._owner.yMin=e+(this._owner.yMin-e)*s:this._owner.y+=s*(1-i);break;case 10:t.percent?this._owner.yMin=e+(this._owner.yMin+.5*this._owner._rawHeight-e)*s-.5*this._owner._rawHeight:this._owner.y+=s*(.5-i);break;case 11:t.percent?this._owner.yMin=e+(this._owner.yMin+this._owner._rawHeight-e)*s-this._owner._rawHeight:0!=i&&(this._owner.y+=s*-i);break;case 12:t.percent?this._owner.yMin=e+(this._owner.yMin+this._owner._rawHeight-e)*s-this._owner._rawHeight:this._owner.y+=s*(.5-i);break;case 13:t.percent?this._owner.yMin=e+(this._owner.yMin+this._owner._rawHeight-e)*s-this._owner._rawHeight:this._owner.y+=s*(1-i);break;case 14:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target.initWidth:this._owner._rawWidth-this._targetWidth,t.percent&&(n*=s),this._target==this._owner.parent?this._owner.pivotAsAnchor?(h=this._owner.xMin,this._owner.setSize(this._target._width+n,this._owner._rawHeight,!0),this._owner.xMin=h):this._owner.setSize(this._target._width+n,this._owner._rawHeight,!0):this._owner.width=this._target._width+n;break;case 15:n=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target.initHeight:this._owner._rawHeight-this._targetHeight,t.percent&&(n*=s),this._target==this._owner.parent?this._owner.pivotAsAnchor?(h=this._owner.yMin,this._owner.setSize(this._owner._rawWidth,this._target._height+n,!0),this._owner.yMin=h):this._owner.setSize(this._owner._rawWidth,this._target._height+n,!0):this._owner.height=this._target._height+n;break;case 16:h=this._owner.xMin,n=t.percent?e+(h-e)*s-h:s*-i,this._owner.width=this._owner._rawWidth-n,this._owner.xMin=h+n;break;case 17:h=this._owner.xMin,n=t.percent?e+(h-e)*s-h:s*(1-i),this._owner.width=this._owner._rawWidth-n,this._owner.xMin=h+n;break;case 18:h=this._owner.xMin,n=t.percent?e+(h+this._owner._rawWidth-e)*s-(h+this._owner._rawWidth):s*-i,this._owner.width=this._owner._rawWidth+n,this._owner.xMin=h;break;case 19:h=this._owner.xMin,t.percent?this._owner==this._target.parent?this._owner.width=this._owner._underConstruct?e+this._target._width-this._target._width*i+(this._owner.sourceWidth-e-this._target.initWidth+this._target.initWidth*i)*s:e+(this._owner._rawWidth-e)*s:(n=e+(h+this._owner._rawWidth-e)*s-(h+this._owner._rawWidth),this._owner.width=this._owner._rawWidth+n,this._owner.xMin=h):this._owner==this._target.parent?this._owner.width=this._owner._underConstruct?this._owner.sourceWidth+(this._target._width-this._target.initWidth)*(1-i):this._owner._rawWidth+s*(1-i):(n=s*(1-i),this._owner.width=this._owner._rawWidth+n,this._owner.xMin=h);break;case 20:h=this._owner.yMin,n=t.percent?e+(h-e)*s-h:s*-i,this._owner.height=this._owner._rawHeight-n,this._owner.yMin=h+n;break;case 21:h=this._owner.yMin,n=t.percent?e+(h-e)*s-h:s*(1-i),this._owner.height=this._owner._rawHeight-n,this._owner.yMin=h+n;break;case 22:h=this._owner.yMin,n=t.percent?e+(h+this._owner._rawHeight-e)*s-(h+this._owner._rawHeight):s*-i,this._owner.height=this._owner._rawHeight+n,this._owner.yMin=h;break;case 23:h=this._owner.yMin,t.percent?this._owner==this._target.parent?this._owner.height=this._owner._underConstruct?e+this._target._height-this._target._height*i+(this._owner.sourceHeight-e-this._target.initHeight+this._target.initHeight*i)*s:e+(this._owner._rawHeight-e)*s:(n=e+(h+this._owner._rawHeight-e)*s-(h+this._owner._rawHeight),this._owner.height=this._owner._rawHeight+n,this._owner.yMin=h):this._owner==this._target.parent?this._owner.height=this._owner._underConstruct?this._owner.sourceHeight+(this._target._height-this._target.initHeight)*(1-i):this._owner._rawHeight+s*(1-i):(n=s*(1-i),this._owner.height=this._owner._rawHeight+n,this._owner.yMin=h)}},i.addRefTarget=function(t){t!=this._owner.parent&&t.on("fui_xy_changed",this,this.__targetXYChanged),t.on("fui_size_changed",this,this.__targetSizeChanged),t.on("fui_size_delay_change",this,this.__targetSizeWillChange),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._width,this._targetHeight=this._target._height},i.releaseRefTarget=function(t){null!=t.displayObject&&(t.off("fui_xy_changed",this,this.__targetXYChanged),t.off("fui_size_changed",this,this.__targetSizeChanged),t.off("fui_size_delay_change",this,this.__targetSizeWillChange))},i.__targetXYChanged=function(t){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,this._targetY=this._target.y,void 0;this._owner.relations.handling=t;for(var e=this._owner.x,i=this._owner.y,s=this._target.x-this._targetX,n=this._target.y-this._targetY,h=this._defs.length,r=0;h>r;r++)this.applyOnXYChanged(this._defs[r],s,n);if(this._targetX=this._target.x,this._targetY=this._target.y,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent&&this._owner.parent._transitions.length>0)){h=this._owner.parent._transitions.length;for(var o=0;h>o;o++){var a=this._owner.parent._transitions[o];a.updateFromRelations(this._owner.id,e,i)}}this._owner.relations.handling=null},i.__targetSizeChanged=function(t){if(null!=this._owner.relations.handling)return this._targetWidth=this._target._width,this._targetHeight=this._target._height,void 0;this._owner.relations.handling=t;for(var e=this._owner.x,i=this._owner.y,s=this._owner._rawWidth,n=this._owner._rawHeight,h=this._defs.length,r=0;h>r;r++)this.applyOnSizeChanged(this._defs[r]);if(this._targetWidth=this._target._width,this._targetHeight=this._target._height,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),null!=this._owner.parent&&this._owner.parent._transitions.length>0)){h=this._owner.parent._transitions.length;for(var o=0;h>o;o++){var a=this._owner.parent._transitions[o];a.updateFromRelations(this._owner.id,e,i)}}(s!=this._owner._rawWidth||n!=this._owner._rawHeight)&&(s=this._owner._rawWidth-s,n=this._owner._rawHeight-n,this._owner.updateGearFromRelations(2,s,n)),this._owner.relations.handling=null},i.__targetSizeWillChange=function(){this._owner.relations.sizeDirty=!0},h(0,i,"owner",function(){return this._owner}),h(0,i,"target",function(){return this._target},function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))}),h(0,i,"isEmpty",function(){return 0==this._defs.length}),t.__init$=function(){e=function(){function t(){this.percent=!1,this.type=0,this.axis=0}n(t,"");var e=t.prototype;return e.copyFrom=function(t){this.percent=t.percent,this.type=t.type,this.axis=t.axis},t}()},t}(),ee=function(){function t(t){this._data=null,this._parent=null,this._children=null,this._expanded=!1,this._tree=null,this._cell=null,this._level=0,t&&(this._children=[])}n(t,"fairygui.tree.TreeNode");var e=t.prototype;return e.setCell=function(t){this._cell=t},e.setLevel=function(t){this._level=t},e.addChild=function(t){return this.addChildAt(t,this._children.length),t},e.addChildAt=function(t,e){if(!t)throw new Error("child is null");var i=this._children.length;if(e>=0&&i>=e){if(t._parent==this)this.setChildIndex(t,e);else{t._parent&&t._parent.removeChild(t);var s=this._children.length;e==s?this._children.push(t):this._children.splice(e,0,t),t._parent=this,t._level=this._level+1,t.setTree(this._tree),null!=this._cell&&null!=this._cell.parent&&this._expanded&&this._tree.afterInserted(t)}return t}throw new Error("Invalid child index")},e.removeChild=function(t){var e=this._children.indexOf(t);return-1!=e&&this.removeChildAt(e),t},e.removeChildAt=function(t){if(t>=0&&t<this.numChildren){var e=this._children[t];return this._children.splice(t,1),e._parent=null,null!=this._tree&&(e.setTree(null),this._tree.afterRemoved(e)),e}throw new Error("Invalid child index")},e.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),(0>e||e>=this.numChildren)&&(e=this.numChildren-1);for(var i=t;e>=i;++i)this.removeChildAt(t)},e.getChildAt=function(t){if(t>=0&&t<this.numChildren)return this._children[t];throw new Error("Invalid child index")},e.getChildIndex=function(t){return this._children.indexOf(t)},e.getPrevSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return 0>=t?null:this._parent._children[t-1]},e.getNextSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return 0>t||t>=this._parent._children.length-1?null:this._parent._children[t+1]},e.setChildIndex=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw new Error("Not a child of this container");var s=this._children.length;0>e?e=0:e>s&&(e=s),i!=e&&(this._children.splice(i,1),this._children.splice(e,0,t),null!=this._cell&&null!=this._cell.parent&&this._expanded&&this._tree.afterMoved(t))},e.swapChildren=function(t,e){var i=this._children.indexOf(t),s=this._children.indexOf(e);if(-1==i||-1==s)throw new Error("Not a child of this container");this.swapChildrenAt(i,s)},e.swapChildrenAt=function(t,e){var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)},e.setTree=function(t){if(this._tree=t,null!=this._tree&&this._tree.treeNodeWillExpand&&this._expanded&&this._tree.treeNodeWillExpand.runWith(this),null!=this._children)for(var e=this._children.length,i=0;e>i;i++){var s=this._children[i];s._level=this._level+1,s.setTree(t)}},h(0,e,"expanded",function(){return this._expanded},function(t){null!=this._children&&this._expanded!=t&&(this._expanded=t,null!=this._tree&&(this._expanded?this._tree.afterExpanded(this):this._tree.afterCollapsed(this)))}),h(0,e,"tree",function(){return this._tree}),h(0,e,"level",function(){return this._level}),h(0,e,"cell",function(){return this._cell}),h(0,e,"data",function(){return this._data},function(t){this._data=t}),h(0,e,"parent",function(){return this._parent}),h(0,e,"isFolder",function(){return null!=this._children}),h(0,e,"text",function(){return null!=this._cell?this._cell.text:null}),h(0,e,"numChildren",function(){return this._children.length}),t}(),ie=function(){function t(){}return n(t,"fairygui.UIConfig",null,"UIConfig$1"),t.defaultFont="SimSun",t.windowModalWaiting=null,t.globalModalWaiting=null,t.modalLayerColor="rgba(33,33,33,0.2)",t.buttonSound=null,t.buttonSoundVolumeScale=1,t.horizontalScrollBar=null,t.verticalScrollBar=null,t.defaultScrollStep=25,t.defaultScrollDecelerationRate=.967,t.defaultScrollBarDisplay=1,t.defaultScrollTouchEffect=!0,t.defaultScrollBounceEffect=!0,t.defaultScrollSnappingThreshold=.1,t.defaultScrollPagingThreshold=.3,t.popupMenu=null,t.popupMenu_seperator=null,t.loaderErrorSign=null,t.tooltipsWin=null,t.defaultComboBoxVisibleItemCount=10,t.touchScrollSensitivity=20,t.touchDragSensitivity=10,t.clickDragSensitivity=2,t.bringWindowToFrontOnClick=!0,t.frameTimeForAsyncUIConstruction=2,t.textureLinearSampling=!0,t.packageFileExtension="obj",t}(),se=(function(){function t(){}return n(t,"fairygui.ListSelectionMode"),t.Single=0,t.Multiple=1,t.Multiple_SingleClick=2,t.None=3,t}(),function(){function t(t){if(this._contentPane=null,this._list=null,!t&&(t=ie.popupMenu,!t))throw"UIConfig.popupMenu not defined";this._contentPane=$.createObjectFromURL(t).asCom,this._contentPane.on("display",this,this.__addedToStage),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,14),this._list.removeRelation(this._contentPane,15),this._contentPane.addRelation(this._list,15),this._list.on("fui_click_item",this,this.__clickItem)}n(t,"fairygui.PopupMenu");var e=t.prototype;return e.dispose=function(){this._contentPane.dispose()},e.addItem=function(t,e){var i=this._list.addItemFromPool().asButton;i.title=t,i.data=e,i.grayed=!1;var s=i.getController("checked");return null!=s&&(s.selectedIndex=0),i},e.addItemAt=function(t,e,i){var s=this._list.getFromPool().asButton;this._list.addChildAt(s,e),s.title=t,s.data=i,s.grayed=!1;var n=s.getController("checked");return null!=n&&(n.selectedIndex=0),s},e.addSeperator=function(){if(null==ie.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(ie.popupMenu_seperator)},e.getItemName=function(t){var e=this._list.getChildAt(t);return e.name},e.setItemText=function(t,e){var i=this._list.getChild(t).asButton;i.title=e},e.setItemVisible=function(t,e){var i=this._list.getChild(t).asButton;i.visible!=e&&(i.visible=e,this._list.setBoundsChangedFlag())},e.setItemGrayed=function(t,e){var i=this._list.getChild(t).asButton;i.grayed=e},e.setItemCheckable=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(e?0==s.selectedIndex&&(s.selectedIndex=1):s.selectedIndex=0)},e.setItemChecked=function(t,e){var i=this._list.getChild(t).asButton,s=i.getController("checked");null!=s&&(s.selectedIndex=e?2:1)},e.isItemChecked=function(t){var e=this._list.getChild(t).asButton,i=e.getController("checked");return null!=i?2==i.selectedIndex:!1},e.removeItem=function(t){var e=this._list.getChild(t);if(null!=e){var i=this._list.getChildIndex(e);return this._list.removeChildToPoolAt(i),!0}return!1},e.clearItems=function(){this._list.removeChildrenToPool()},e.show=function(t,e){var i=null!=t?t.root:je.inst;i.showPopup(this.contentPane,t instanceof fairygui.GRoot?null:t,e)},e.__clickItem=function(t){i.timer.once(100,this,this.__clickItem2,[t])},e.__clickItem2=function(t){if(t instanceof fairygui.GButton){if(t.grayed)return this._list.selectedIndex=-1,void 0;var e=t.asCom.getController("checked");null!=e&&0!=e.selectedIndex&&(e.selectedIndex=1==e.selectedIndex?2:1);var i=this._contentPane.parent;i.hidePopup(this.contentPane),null!=t.data&&t.data.run()}},e.__addedToStage=function(){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},h(0,e,"itemCount",function(){return this._list.numChildren}),h(0,e,"contentPane",function(){return this._contentPane}),h(0,e,"list",function(){return this._list}),t}(),function(){function t(){}return n(t,"fairygui.ProgressTitleType"),t.Percent=0,t.ValueAndMax=1,t.Value=2,t.Max=3,t}(),function(){function t(){t.__super.call(this),this.reset()}n(t,"fairygui.utils.ColorMatrix",Array);var e=t.prototype;return e.reset=function(){for(var e=0;e<t.LENGTH;e++)this[e]=t.IDENTITY_MATRIX[e]},e.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},e.adjustColor=function(t,e,i,s){this.adjustHue(s),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},e.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},e.adjustContrast=function(t){t=this.cleanValue(t,1);var e=t+1,i=128*(1-e);this.multiplyMatrix([e,0,0,0,i,0,e,0,0,i,0,0,e,0,i,0,0,0,1,0])},e.adjustSaturation=function(t){t=this.cleanValue(t,1),t+=1;var e=1-t,i=.299*e,s=.587*e,n=.114*e;this.multiplyMatrix([i+t,s,n,0,0,i,s+t,n,0,0,i,s,n+t,0,0,0,0,0,1,0])},e.adjustHue=function(t){t=this.cleanValue(t,1),t*=Math.PI;var e=Math.cos(t),i=Math.sin(t);this.multiplyMatrix([.299+e*(1-.299)+i*-.299,.587+e*-.587+i*-.587,.114+e*-.114+.886*i,0,0,.299+e*-.299+.143*i,.587+e*(1-.587)+.14*i,.114+e*-.114+i*-.283,0,0,.299+e*-.299+i*-(1-.299),.587+e*-.587+.587*i,.114+.886*e+.114*i,0,0,0,0,0,1,0])},e.concat=function(e){e.length==t.LENGTH&&this.multiplyMatrix(e)},e.clone=function(){var e=new t;return e.copyMatrix(this),e},e.copyMatrix=function(e){for(var i=t.LENGTH,s=0;i>s;s++)this[s]=e[s]},e.multiplyMatrix=function(t){for(var e=[],i=0,s=0;4>s;++s){for(var n=0;5>n;++n)e[i+n]=t[i]*this[n]+t[i+1]*this[n+5]+t[i+2]*this[n+10]+t[i+3]*this[n+15]+(4==n?t[i+4]:0);i+=5}this.copyMatrix(e)},e.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},t.create=function(e,i,s,n){var h=new t;return h.adjustColor(e,i,s,n),h},t.LUMA_R=.299,t.LUMA_G=.587,t.LUMA_B=.114,s(t,["IDENTITY_MATRIX",function(){return this.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]},"LENGTH",function(){return this.LENGTH=t.IDENTITY_MATRIX.length}]),t}(Array)),ne=function(t){function e(){this._selectedIndex=0,this._previousIndex=0,this._pageIds=null,this._pageNames=null,this._actions=null,this.name=null,this.parent=null,this.autoRadioGroupDepth=!1,this.changing=!1,e.__super.call(this),this._pageIds=[],this._pageNames=[],this._selectedIndex=-1,this._previousIndex=-1}n(e,"fairygui.Controller",t);var i=e.prototype;return i.dispose=function(){this.offAll()},i.setSelectedIndex=function(t){if(void 0===t&&(t=0),this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.changing=!1}},i.setSelectedPage=function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.setSelectedIndex(e)},i.getPageName=function(t){return void 0===t&&(t=0),this._pageNames[t]},i.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},i.addPageAt=function(t,e){void 0===e&&(e=0);var i=""+fairygui.Controller._nextPageId++;e==this._pageIds.length?(this._pageIds.push(i),this._pageNames.push(t)):(this._pageIds.splice(e,0,i),this._pageNames.splice(e,0,t))},i.removePage=function(t){var e=this._pageNames.indexOf(t);-1!=e&&(this._pageIds.splice(e,1),this._pageNames.splice(e,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this))},i.removePageAt=function(t){void 0===t&&(t=0),this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this)},i.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this.parent.applyController(this)},i.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},i.getPageIndexById=function(t){return this._pageIds.indexOf(t)},i.getPageIdByName=function(t){var e=this._pageNames.indexOf(t);return-1!=e?this._pageIds[e]:null},i.getPageNameById=function(t){var e=this._pageIds.indexOf(t);return-1!=e?this._pageNames[e]:null},i.getPageId=function(t){return void 0===t&&(t=0),this._pageIds[t]},i.runActions=function(){if(this._actions)for(var t=this._actions.length,e=0;t>e;e++)this._actions[e].run(this,this.previousPageId,this.selectedPageId)},i.setup=function(t){var e=t.pos;t.seek(e,0),this.name=t.readS(),this.autoRadioGroupDepth=t.readBool(),t.seek(e,1);var i=0,s=0,n=t.getInt16();for(i=0;n>i;i++)this._pageIds.push(t.readS()),this._pageNames.push(t.readS());if(t.seek(e,2),n=t.getInt16(),n>0)for(null==this._actions&&(this._actions=[]),i=0;n>i;i++){s=t.getInt16(),s+=t.pos;var h=B.createAction(t.readByte());h.setup(t),this._actions.push(h),t.pos=s}this._selectedIndex=null!=this.parent&&this._pageIds.length>0?0:-1},h(0,i,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.event("fui_state_changed"),this.changing=!1}}),h(0,i,"selectedPage",function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},function(t){var e=this._pageNames.indexOf(t);-1==e&&(e=0),this.selectedIndex=e}),h(0,i,"previsousIndex",function(){return this._previousIndex}),h(0,i,"previousPage",function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]}),h(0,i,"pageCount",function(){return this._pageIds.length}),h(0,i,"selectedPageId",function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},function(t){var e=this._pageIds.indexOf(t);this.selectedIndex=e}),h(0,i,"previousPageId",function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]}),h(0,i,"oppositePageId",null,function(t){var e=this._pageIds.indexOf(t);e>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)}),e._nextPageId=0,e}(_),he=function(t){function e(t,i,s){this._data=null,this.offsetX=0,this.offsetY=0,this.scaleX=0/0,this.scaleY=0/0,e.__super.call(this),void 0===i&&(i=0),void 0===s&&(s=0),this._data=t,this.offsetX=i,this.offsetY=s,this.scaleX=1,this.scaleY=1}n(e,"fairygui.utils.PixelHitTest",t);var i=e.prototype;return i.contains=function(t,e){if(t=Math.floor((t/this.scaleX-this.offsetX)*this._data.scale),e=Math.floor((e/this.scaleY-this.offsetY)*this._data.scale),0>t||0>e||t>=this._data.pixelWidth)return!1;var i=e*this._data.pixelWidth+t,s=Math.floor(i/8),n=i%8;return s>=0&&s<this._data.pixels.length?1==(this._data.pixels[s]>>n&1):!1},e}(f),re=function(t){function e(t,i){this._child=null,this._reversed=!1,e.__super.call(this),this._child=t,this._reversed=i,this._reversed?this.unHit=t.hitArea.hit:this.hit=t.hitArea.hit}n(e,"fairygui.utils.ChildHitArea",t);var i=e.prototype;return i.contains=function(t,e){var i;return i=m.TEMP,i.setTo(0,0),i=this._child.toParentPoint(i),this._reversed?!f._isHitGraphic(t-i.x,e-i.y,this.unHit):f._isHitGraphic(t-i.x,e-i.y,this.hit)},e}(f),oe=function(t){function e(){this._sortingChildCount=0,this._opaque=!1,this._applyingController=null,this._mask=null,this._margin=null,this._trackBounds=!1,this._boundsChanged=!1,this._childrenRenderOrder=0,this._apexIndex=0,this._buildingDisplayList=!1,this._children=null,this._controllers=null,this._transitions=null,this._container=null,this._scrollPane=null,this._alignOffset=null,e.__super.call(this),this._children=[],this._controllers=[],this._transitions=[],this._margin=new k,this._alignOffset=new m,this._opaque=!1}n(e,"fairygui.GComponent",t);var s=e.prototype;return s.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!0,this._displayObject.mouseThrough=!0,this._container=this._displayObject},s.dispose=function(){var e=0,i=0;for(i=this._transitions.length,e=0;i>e;++e){var s=this._transitions[e];s.dispose()}for(i=this._controllers.length,e=0;i>e;++e){var n=this._controllers[e];n.dispose()}for(null!=this.scrollPane&&this.scrollPane.dispose(),i=this._children.length,e=i-1;e>=0;--e){var h=this._children[e];h.parent=null,h.dispose()}this._boundsChanged=!1,this._mask=null,t.prototype.dispose.call(this)},s.addChild=function(t){return this.addChildAt(t,this._children.length),t},s.addChildAt=function(t,e){if(void 0===e&&(e=0),!t)throw"child is null";var i=this._children.length;if(e>=0&&i>=e){if(t.parent==this)this.setChildIndex(t,e);else{t.removeFromParent(),t.parent=this;var s=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&e>s-this._sortingChildCount&&(e=s-this._sortingChildCount),e==s?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},s.getInsertPosForSortingChild=function(t){var e=this._children.length,i=0;for(i=0;e>i;i++){var s=this._children[i];if(s!=t&&t.sortingOrder<s.sortingOrder)break}return i},s.removeChild=function(t,e){void 0===e&&(e=!1);var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},s.removeChildAt=function(t,e){if(void 0===e&&(e=!1),t>=0&&t<this.numChildren){var s=this._children[t];return s.parent=null,0!=s.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),s.group=null,s.inContainer&&(this._container.removeChild(s.displayObject),2==this._childrenRenderOrder&&i.timer.callLater(this,this.buildNativeDisplayList)),e&&s.dispose(),this.setBoundsChangedFlag(),s}throw"Invalid child index"},s.removeChildren=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=!1),(0>e||e>=this.numChildren)&&(e=this.numChildren-1);for(var s=t;e>=s;++s)this.removeChildAt(t,i)},s.getChildAt=function(t){if(void 0===t&&(t=0),t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},s.getChild=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i].name==t)return this._children[i];return null},s.getVisibleChild=function(t){for(var e=this._children.length,i=0;e>i;++i){var s=this._children[i];if(s.internalVisible&&s.internalVisible2&&s.name==t)return s}return null},s.getChildInGroup=function(t,e){for(var i=this._children.length,s=0;i>s;++s){var n=this._children[s];if(n.group==e&&n.name==t)return n}return null},s.getChildById=function(t){for(var e=this._children.length,i=0;e>i;++i)if(this._children[i]._id==t)return this._children[i];return null},s.getChildIndex=function(t){return this._children.indexOf(t)},s.setChildIndex=function(t,e){void 0===e&&(e=0);var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0==t.sortingOrder){var s=this._children.length;this._sortingChildCount>0&&e>s-this._sortingChildCount-1&&(e=s-this._sortingChildCount-1),this._setChildIndex(t,i,e)}},s.setChildIndexBefore=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0!=t.sortingOrder)return i;var s=this._children.length;return this._sortingChildCount>0&&e>s-this._sortingChildCount-1&&(e=s-this._sortingChildCount-1),e>i?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e)},s._setChildIndex=function(t,e,s){var n=this._children.length;if(s>n&&(s=n),e==s)return e;if(this._children.splice(e,1),this._children.splice(s,0,t),t.inContainer){var h,r=0,o=0;if(0==this._childrenRenderOrder){for(o=0;s>o;o++)h=this._children[o],h.inContainer&&r++;r==this._container.numChildren&&r--,this._container.setChildIndex(t.displayObject,r)}else if(1==this._childrenRenderOrder){for(o=n-1;o>s;o--)h=this._children[o],h.inContainer&&r++;r==this._container.numChildren&&r--,this._container.setChildIndex(t.displayObject,r)}else i.timer.callLater(this,this.buildNativeDisplayList);this.setBoundsChangedFlag()}return s},s.swapChildren=function(t,e){var i=this._children.indexOf(t),s=this._children.indexOf(e);if(-1==i||-1==s)throw"Not a child of this container";this.swapChildrenAt(i,s)},s.swapChildrenAt=function(t,e){void 0===e&&(e=0);var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)},s.isAncestorOf=function(t){if(null==t)return!1;for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1},s.addController=function(t){this._controllers.push(t),t.parent=this,this.applyController(t)},s.getControllerAt=function(t){return this._controllers[t]},s.getController=function(t){for(var e=this._controllers.length,i=0;e>i;++i){var s=this._controllers[i];if(s.name==t)return s}return null},s.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw new Error("controller not exists");t.parent=null,this._controllers.splice(e,1);for(var i=this._children.length,s=0;i>s;s++){var n=this._children[s];n.handleControllerChanged(t)}},s.childStateChanged=function(t){if(!this._buildingDisplayList){var e=this._children.length;if(t instanceof fairygui.GGroup)for(var s=0;e>s;s++){var n=this._children[s];n.group==t&&this.childStateChanged(n)}else if(t.displayObject)if(t.internalVisible&&t.displayObject!=this._displayObject.mask){if(!t.displayObject.parent){var h=0;if(0==this._childrenRenderOrder){for(s=0;e>s&&(n=this._children[s],n!=t);s++)null!=n.displayObject&&null!=n.displayObject.parent&&h++;this._container.addChildAt(t.displayObject,h)}else if(1==this._childrenRenderOrder){for(s=e-1;s>=0&&(n=this._children[s],n!=t);s--)null!=n.displayObject&&null!=n.displayObject.parent&&h++;this._container.addChildAt(t.displayObject,h)}else this._container.addChild(t.displayObject),i.timer.callLater(this,this.buildNativeDisplayList)}}else t.displayObject.parent&&(this._container.removeChild(t.displayObject),2==this._childrenRenderOrder&&i.timer.callLater(this,this.buildNativeDisplayList))}},s.buildNativeDisplayList=function(){var t=this._children.length;if(0!=t){var e,i=0;switch(this._childrenRenderOrder){case 0:for(i=0;t>i;i++)e=this._children[i],null!=e.displayObject&&e.internalVisible&&this._container.addChild(e.displayObject);break;case 1:for(i=t-1;i>=0;i--)e=this._children[i],null!=e.displayObject&&e.internalVisible&&this._container.addChild(e.displayObject);break;case 2:for(i=0;i<this._apexIndex;i++)e=this._children[i],null!=e.displayObject&&e.internalVisible&&this._container.addChild(e.displayObject);for(i=t-1;i>=this._apexIndex;i--)e=this._children[i],null!=e.displayObject&&e.internalVisible&&this._container.addChild(e.displayObject)}}},s.applyController=function(t){this._applyingController=t;for(var e,i=this._children.length,s=0;i>s;s++)e=this._children[s],e.handleControllerChanged(t);this._applyingController=null,t.runActions()},s.applyAllControllers=function(){for(var t=this._controllers.length,e=0;t>e;++e)this.applyController(this._controllers[e])},s.adjustRadioGroupDepth=function(t,e){var i,s=this._children.length,n=0/0,h=-1,r=-1;for(n=0;s>n;n++)i=this._children[n],i==t?h=n:i instanceof fairygui.GButton&&i.relatedController==e&&n>r&&(r=n);r>h&&(null!=this._applyingController&&this._children[r].handleControllerChanged(this._applyingController),this.swapChildrenAt(h,r))},s.getTransitionAt=function(t){return this._transitions[t]},s.getTransition=function(t){for(var e=this._transitions.length,i=0;e>i;++i){var s=this._transitions[i];if(s.name==t)return s}return null},s.isChildInView=function(t){return null!=this._displayObject.scrollRect?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null!=this._scrollPane?this._scrollPane.isChildInView(t):!0},s.getFirstChildInView=function(){for(var t=this._children.length,e=0;t>e;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},s.setMask=function(t,e){return this._mask&&this._mask!=t&&"destination-out"==this._mask.blendMode&&(this._mask.blendMode=null),this._mask=t,this._mask?(this._mask.hitArea&&(this._displayObject.hitArea=new re(this._mask,e),this._displayObject.mouseThrough=!1,this._displayObject.hitTestPrior=!0),e?(this._displayObject.mask=null,this._displayObject.cacheAs="bitmap",this._mask.blendMode="destination-out"):this._displayObject.mask=this._mask,void 0):(this._displayObject.mask=null,this._displayObject.hitArea instanceof fairygui.utils.ChildHitArea&&(this._displayObject.hitArea=null),void 0)},s.updateHitArea=function(){if(this._displayObject.hitArea instanceof fairygui.utils.PixelHitTest){var t=this._displayObject.hitArea;0!=this.sourceWidth&&(t.scaleX=this.width/this.sourceWidth),0!=this.sourceHeight&&(t.scaleY=this.height/this.sourceHeight)}else this._displayObject.hitArea instanceof laya.maths.Rectangle&&this._displayObject.hitArea.setTo(0,0,this.width,this.height)},s.updateMask=function(){var t=this._displayObject.scrollRect;null==t&&(t=new v),t.x=this._margin.left,t.y=this._margin.top,t.width=this.width-this._margin.right,t.height=this.height-this._margin.bottom,this._displayObject.scrollRect=t},s.setupScroll=function(t){this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this._scrollPane=new X(this),this._scrollPane.setup(t)},s.setupOverflow=function(t){1==t?(this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this.updateMask(),this._container.pos(this._margin.left,this._margin.top)):(0!=this._margin.left||0!=this._margin.top)&&(this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this._container.pos(this._margin.left,this._margin.top))},s.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._scrollPane?this._scrollPane.onOwnerSizeChanged():null!=this._displayObject.scrollRect&&this.updateMask(),null!=this._displayObject.hitArea&&this.updateHitArea()
},s.handleGrayedChanged=function(){var t=this.getController("grayed");if(null!=t)return t.selectedIndex=this.grayed?1:0,void 0;for(var e=this.grayed,i=this._children.length,s=0;i>s;++s)this._children[s].grayed=e},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),null!=this._scrollPane&&this._scrollPane.handleControllerChanged(e)},s.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,i.timer.callLater(this,this.__render)))},s.__render=function(){if(this._boundsChanged){var t,e=0,i=this._children.length;for(e=0;i>e;e++)t=this._children[e],t.ensureSizeCorrect();this.updateBounds()}},s.ensureBoundsCorrect=function(){var t,e=0,i=this._children.length;for(e=0;i>e;e++)t=this._children[e],t.ensureSizeCorrect();this._boundsChanged&&this.updateBounds()},s.updateBounds=function(){var t=0,e=0,i=0,s=0,n=this._children.length;if(n>0){t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;var h=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=0,a=0;for(a=0;n>a;a++){var l=this._children[a];o=l.x,t>o&&(t=o),o=l.y,e>o&&(e=o),o=l.x+l.actualWidth,o>h&&(h=o),o=l.y+l.actualHeight,o>r&&(r=o)}i=h-t,s=r-e}this.setBounds(t,e,i,s)},s.setBounds=function(t,e,i,s){this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+s))},s.getSnappingPosition=function(t,e,i){return this.getSnappingPositionWithDir(t,e,0,0,i)},s.getSnappingPositionWithDir=function(t,e,i,s,n){n||(n=new m);var h=this._children.length;if(0==h)return n.x=0,n.y=0,n;this.ensureBoundsCorrect();var r=null,o=null,a=0;if(0!=e){for(;h>a;a++)if(r=this._children[a],e<r.y){if(0==a){e=0;break}o=this._children[a-1],e=e<o.y+o.actualHeight/2?o.y:r.y;break}a==h&&(e=r.y)}if(0!=t){for(a>0&&a--;h>a;a++)if(r=this._children[a],t<r.x){if(0==a){t=0;break}o=this._children[a-1],t=t<o.x+o.actualWidth/2?o.x:r.x;break}a==h&&(t=r.x)}return n.x=t,n.y=e,n},s.childSortingOrderChanged=function(t,e,i){if(void 0===i&&(i=0),0==i)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==e&&this._sortingChildCount++;var s=this._children.indexOf(t),n=this.getInsertPosForSortingChild(t);n>s?this._setChildIndex(t,s,n-1):this._setChildIndex(t,s,n)}},s.constructFromResource=function(){this.constructFromResource2(null,0)},s.constructFromResource2=function(t,e){this.packageItem.decoded||(this.packageItem.decoded=!0,q.translateComponent(this.packageItem));var i=0,s=0,n=0,h=0,r=0/0,o=0/0,a=0,l=0,u=this.packageItem.rawData;u.seek(0,0),this._underConstruct=!0,this.sourceWidth=u.getInt32(),this.sourceHeight=u.getInt32(),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),u.readBool()&&(this.minWidth=u.getInt32(),this.maxWidth=u.getInt32(),this.minHeight=u.getInt32(),this.maxHeight=u.getInt32()),u.readBool()&&(r=u.getFloat32(),o=u.getFloat32(),this.internalSetPivot(r,o,u.readBool())),u.readBool()&&(this._margin.top=u.getInt32(),this._margin.bottom=u.getInt32(),this._margin.left=u.getInt32(),this._margin.right=u.getInt32());var _=u.readByte();if(2==_){var c=u.pos;u.seek(0,7),this.setupScroll(u),u.pos=c}else this.setupOverflow(_);u.readBool()&&u.skip(8),this._buildingDisplayList=!0,u.seek(0,1);var d=u.getInt16();for(i=0;d>i;i++){h=u.getInt16(),h+=u.pos;var f=new ne;this._controllers.push(f),f.parent=this,f.setup(u),u.pos=h}u.seek(0,2);var g,p=u.getInt16();for(i=0;p>i;i++){if(s=u.getInt16(),n=u.pos,null!=t)g=t[e+i];else{u.seek(n,0);var m=u.readByte(),v=u.readS(),y=u.readS(),w=null;if(null!=v){var b;b=null!=y?$.getById(y):this.packageItem.owner,w=null!=b?b.getItemById(v):null}null!=w?(g=Q.newObject(w),g.packageItem=w,g.constructFromResource()):g=Q.newObject2(m)}g._underConstruct=!0,g.setup_beforeAdd(u,n),g.parent=this,this._children.push(g),u.pos=n+s}for(u.seek(0,3),this.relations.setup(u,!0),u.seek(0,2),u.skip(2),i=0;p>i;i++)h=u.getInt16(),h+=u.pos,u.seek(u.pos,3),this._children[i].relations.setup(u,!1),u.pos=h;for(u.seek(0,2),u.skip(2),i=0;p>i;i++)h=u.getInt16(),h+=u.pos,g=this._children[i],g.setup_afterAdd(u,u.pos),g._underConstruct=!1,u.pos=h;u.seek(0,4),u.skip(2),this.opaque=u.readBool();var C=u.getInt16();-1!=C&&this.setMask(this.getChildAt(C).displayObject,u.readBool());var x=u.readS();null!=x&&(w=this.packageItem.owner.getItemById(x),null!=w&&null!=w.pixelHitTestData&&(a=u.getInt32(),l=u.getInt32(),this._displayObject.hitArea=new he(w.pixelHitTestData,a,l),this._displayObject.mouseThrough=!1,this._displayObject.hitTestPrior=!0)),u.seek(0,5);var S=u.getInt16();for(i=0;S>i;i++){h=u.getInt16(),h+=u.pos;var I=new N(this);I.setup(u),this._transitions.push(I),u.pos=h}this._transitions.length>0&&(this.displayObject.on("display",this,this.___added),this.displayObject.on("undisplay",this,this.___removed)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,this.buildNativeDisplayList(),this.setBoundsChangedFlag(),9!=this.packageItem.objectType&&this.constructExtension(u),this.constructFromXML(null)},s.constructExtension=function(){},s.constructFromXML=function(){},s.setup_afterAdd=function(e,i){t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,4);var s=e.getInt16();-1!=s&&null!=this._scrollPane&&(this._scrollPane.pageController=this._parent.getControllerAt(s));for(var n=e.getInt16(),h=0;n>h;h++){var r=this.getController(e.readS()),o=e.readS();r&&(r.selectedPageId=o)}},s.___added=function(){for(var t=this._transitions.length,e=0;t>e;++e)this._transitions[e].onOwnerAddedToStage()},s.___removed=function(){for(var t=this._transitions.length,e=0;t>e;++e)this._transitions[e].onOwnerRemovedFromStage()},h(0,s,"numChildren",function(){return this._children.length}),h(0,s,"displayListContainer",function(){return this._container}),h(0,s,"childrenRenderOrder",function(){return this._childrenRenderOrder},function(t){this._childrenRenderOrder!=t&&(this._childrenRenderOrder=t,this.buildNativeDisplayList())}),h(0,s,"opaque",function(){return this._opaque},function(t){this._opaque!=t&&(this._opaque=t,this._opaque?(null==this._displayObject.hitArea&&(this._displayObject.hitArea=new v),this._displayObject.hitArea instanceof laya.maths.Rectangle&&this._displayObject.hitArea.setTo(0,0,this.width,this.height),this._displayObject.mouseThrough=!1):(this._displayObject.hitArea instanceof laya.maths.Rectangle&&(this._displayObject.hitArea=null),this._displayObject.mouseThrough=!0))}),h(0,s,"controllers",function(){return this._controllers}),h(0,s,"scrollPane",function(){return this._scrollPane}),h(0,s,"margin",function(){return this._margin},function(t){this._margin.copy(t),null!=this._displayObject.scrollRect&&this._container.pos(this._margin.left+this._alignOffset.x,this._margin.top+this._alignOffset.y),this.handleSizeChanged()}),h(0,s,"apexIndex",function(){return this._apexIndex},function(t){this._apexIndex!=t&&(this._apexIndex=t,2==this._childrenRenderOrder&&this.buildNativeDisplayList())}),h(0,s,"mask",function(){return this._mask},function(t){this.setMask(t,!1)}),h(0,s,"viewHeight",function(){return null!=this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},function(t){null!=this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom}),h(0,s,"baseUserData",function(){var t=this.packageItem.rawData;return t.seek(0,4),t.readS()}),h(0,s,"viewWidth",function(){return null!=this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},function(t){null!=this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right}),e}(P),ae=function(t){function e(){this._layout=0,this._lineGap=0,this._columnGap=0,this._percentReady=!1,this._boundsChanged=!1,this._updating=0,e.__super.call(this)}n(e,"fairygui.GGroup",t);var s=e.prototype;return s.setBoundsChangedFlag=function(t){void 0===t&&(t=!1),0==this._updating&&null!=this.parent&&(t&&(this._percentReady=!1),this._boundsChanged||(this._boundsChanged=!0,0!=this._layout&&i.timer.callLater(this,this.ensureBoundsCorrect)))},s.ensureBoundsCorrect=function(){this._boundsChanged&&this.updateBounds()},s.updateBounds=function(){if(i.timer.clear(this,this.ensureBoundsCorrect),this._boundsChanged=!1,null!=this.parent){this.handleLayout();var t,e=this._parent.numChildren,s=0,n=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=0,l=!0;for(s=0;e>s;s++)t=this._parent.getChildAt(s),t.group==this&&(a=t.x,n>a&&(n=a),a=t.y,h>a&&(h=a),a=t.x+t.width,a>r&&(r=a),a=t.y+t.height,a>o&&(o=a),l=!1);l?(this._updating=2,this.setSize(0,0)):(this._updating=1,this.setXY(n,h),this._updating=2,this.setSize(r-n,o-h)),this._updating=0}},s.handleLayout=function(){this._updating|=1;var t,e=0,i=0;if(1==this._layout){var s=0/0;for(i=this.parent.numChildren,e=0;i>e;e++)t=this.parent.getChildAt(e),t.group==this&&(isNaN(s)?s=Math.floor(t.x):t.x=s,0!=t.width&&(s+=Math.floor(t.width+this._columnGap)));this._percentReady||this.updatePercent()}else if(2==this._layout){var n=0/0;for(i=this.parent.numChildren,e=0;i>e;e++)t=this.parent.getChildAt(e),t.group==this&&(isNaN(n)?n=Math.floor(t.y):t.y=n,0!=t.height&&(n+=Math.floor(t.height+this._lineGap)));this._percentReady||this.updatePercent()}this._updating&=2},s.updatePercent=function(){this._percentReady=!0;var t,e=this.parent.numChildren,i=0,s=0;if(1==this._layout){for(i=0;e>i;i++)t=this.parent.getChildAt(i),t.group==this&&(s+=t.width);for(i=0;e>i;i++)t=this.parent.getChildAt(i),t.group==this&&(t._sizePercentInGroup=s>0?t.width/s:0)}else{for(i=0;e>i;i++)t=this.parent.getChildAt(i),t.group==this&&(s+=t.height);for(i=0;e>i;i++)t=this.parent.getChildAt(i),t.group==this&&(t._sizePercentInGroup=s>0?t.height/s:0)}},s.moveChildren=function(t,e){if(0==(1&this._updating)&&null!=this.parent){this._updating|=1;var i,s=this.parent.numChildren,n=0;for(n=0;s>n;n++)i=this.parent.getChildAt(n),i.group==this&&i.setXY(i.x+t,i.y+e);this._updating&=2}},s.resizeChildren=function(t,e){if(0!=this._layout&&0==(2&this._updating)&&null!=this.parent){this._updating|=2,this._percentReady||this.updatePercent();var i,s=this.parent.numChildren,n=0,h=0,r=-1,o=0,a=0,l=0,u=!1;for(n=0;s>n;n++)i=this.parent.getChildAt(n),i.group==this&&(r=n,o++);if(1==this._layout){l=a=this.width-(o-1)*this._columnGap;var _=0/0,c=0/0;for(n=0;s>n;n++)if(i=this.parent.getChildAt(n),i.group==this)if(isNaN(_)?_=Math.floor(i.x):i.x=_,c=r==n?l:Math.round(i._sizePercentInGroup*a),i.setSize(c,i._rawHeight+e,!0),l-=i.width,r==n){if(l>=1)for(h=0;n>=h;h++)i=this.parent.getChildAt(h),i.group==this&&(u?i.x+=l:(c=i.width+l,(0==i.maxWidth||c<i.maxWidth)&&(0==i.minWidth||c>i.minWidth)&&(i.setSize(c,i.height,!0),u=!0)))}else _+=i.width+this._columnGap}else if(2==this._layout){l=a=this.height-(o-1)*this._lineGap;var d=0/0,f=0/0;for(n=0;s>n;n++)if(i=this.parent.getChildAt(n),i.group==this)if(isNaN(d)?d=Math.floor(i.y):i.y=d,f=r==n?l:Math.round(i._sizePercentInGroup*a),i.setSize(i._rawWidth+t,f,!0),l-=i.height,r==n){if(l>=1)for(h=0;n>=h;h++)i=this.parent.getChildAt(h),i.group==this&&(u?i.y+=l:(f=i.height+l,(0==i.maxHeight||f<i.maxHeight)&&(0==i.minHeight||f>i.minHeight)&&(i.setSize(i.width,f,!0),u=!0)))}else d+=i.height+this._lineGap}this._updating&=1}},s.handleAlphaChanged=function(){if(!this._underConstruct)for(var t=this._parent.numChildren,e=0;t>e;e++){var i=this._parent.getChildAt(e);i.group==this&&(i.alpha=this.alpha)}},s.handleVisibleChanged=function(){if(this._parent)for(var t=this._parent.numChildren,e=0;t>e;e++){var i=this._parent.getChildAt(e);i.group==this&&i.handleVisibleChanged()}},s.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5),this._layout=e.readByte(),this._lineGap=e.getInt32(),this._columnGap=e.getInt32()},s.setup_afterAdd=function(e,i){t.prototype.setup_afterAdd.call(this,e,i),this.visible||this.handleVisibleChanged()},h(0,s,"layout",function(){return this._layout},function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(!0))}),h(0,s,"columnGap",function(){return this._columnGap},function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag())}),h(0,s,"lineGap",function(){return this._lineGap},function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag())}),e}(P),le=function(t){function e(){this._gearColor=null,this._templateVars=null,this._text=null,e.__super.call(this),this._gearColor=new pe(this)}n(e,"fairygui.GTextField",t);var s=e.prototype;return i.imps(s,{"fairygui.gears.IColorGear":!0}),s.parseTemplate=function(t){for(var e,i,s=0,n=0,h=0,r="";-1!=(n=t.indexOf("{",s));)if(n>0&&92==t.charCodeAt(n-1))r+=t.substring(s,n-1),r+="{",s=n+1;else{if(r+=t.substring(s,n),s=n,n=t.indexOf("}",s),-1==n)break;n!=s+1?(e=t.substring(s+1,n),h=e.indexOf("="),-1!=h?(i=this._templateVars[e.substring(0,h)],r+=null==i?e.substring(h+1):i):(i=this._templateVars[e],null!=i&&(r+=i)),s=n+1):(r+=t.substr(s,2),s=n+1)}return s<t.length&&(r+=t.substr(s)),r},s.setVar=function(t,e){return this._templateVars||(this._templateVars={}),this._templateVars[t]=e,this},s.flushVars=function(){this.text=this._text},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._gearColor.controller==e&&this._gearColor.apply()},s.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5);var s=0;this.font=e.readS(),this.fontSize=e.getInt16(),this.color=e.readColorS(),s=e.readByte(),this.align=0==s?"left":1==s?"center":"right",s=e.readByte(),this.valign=0==s?"top":1==s?"middle":"bottom",this.leading=e.getInt16(),this.letterSpacing=e.getInt16(),this.ubbEnabled=e.readBool(),this.autoSize=e.readByte(),this.underline=e.readBool(),this.italic=e.readBool(),this.bold=e.readBool(),this.singleLine=e.readBool(),e.readBool()&&(this.strokeColor=e.readColorS(),this.stroke=e.getFloat32()+1),e.readBool()&&e.skip(12),e.readBool()&&(this._templateVars={})},s.setup_afterAdd=function(e,i){t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6);var s=e.readS();null!=s&&(this.text=s)},h(0,s,"color",function(){return null},function(){}),h(0,s,"font",function(){return null},function(){}),h(0,s,"templateVars",function(){return this._templateVars},function(t){(null!=this._templateVars||null!=t)&&(this._templateVars=t,this.flushVars())}),h(0,s,"leading",function(){return 0},function(){}),h(0,s,"fontSize",function(){return 0},function(){}),h(0,s,"bold",function(){return!1},function(){}),h(0,s,"letterSpacing",function(){return 0},function(){}),h(0,s,"align",function(){return null},function(){}),h(0,s,"valign",function(){return null},function(){}),h(0,s,"italic",function(){return!1},function(){}),h(0,s,"underline",function(){return!1},function(){}),h(0,s,"singleLine",function(){return!1},function(){}),h(0,s,"stroke",function(){return 0},function(){}),h(0,s,"strokeColor",function(){return null},function(){}),h(0,s,"ubbEnabled",function(){return!1},function(){}),h(0,s,"autoSize",function(){return 0},function(){}),h(0,s,"textWidth",function(){return 0}),e}(P),ue=function(t){function e(){this.objectId=null,this.controllerName=null,this.targetPage=null,e.__super.call(this)}n(e,"fairygui.action.ChangePageAction",t);var i=e.prototype;return i.enter=function(t){if(this.controllerName){var e;if(e=this.objectId?t.parent.getChildById(this.objectId):t.parent){var i=e.getController(this.controllerName);i&&i!=t&&!i.changing&&(i.selectedPageId=this.targetPage)}}},i.setup=function(e){t.prototype.setup.call(this,e),this.objectId=e.readS(),this.controllerName=e.readS(),this.targetPage=e.readS()},e}(B),_e=function(t){function e(){this._type=0,this._lineSize=0/0,this._lineColor=null,this._fillColor=null,this._cornerRadius=null,this._hitArea=null,e.__super.call(this),this._type=0,this._lineSize=1,this._lineColor="#000000",this._fillColor="#FFFFFF",this._cornerRadius=null}n(e,"fairygui.GGraph",t);var s=e.prototype;return i.imps(s,{"fairygui.gears.IColorGear":!0}),s.drawRect=function(t,e,i,s){this._type=1,this._lineSize=t,this._lineColor=e,this._fillColor=i,this._cornerRadius=s,this.drawCommon()},s.drawEllipse=function(t,e,i){this._type=2,this._lineSize=t,this._lineColor=e,this._fillColor=i,this.drawCommon()},s.drawCommon=function(){this._displayObject.mouseEnabled=this.touchable;var t=this._displayObject.graphics;t.clear();var e=this.width,i=this.height;if(0!=e&&0!=i){var s=this._fillColor,n=this._lineColor;if(y.isWebGL&&I.startsWith(s,"rgba")){var h=s.substring(5,s.lastIndexOf(")")).split(","),r=parseFloat(h[3]);0==r?s=null:(s=S.toHexColor((parseInt(h[0])<<16)+(parseInt(h[1])<<8)+parseInt(h[2])),this.alpha=r)}if(1==this._type)if(null!=this._cornerRadius){var o=[["moveTo",this._cornerRadius[0],0],["lineTo",e-this._cornerRadius[1],0],["arcTo",e,0,e,this._cornerRadius[1],this._cornerRadius[1]],["lineTo",e,i-this._cornerRadius[3]],["arcTo",e,i,e-this._cornerRadius[3],i,this._cornerRadius[3]],["lineTo",this._cornerRadius[2],i],["arcTo",0,i,0,i-this._cornerRadius[2],this._cornerRadius[2]],["lineTo",0,this._cornerRadius[0]],["arcTo",0,0,this._cornerRadius[0],0,this._cornerRadius[0]],["closePath"]];t.drawPath(0,0,o,{fillStyle:s},this._lineSize>0?{strokeStyle:n,lineWidth:this._lineSize}:null)}else t.drawRect(0,0,e,i,s,this._lineSize>0?n:null,this._lineSize);else t.drawCircle(e/2,i/2,e/2,s,this._lineSize>0?n:null,this._lineSize);this._displayObject.repaint()}},s.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},s.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)},s.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);e++,this._parent.addChildAt(t,e)},s.setNativeObject=function(t){this._type=0,this._displayObject.mouseEnabled=this.touchable,this._displayObject.graphics.clear(),this._displayObject.addChild(t)},s.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!1,this._hitArea=new f,this._hitArea.hit=this._displayObject.graphics,this._displayObject.hitArea=this._hitArea},s.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),0!=this._type&&this.drawCommon()},s.setup_beforeAdd=function(e,i){if(t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5),this._type=e.readByte(),0!=this._type){if(this._lineSize=e.getInt32(),this._lineColor=e.readColorS(!0),this._fillColor=e.readColorS(!0),e.readBool()){this._cornerRadius=[];for(var s=0;4>s;s++)this._cornerRadius[s]=e.getFloat32()}this.drawCommon()}},h(0,s,"color",function(){return this._fillColor},function(t){this._fillColor=t,0!=this._type&&this.drawCommon()}),e}(P),ce=function(t){function e(t,i,s){this.stringTable=null,this.version=0,void 0===i&&(i=0),void 0===s&&(s=-1),-1==s&&(s=t.byteLength-i),0==i&&s==t.byteLength?e.__super.call(this,t):(this._u8d_=new Uint8Array(t,i,s),this._d_=new DataView(this._u8d_.buffer,i,s),this._length=s),this.endian="bigEndian"}n(e,"fairygui.utils.ByteBuffer",t);var i=e.prototype;return i.skip=function(t){this.pos+=t},i.readBool=function(){return 1==this.getUint8()},i.readS=function(){var t=this.getUint16();return 65534==t?null:65533==t?"":this.stringTable[t]},i.writeS=function(t){var e=this.getUint16();65534!=e&&65533!=e&&(this.stringTable[e]=t)},i.readColor=function(t){void 0===t&&(t=!1);var e=this.getUint8(),i=this.getUint8(),s=this.getUint8(),n=this.getUint8();return(t?n<<24:0)+(e<<16)+(i<<8)+s},i.readColorS=function(t){void 0===t&&(t=!1);var e=this.getUint8(),i=this.getUint8(),s=this.getUint8(),n=this.getUint8();if(t&&255!=n)return"rgba("+e+","+i+","+s+","+n/255+")";var h=e.toString(16),r=i.toString(16),o=s.toString(16);return 1==h.length&&(h="0"+h),1==r.length&&(r="0"+r),1==o.length&&(o="0"+o),"#"+h+r+o},i.readChar=function(){var t=this.getUint16();return String.fromCharCode(t)},i.readBuffer=function(){var t=this.getUint32(),i=new e(this.buffer,this._pos_,t);return i.stringTable=this.stringTable,i.version=this.version,i},i.seek=function(t,e){var i=this._pos_;this.pos=t;var s=this.getUint8();if(s>e){var n=1==this.getUint8(),h=0;return n?(this.pos+=2*e,h=this.getUint16()):(this.pos+=4*e,h=this.getUint32()),h>0?(this.pos=t+h,!0):(this.pos=i,!1)}return this.pos=i,!1},e}(a),de=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}n(e,"fairygui.gears.GearIcon",t);var i=e.prototype;return i.init=function(){this._default=this._owner.icon,this._storage={}},i.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},i.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.icon=void 0!==t?t:this._default,this._owner._gearLocked=!1},i.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.icon},e}(L),fe=function(t){function e(){this._movieClip=null,e.__super.call(this)}n(e,"fairygui.GMovieClip",t);var s=e.prototype;return i.imps(s,{"fairygui.gears.IAnimationGear":!0,"fairygui.gears.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this._movieClip=new Ge,this._movieClip.mouseEnabled=!1,this._displayObject.$owner=this},s.rewind=function(){this._movieClip.rewind()},s.syncStatus=function(t){this._movieClip.syncStatus(t._movieClip)},s.advance=function(t){this._movieClip.advance(t)},s.setPlaySettings=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),this._movieClip.setPlaySettings(t,e,i,s,n)},s.constructFromResource=function(){this.sourceWidth=this.packageItem.width,this.sourceHeight=this.packageItem.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),this.packageItem.load(),this._movieClip.interval=this.packageItem.interval,this._movieClip.swing=this.packageItem.swing,this._movieClip.repeatDelay=this.packageItem.repeatDelay,this._movieClip.frames=this.packageItem.frames},s.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5),e.readBool()&&(this.color=e.readColorS()),e.readByte(),this._movieClip.frame=e.getInt32(),this._movieClip.playing=e.readBool()},h(0,s,"color",function(){return"#FFFFFF"},function(){}),h(0,s,"playing",function(){return this._movieClip.playing},function(t){this._movieClip.playing!=t&&(this._movieClip.playing=t,this.updateGear(5))}),h(0,s,"timeScale",function(){return this._movieClip.timeScale},function(t){this._movieClip.timeScale=t}),h(0,s,"frame",function(){return this._movieClip.frame},function(t){this._movieClip.frame!=t&&(this._movieClip.frame=t,this.updateGear(5))}),e}(P),ge=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}var i;n(e,"fairygui.gears.GearLook",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.alpha,this._owner.rotation,this._owner.grayed,this._owner.touchable),this._storage={}},s.addStatus=function(t,e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s),s.alpha=e.getFloat32(),s.rotation=e.getFloat32(),s.grayed=e.readBool(),s.touchable=e.readBool()},s.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),null==this._tweenConfig||!this._tweenConfig.tween||$._constructing||L.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.alpha=t.alpha,this._owner.rotation=t.rotation,this._owner.touchable=t.touchable,this._owner._gearLocked=!1;else{if(this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.touchable=t.touchable,this._owner._gearLocked=!1,null!=this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.alpha&&this._tweenConfig._tweener.endValue.y==t.rotation)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.alpha!=this._owner.alpha,i=t.rotation!=this._owner.rotation;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=T.to2(this._owner.alpha,this._owner.rotation,t.alpha,t.rotation,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}},s.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&(this._owner.alpha=t.value.x),0!=(2&e)&&(this._owner.rotation=t.value.y),this._owner._gearLocked=!1},s.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},s.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed,t.touchable=this._owner.touchable},e.__init$=function(){i=function(){function t(t,e,i,s){this.alpha=0/0,this.rotation=0/0,this.grayed=!1,this.touchable=!1,void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),void 0===s&&(s=!0),this.alpha=t,this.rotation=e,this.grayed=i,this.touchable=s}return n(t,""),t}()},e}(L),pe=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}var i;n(e,"fairygui.gears.GearColor",t);var s=e.prototype;return s.init=function(){this._default=void 0!=this._owner.strokeColor?new i(this._owner.color,this._owner.strokeColor):new i(this._owner.color,null),this._storage={}},s.addStatus=function(t,e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s),s.color=e.readColorS(),s.strokeColor=e.readColorS()},s.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.color=t.color,void 0!=this._owner.strokeColor&&null!=t.strokeColor&&(this._owner.strokeColor=t.strokeColor),this._owner._gearLocked=!1},s.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i(null,null),this._storage[this._controller.selectedPageId]=t),t.color=this._owner.color,void 0!=this._owner.strokeColor&&(t.strokeColor=this._owner.strokeColor)},e.__init$=function(){i=function(){function t(t,e){this.color=null,this.strokeColor=null,this.color=t,this.strokeColor=e}return n(t,""),t}()},e}(L),me=function(t){function e(){this.transitionName=null,this.playTimes=1,this.delay=0,this.stopOnExit=!1,this._currentTransition=null,e.__super.call(this)}n(e,"fairygui.action.PlayTransitionAction",t);var i=e.prototype;return i.enter=function(t){var e=t.parent.getTransition(this.transitionName);e&&(this._currentTransition&&this._currentTransition.playing?e.changePlayTimes(this.playTimes):e.play(null,this.playTimes,this.delay),this._currentTransition=e)},i.leave=function(){this.stopOnExit&&this._currentTransition&&(this._currentTransition.stop(),this._currentTransition=null)},i.setup=function(e){t.prototype.setup.call(this,e),this.transitionName=e.readS(),this.playTimes=e.getInt32(),this.delay=e.getFloat32(),this.stopOnExit=e.readBool()},e}(B),ve=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}n(e,"fairygui.gears.GearText",t);var i=e.prototype;return i.init=function(){this._default=this._owner.text,this._storage={}},i.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},i.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.text=void 0!==t?t:this._default,this._owner._gearLocked=!1},i.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.text},e}(L),ye=function(t){function e(){this.image=null,this._flip=0,e.__super.call(this)}n(e,"fairygui.GImage",t);var s=e.prototype;return i.imps(s,{"fairygui.gears.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.image=new Fe,this.image.mouseEnabled=!1,this._displayObject.$owner=this},s.constructFromResource=function(){this.packageItem.load(),this.sourceWidth=this.packageItem.width,this.sourceHeight=this.packageItem.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.image.scale9Grid=this.packageItem.scale9Grid,this.image.scaleByTile=this.packageItem.scaleByTile,this.image.tileGridIndice=this.packageItem.tileGridIndice,this.image.texture=this.packageItem.texture,this.setSize(this.sourceWidth,this.sourceHeight)},s.handleXYChanged=function(){t.prototype.handleXYChanged.call(this),0!=this._flip&&(-1==this.scaleX&&(this.image.x+=this.width),-1==this.scaleY&&(this.image.y+=this.height))},s.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5),e.readBool()&&(this.color=e.readColorS()),this.flip=e.readByte(),this.image.fillMethod=e.readByte(),0!=this.image.fillMethod&&(this.image.fillOrigin=e.readByte(),this.image.fillClockwise=e.readBool(),this.image.fillAmount=e.getFloat32())},h(0,s,"color",function(){return this.image.color},function(t){this.image.color!=t&&(this.image.color=t,this.updateGear(4))}),h(0,s,"fillClockwise",function(){return this.image.fillClockwise},function(t){this.image.fillClockwise=t}),h(0,s,"flip",function(){return this._flip},function(t){if(this._flip!=t){this._flip=t;var e=1,i=1;(1==this._flip||3==this._flip)&&(e=-1),(2==this._flip||3==this._flip)&&(i=-1),this.setScale(e,i),this.handleXYChanged()}}),h(0,s,"fillMethod",function(){return this.image.fillMethod},function(t){this.image.fillMethod=t}),h(0,s,"fillOrigin",function(){return this.image.fillOrigin},function(t){this.image.fillOrigin=t}),h(0,s,"fillAmount",function(){return this.image.fillAmount},function(t){this.image.fillAmount=t}),e}(P),we=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}n(e,"fairygui.gears.GearXY",t);var i=e.prototype;return i.init=function(){this._default=new m(this._owner.x,this._owner.y),this._storage={}},i.addStatus=function(t,e){var i;null==t?i=this._default:(i=new m,this._storage[t]=i),i.x=e.getInt32(),i.y=e.getInt32()},i.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),null==this._tweenConfig||!this._tweenConfig.tween||$._constructing||L.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setXY(t.x,t.y),this._owner._gearLocked=!1;else{if(null!=this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.x&&this._tweenConfig._tweener.endValue.y==t.y)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}(this._owner.x!=t.x||this._owner.y!=t.y)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=T.to2(this._owner.x,this._owner.y,t.x,t.y,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}},i.__tweenUpdate=function(t){this._owner._gearLocked=!0,this._owner.setXY(t.value.x,t.value.y),this._owner._gearLocked=!1},i.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new m,this._storage[this._controller.selectedPageId]=t),t.x=this._owner.x,t.y=this._owner.y},i.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var s=this._storage[i];s.x+=t,s.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}},e}(L),be=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}var i;
n(e,"fairygui.gears.GearAnimation",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.playing,this._owner.frame),this._storage={}},s.addStatus=function(t,e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s),s.playing=e.readBool(),s.frame=e.getInt32()},s.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.frame=t.frame,this._owner.playing=t.playing,this._owner._gearLocked=!1},s.updateState=function(){var t=this._owner,e=this._storage[this._controller.selectedPageId];e||(e=new i,this._storage[this._controller.selectedPageId]=e),e.frame=t.frame,e.playing=t.playing},e.__init$=function(){i=function(){function t(t,e){this.playing=!1,this.frame=0/0,void 0===t&&(t=!0),void 0===e&&(e=0),this.playing=t,this.frame=e}return n(t,""),t}()},e}(L),Ce=function(t){function e(){this._url=null,this._align=null,this._valign=null,this._autoSize=!1,this._fill=0,this._shrinkOnly=!1,this._showErrorSign=!1,this._contentItem=null,this._contentSourceWidth=0,this._contentSourceHeight=0,this._contentWidth=0,this._contentHeight=0,this._content=null,this._errorSign=null,this._content2=null,this._updatingLayout=!1,e.__super.call(this),this._url="",this._fill=0,this._align="left",this._valign="top",this._showErrorSign=!0}n(e,"fairygui.GLoader",t);var r=e.prototype;return i.imps(r,{"fairygui.gears.IAnimationGear":!0,"fairygui.gears.IColorGear":!0}),r.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._content=new Ge,this._displayObject.addChild(this._content),this._displayObject.mouseEnabled=!0},r.dispose=function(){null==this._contentItem&&null!=this._content.texture&&this.freeExternal(this._content.texture),null!=this._content2&&this._content2.dispose(),t.prototype.dispose.call(this)},r.advance=function(t){this._content.advance(t)},r.loadContent=function(){this.clearContent(),this._url&&(I.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},r.loadFromPackage=function(t){if(this._contentItem=$.getItemByURL(t),null!=this._contentItem)if(this._contentItem.load(),this._autoSize&&this.setSize(this._contentItem.width,this._contentItem.height),0==this._contentItem.type)null==this._contentItem.texture?this.setErrorState():(this._content.texture=this._contentItem.texture,this._content.scale9Grid=this._contentItem.scale9Grid,this._content.scaleByTile=this._contentItem.scaleByTile,this._content.tileGridIndice=this._contentItem.tileGridIndice,this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout());else if(1==this._contentItem.type)this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this._content.interval=this._contentItem.interval,this._content.swing=this._contentItem.swing,this._content.repeatDelay=this._contentItem.repeatDelay,this._content.frames=this._contentItem.frames,this.updateLayout();else if(3==this._contentItem.type){var e=$.createObjectFromURL(t);e?e instanceof fairygui.GComponent?(this._content2=e.asCom,this._displayObject.addChild(this._content2.displayObject),this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout()):(e.dispose(),this.setErrorState()):this.setErrorState()}else this.setErrorState();else this.setErrorState()},r.loadExternal=function(){E.inst.load(this._url,d.create(this,this.__getResCompleted),null,"image")},r.freeExternal=function(){},r.onExternalLoadSuccess=function(t){this._content.texture=t,this._content.scale9Grid=null,this._content.scaleByTile=!1,this._contentSourceWidth=t.width,this._contentSourceHeight=t.height,this.updateLayout()},r.onExternalLoadFailed=function(){this.setErrorState()},r.__getResCompleted=function(t){null!=t?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},r.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=ie.loaderErrorSign&&(this._errorSign=fairygui.GLoader._errorSignPool.getObject(ie.loaderErrorSign)),null!=this._errorSign&&(this._errorSign.setSize(this.width,this.height),this._displayObject.addChild(this._errorSign.displayObject)))},r.clearErrorState=function(){null!=this._errorSign&&(this._displayObject.removeChild(this._errorSign.displayObject),fairygui.GLoader._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},r.updateLayout=function(){if(null==this._content2&&null==this._content.texture&&null==this._content.frames)return this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1),void 0;if(this._contentWidth=this._contentSourceWidth,this._contentHeight=this._contentSourceHeight,this._autoSize&&(this._updatingLayout=!0,0==this._contentWidth&&(this._contentWidth=50),0==this._contentHeight&&(this._contentHeight=30),this.setSize(this._contentWidth,this._contentHeight),this._updatingLayout=!1,this._contentWidth==this._width&&this._contentHeight==this._height))return null!=this._content2?(this._content2.setXY(0,0),this._content2.setScale(1,1)):(this._content.size(this._contentWidth,this._contentHeight),this._content.pos(0,0)),void 0;var t=1,e=1;0!=this._fill&&(t=this.width/this._contentSourceWidth,e=this.height/this._contentSourceHeight,(1!=t||1!=e)&&(2==this._fill?t=e:3==this._fill?e=t:1==this._fill?t>e?t=e:e=t:5==this._fill&&(t>e?e=t:t=e),this._shrinkOnly&&(t>1&&(t=1),e>1&&(e=1)),this._contentWidth=this._contentSourceWidth*t,this._contentHeight=this._contentSourceHeight*e)),null!=this._content2?this._content2.setScale(t,e):this._content.size(this._contentWidth,this._contentHeight);var i=0/0,s=0/0;i="center"==this._align?Math.floor((this.width-this._contentWidth)/2):"right"==this._align?this.width-this._contentWidth:0,s="middle"==this._valign?Math.floor((this.height-this._contentHeight)/2):"bottom"==this._valign?this.height-this._contentHeight:0,null!=this._content2?this._content2.setXY(i,s):this._content.pos(i,s)},r.clearContent=function(){this.clearErrorState(),null==this._contentItem&&null!=this._content.texture&&this.freeExternal(this._content.texture),this._content.texture=null,this._content.frames=null,null!=this._content2&&(this._content2.dispose(),this._content2=null),this._contentItem=null},r.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},r.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,5);var s=0;this._url=e.readS(),s=e.readByte(),this._align=0==s?"left":1==s?"center":"right",s=e.readByte(),this._valign=0==s?"top":1==s?"middle":"bottom",this._fill=e.readByte(),this._shrinkOnly=e.readBool(),this._autoSize=e.readBool(),this._showErrorSign=e.readBool(),this._content.playing=e.readBool(),this._content.frame=e.getInt32(),e.readBool()&&(this.color=e.readColorS());var n=e.readByte();0!=n&&e.skip(6),this._url&&this.loadContent()},h(0,r,"frame",function(){return this._content.frame},function(t){this._content.frame!=t&&(this._content.frame=t,this.updateGear(5))}),h(0,r,"url",function(){return this._url},function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))}),h(0,r,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.updateLayout())}),h(0,r,"fill",function(){return this._fill},function(t){this._fill!=t&&(this._fill=t,this.updateLayout())}),h(0,r,"verticalAlign",function(){return this._valign},function(t){this._valign!=t&&(this._valign=t,this.updateLayout())}),h(0,r,"icon",function(){return this._url},function(t){this.url=t}),h(0,r,"content",function(){return this._content}),h(0,r,"shrinkOnly",function(){return this._shrinkOnly},function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())}),h(0,r,"showErrorSign",function(){return this._showErrorSign},function(t){this._showErrorSign=t}),h(0,r,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}),h(0,r,"playing",function(){return this._content.playing},function(t){this._content.playing!=t&&(this._content.playing=t,this.updateGear(5))}),h(0,r,"timeScale",function(){return this._content.timeScale},function(t){this._content.timeScale=t}),h(0,r,"color",function(){return this._content.color},function(t){this._content.color!=t&&(this._content.color=t,this.updateGear(4))}),h(0,r,"component",function(){return this._content2}),s(e,["_errorSignPool",function(){return this._errorSignPool=new H}]),e}(P),xe=function(t){function e(t){this._storage=null,this._default=null,e.__super.call(this,t)}var i;n(e,"fairygui.gears.GearSize",t);var s=e.prototype;return s.init=function(){this._default=new i(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY),this._storage={}},s.addStatus=function(t,e){var s;null==t?s=this._default:(s=new i,this._storage[t]=s),s.width=e.getInt32(),s.height=e.getInt32(),s.scaleX=e.getFloat32(),s.scaleY=e.getFloat32()},s.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),null==this._tweenConfig||!this._tweenConfig.tween||$._constructing||L.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setSize(t.width,t.height,this._owner.checkGearController(1,this._controller)),this._owner.setScale(t.scaleX,t.scaleY),this._owner._gearLocked=!1;else{if(null!=this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.width&&this._tweenConfig._tweener.endValue.y==t.height&&this._tweenConfig._tweener.endValue.z==t.scaleX&&this._tweenConfig._tweener.endValue.w==t.scaleY)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.width!=this._owner.width||t.height!=this._owner.height,i=t.scaleX!=this._owner.scaleX||t.scaleY!=this._owner.scaleY;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=T.to4(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY,t.width,t.height,t.scaleX,t.scaleY,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}},s.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&this._owner.setSize(t.value.x,t.value.y,this._owner.checkGearController(1,this._controller)),0!=(2&e)&&this._owner.setScale(t.value.z,t.value.w),this._owner._gearLocked=!1},s.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},s.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(t=new i,this._storage[this._controller.selectedPageId]=t),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY},s.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){var s=this._storage[i];s.width+=t,s.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}},e.__init$=function(){i=function(){function t(t,e,i,s){this.width=0/0,this.height=0/0,this.scaleX=0/0,this.scaleY=0/0,void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.width=t,this.height=e,this.scaleX=i,this.scaleY=s}return n(t,""),t}()},e}(L),Se=function(t){function e(t){this.pages=null,this._visible=0,this._displayLockToken=0,e.__super.call(this,t),this._displayLockToken=1}n(e,"fairygui.gears.GearDisplay",t);var i=e.prototype;return i.init=function(){this.pages=null},i.addLock=function(){return this._visible++,this._displayLockToken},i.releaseLock=function(t){t==this._displayLockToken&&this._visible--},i.apply=function(){this._displayLockToken++,this._displayLockToken<=0&&(this._displayLockToken=1),this._visible=null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?1:0},h(0,i,"connected",function(){return null==this._controller||this._visible>0}),e}(L),Ie=function(t){function e(){this._max=0,this._value=0,this._titleType=0,this._reverse=!1,this._titleObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._gripObject=null,this._clickPos=null,this._clickPercent=0,this._barStartX=0,this._barStartY=0,this.changeOnClick=!0,this.canDrag=!0,e.__super.call(this),this._titleType=0,this._value=50,this._max=100,this._clickPos=new laya.maths.Point}n(e,"fairygui.GSlider",t);var r=e.prototype;return r.update=function(){var t=Math.min(this._value/this._max,1);this.updateWidthPercent(t)},r.updateWidthPercent=function(t){if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*t)+"%";break;case 1:this._titleObject.text=this._value+"/"+this._max;break;case 2:this._titleObject.text=""+this._value;break;case 3:this._titleObject.text=""+this._max}var e=this.width-this._barMaxWidthDelta,i=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(e*t),this._barObjectH.x=this._barStartX+(e-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(i*t),this._barObjectV.y=this._barStartY+(i-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(e*t)),this._barObjectV&&(this._barObjectV.height=Math.round(i*t)))},r.constructExtension=function(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y),this._gripObject&&this._gripObject.on("mousedown",this,this.__gripMouseDown),this.displayObject.on("mousedown",this,this.__barMouseDown)},r.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},r.setup_afterAdd=function(e,i){return t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6)?e.readByte()!=this.packageItem.objectType?(this.update(),void 0):(this._value=e.getInt32(),this._max=e.getInt32(),this.update(),void 0):(this.update(),void 0)},r.__gripMouseDown=function(t){this.canDrag=!0,t.stopPropagation(),this._clickPos=this.globalToLocal(i.stage.mouseX,i.stage.mouseY),this._clickPercent=this._value/this._max,i.stage.on("mousemove",this,this.__gripMouseMove),i.stage.on("mouseup",this,this.__gripMouseUp)},r.__gripMouseMove=function(t){if(this.canDrag){var e=this.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GSlider.sSilderHelperPoint),s=e.x-this._clickPos.x,n=e.y-this._clickPos.y;this._reverse&&(s=-s,n=-n);var h=0/0;h=this._barObjectH?this._clickPercent+s/this._barMaxWidth:this._clickPercent+n/this._barMaxHeight,h>1?h=1:0>h&&(h=0);var r=Math.round(this._max*h);r!=this._value&&(this._value=r,j.dispatch("fui_state_changed",this.displayObject,t)),this.updateWidthPercent(h)}},r.__gripMouseUp=function(){i.stage.off("mousemove",this,this.__gripMouseMove),i.stage.off("mouseup",this,this.__gripMouseUp)},r.__barMouseDown=function(t){if(this.changeOnClick){var e=this._gripObject.globalToLocal(t.stageX,t.stageY,fairygui.GSlider.sSilderHelperPoint),i=this._value/this._max,s=0/0;this._barObjectH&&(s=(e.x-this._gripObject.width/2)/this._barMaxWidth),this._barObjectV&&(s=(e.y-this._gripObject.height/2)/this._barMaxHeight),this._reverse?i-=s:i+=s,i>1?i=1:0>i&&(i=0);var n=Math.round(this._max*i);n!=this._value&&(this._value=n,j.dispatch("fui_state_changed",this.displayObject,t)),this.updateWidthPercent(i)}},h(0,r,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update())}),h(0,r,"titleType",function(){return this._titleType},function(t){this._titleType=t}),h(0,r,"value",function(){return this._value},function(t){this._value!=t&&(this._value=t,this.update())}),s(e,["sSilderHelperPoint",function(){return this.sSilderHelperPoint=new m}]),e}(oe),ke=function(t){function e(){this.itemRenderer=null,this.itemProvider=null,this.scrollItemToViewOnClick=!1,this.foldInvisibleItems=!1,this._layout=0,this._lineCount=0,this._columnCount=0,this._lineGap=0,this._columnGap=0,this._defaultItem=null,this._autoResizeItem=!1,this._selectionMode=0,this._align=null,this._verticalAlign=null,this._selectionController=null,this._lastSelectedIndex=0,this._pool=null,this._virtual=!1,this._loop=!1,this._numItems=0,this._realNumItems=0,this._firstIndex=0,this._curLineItemCount=0,this._curLineItemCount2=0,this._itemSize=null,this._virtualListChanged=0,this._virtualItems=null,this._eventLocked=!1,this.itemInfoVer=0,e.__super.call(this),this._trackBounds=!0,this._pool=new H,this._layout=0,this._autoResizeItem=!0,this._lastSelectedIndex=-1,this._selectionMode=0,this.opaque=!0,this.scrollItemToViewOnClick=!0,this._align="left",this._verticalAlign="top",this._container=new b,this._displayObject.addChild(this._container)}var s;n(e,"fairygui.GList",t);var r=e.prototype;return r.dispose=function(){this._pool.clear(),t.prototype.dispose.call(this)},r.getFromPool=function(t){t||(t=this._defaultItem);var e=this._pool.getObject(t);return null!=e&&(e.visible=!0),e},r.returnToPool=function(t){t.displayObject.cacheAs="none",this._pool.returnObject(t)},r.addChildAt=function(e,i){if(void 0===i&&(i=0),t.prototype.addChildAt.call(this,e,i),e instanceof fairygui.GButton){var s=e;s.selected=!1,s.changeStateOnClick=!1}return e.on("click",this,this.__clickItem),e},r.addItem=function(t){return t||(t=this._defaultItem),this.addChild($.createObjectFromURL(t))},r.addItemFromPool=function(t){return this.addChild(this.getFromPool(t))},r.removeChildAt=function(e,i){void 0===i&&(i=!1);var s=t.prototype.removeChildAt.call(this,e);return i?s.dispose():s.off("click",this,this.__clickItem),s},r.removeChildToPoolAt=function(e){void 0===e&&(e=0);var i=t.prototype.removeChildAt.call(this,e);this.returnToPool(i)},r.removeChildToPool=function(t){this.removeChild(t),this.returnToPool(t)},r.removeChildrenToPool=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),(0>e||e>=this._children.length)&&(e=this._children.length-1);for(var i=t;e>=i;++i)this.removeChildToPoolAt(t)},r.getSelection=function(){var t=[],e=0;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];if(i.obj instanceof fairygui.GButton&&i.obj.selected||null==i.obj&&i.selected){var s=e;if(this._loop&&(s=e%this._numItems,-1!=t.indexOf(s)))continue;t.push(s)}}else{var n=this._children.length;for(e=0;n>e;e++){var h=this._children[e].asButton;null!=h&&h.selected&&t.push(e)}}return t},r.addSelection=function(t,e){if(void 0===e&&(e=!1),3!=this._selectionMode){this.checkVirtualList(),0==this._selectionMode&&this.clearSelection(),e&&this.scrollToView(t),this._lastSelectedIndex=t;var i=null;if(this._virtual){var s=this._virtualItems[t];null!=s.obj&&(i=s.obj.asButton),s.selected=!0}else i=this.getChildAt(t).asButton;null==i||i.selected||(i.selected=!0,this.updateSelectionController(t))}},r.removeSelection=function(t){if(3!=this._selectionMode){var e=null;if(this._virtual){var i=this._virtualItems[t];null!=i.obj&&(e=i.obj.asButton),i.selected=!1}else e=this.getChildAt(t).asButton;null!=e&&(e.selected=!1)}},r.clearSelection=function(){var t=0;if(this._virtual)for(t=0;t<this._realNumItems;t++){var e=this._virtualItems[t];e.obj instanceof fairygui.GButton&&(e.obj.selected=!1),e.selected=!1}else{var i=this._children.length;for(t=0;i>t;t++){var s=this._children[t].asButton;null!=s&&(s.selected=!1)}}},r.clearSelectionExcept=function(t){var e=0;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];i.obj!=t&&(i.obj instanceof fairygui.GButton&&(i.obj.selected=!1),i.selected=!1)}else{var s=this._children.length;for(e=0;s>e;e++){var n=this._children[e].asButton;null!=n&&n!=t&&(n.selected=!1)}}},r.selectAll=function(){this.checkVirtualList();var t=-1,e=0;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];i.obj instanceof fairygui.GButton&&!i.obj.selected&&(i.obj.selected=!0,t=e),i.selected=!0}else{var s=this._children.length;for(e=0;s>e;e++){var n=this._children[e].asButton;null==n||n.selected||(n.selected=!0,t=e)}}-1!=t&&this.updateSelectionController(t)},r.selectNone=function(){this.clearSelection()},r.selectReverse=function(){this.checkVirtualList();var t=-1,e=0;if(this._virtual)for(e=0;e<this._realNumItems;e++){var i=this._virtualItems[e];i.obj instanceof fairygui.GButton&&(i.obj.selected=!i.obj.selected,i.obj.selected&&(t=e)),i.selected=!i.selected}else{var s=this._children.length;for(e=0;s>e;e++){var n=this._children[e].asButton;null!=n&&(n.selected=!n.selected,n.selected&&(t=e))}}-1!=t&&this.updateSelectionController(t)},r.handleArrowKey=function(t){void 0===t&&(t=0);var e=this.selectedIndex;if(-1!=e)switch(t){case 1:if(0==this._layout||3==this._layout)e--,e>=0&&(this.clearSelection(),this.addSelection(e,!0));else if(2==this._layout||4==this._layout){for(var i=this._children[e],s=0,n=e-1;n>=0;n--){var h=this._children[n];if(h.y!=i.y){i=h;break}s++}for(;n>=0;n--)if(h=this._children[n],h.y!=i.y){this.clearSelection(),this.addSelection(n+s+1,!0);break}}break;case 3:if(1==this._layout||2==this._layout||4==this._layout)e++,e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(3==this._layout){i=this._children[e],s=0;var r=this._children.length;for(n=e+1;r>n;n++){if(h=this._children[n],h.x!=i.x){i=h;break}s++}for(;r>n;n++)if(h=this._children[n],h.x!=i.x){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 5:if(0==this._layout||3==this._layout)e++,e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(2==this._layout||4==this._layout){for(i=this._children[e],s=0,r=this._children.length,n=e+1;r>n;n++){if(h=this._children[n],h.y!=i.y){i=h;break}s++}for(;r>n;n++)if(h=this._children[n],h.y!=i.y){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 7:if(1==this._layout||2==this._layout||4==this._layout)e--,e>=0&&(this.clearSelection(),this.addSelection(e,!0));else if(3==this._layout){for(i=this._children[e],s=0,n=e-1;n>=0;n--){if(h=this._children[n],h.x!=i.x){i=h;break}s++}for(;n>=0;n--)if(h=this._children[n],h.x!=i.x){this.clearSelection(),this.addSelection(n+s+1,!0);break}}}},r.__clickItem=function(t){if(null==this._scrollPane||!this._scrollPane.isDragged){var e=P.cast(t.currentTarget);this.setSelectionOnEvent(e,t),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(e,!0),this.displayObject.event("fui_click_item",[e,j.createEvent("fui_click_item",this.displayObject,t)])}},r.setSelectionOnEvent=function(t,e){if(t instanceof fairygui.GButton&&3!=this._selectionMode){var i=!1,s=t,n=this.childIndexToItemIndex(this.getChildIndex(t));if(0==this._selectionMode)s.selected||(this.clearSelectionExcept(s),s.selected=!0);else if(e.shiftKey){if(!s.selected)if(-1!=this._lastSelectedIndex){var h=Math.min(this._lastSelectedIndex,n),r=Math.max(this._lastSelectedIndex,n);r=Math.min(r,this.numItems-1);var o=0;if(this._virtual)for(o=h;r>=o;o++){var a=this._virtualItems[o];a.obj instanceof fairygui.GButton&&(a.obj.selected=!0),a.selected=!0}else for(o=h;r>=o;o++){var l=this.getChildAt(o).asButton;null!=l&&(l.selected=!0)}i=!0}else s.selected=!0}else e.ctrlKey||2==this._selectionMode?s.selected=!s.selected:s.selected?this.clearSelectionExcept(s):(this.clearSelectionExcept(s),s.selected=!0);i||(this._lastSelectedIndex=n),s.selected&&this.updateSelectionController(n)}},r.resizeToFit=function(t,e){void 0===t&&(t=1e6),void 0===e&&(e=0),this.ensureBoundsCorrect();var i=this.numItems;if(t>i&&(t=i),this._virtual){var s=Math.ceil(t/this._curLineItemCount);0==this._layout||2==this._layout?this.viewHeight=s*this._itemSize.y+Math.max(0,s-1)*this._lineGap:this.viewWidth=s*this._itemSize.x+Math.max(0,s-1)*this._columnGap}else if(0==t)0==this._layout||2==this._layout?this.viewHeight=e:this.viewWidth=e;else{for(var n=t-1,h=null;n>=0&&(h=this.getChildAt(n),this.foldInvisibleItems&&!h.visible);)n--;if(0>n)0==this._layout||2==this._layout?this.viewHeight=e:this.viewWidth=e;else{var r=0;0==this._layout||2==this._layout?(r=h.y+h.height,e>r&&(r=e),this.viewHeight=r):(r=h.x+h.width,e>r&&(r=e),this.viewWidth=r)}}},r.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;t>i;i++){var s=this.getChildAt(i);s.width>e&&(e=s.width)}return e},r.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)},r.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._selectionController==e&&(this.selectedIndex=e.selectedIndex)},r.updateSelectionController=function(t){if(null!=this._selectionController&&!this._selectionController.changing&&t<this._selectionController.pageCount){var e=this._selectionController;this._selectionController=null,e.selectedIndex=t,this._selectionController=e}},r.shouldSnapToNext=function(t,e,i){return 0>t&&e>ie.defaultScrollSnappingThreshold*i||t>0&&e>(1-ie.defaultScrollSnappingThreshold)*i||0==t&&e>i/2},r.getSnappingPositionWithDir=function(e,i,s,n,h){if(this._virtual){h||(h=new m);var r=0/0,o=0,a=0/0;return 0==this._layout||2==this._layout?(r=i,fairygui.GList.pos_param=i,o=this.getIndexOnPos1(!1),i=fairygui.GList.pos_param,o<this._virtualItems.length&&o<this._realNumItems&&(a=this._virtualItems[o].height,this.shouldSnapToNext(n,r-i,a)&&(i+=a+this._lineGap))):1==this._layout||3==this._layout?(r=e,fairygui.GList.pos_param=e,o=this.getIndexOnPos2(!1),e=fairygui.GList.pos_param,o<this._virtualItems.length&&o<this._realNumItems&&(a=this._virtualItems[o].width,this.shouldSnapToNext(s,r-e,a)&&(e+=a+this._columnGap))):(r=e,fairygui.GList.pos_param=e,o=this.getIndexOnPos3(!1),e=fairygui.GList.pos_param,o<this._virtualItems.length&&o<this._realNumItems&&(a=this._virtualItems[o].width,this.shouldSnapToNext(s,r-e,a)&&(e+=a+this._columnGap))),h.x=e,h.y=i,h}return t.prototype.getSnappingPositionWithDir.call(this,e,i,s,n,h)},r.scrollToView=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),this._virtual){if(0==this._numItems)return;if(this.checkVirtualList(),t>=this._virtualItems.length)throw new Error("Invalid child index: "+t+">"+this._virtualItems.length);this._loop&&(t=Math.floor(this._firstIndex/this._numItems)*this._numItems+t);var s,n=this._virtualItems[t],h=0,r=0;if(0==this._layout||2==this._layout){for(r=this._curLineItemCount-1;t>r;r+=this._curLineItemCount)h+=this._virtualItems[r].height+this._lineGap;s=new v(0,h,this._itemSize.x,n.height)}else if(1==this._layout||3==this._layout){for(r=this._curLineItemCount-1;t>r;r+=this._curLineItemCount)h+=this._virtualItems[r].width+this._columnGap;s=new v(h,0,n.width,this._itemSize.y)}else{var o=t/(this._curLineItemCount*this._curLineItemCount2);s=new v(o*this.viewWidth+t%this._curLineItemCount*(n.width+this._columnGap),t/this._curLineItemCount%this._curLineItemCount2*(n.height+this._lineGap),n.width,n.height)}i=!0,null!=this._scrollPane&&this._scrollPane.scrollToView(s,e,i)}else{var a=this.getChildAt(t);null!=this._scrollPane?this._scrollPane.scrollToView(a,e,i):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(a,e,i)}},r.getFirstChildInView=function(){return this.childIndexToItemIndex(t.prototype.getFirstChildInView.call(this))},r.childIndexToItemIndex=function(t){if(!this._virtual)return t;if(4==this._layout){for(var e=this._firstIndex;e<this._realNumItems;e++)if(null!=this._virtualItems[e].obj&&(t--,0>t))return e;return t}return t+=this._firstIndex,this._loop&&this._numItems>0&&(t%=this._numItems),t},r.itemIndexToChildIndex=function(t){if(!this._virtual)return t;if(4==this._layout)return this.getChildIndex(this._virtualItems[t].obj);if(this._loop&&this._numItems>0){var e=this._firstIndex%this._numItems;t>=e?t-=e:t=this._numItems-e+t}else t-=this._firstIndex;return t},r.setVirtual=function(){this._setVirtual(!1)},r.setVirtualAndLoop=function(){this._setVirtual(!0)},r._setVirtual=function(t){if(!this._virtual){if(null==this._scrollPane)throw new Error("Virtual list must be scrollable!");if(t){if(2==this._layout||3==this._layout)throw new Error("Loop list is not supported for FlowHorizontal or FlowVertical layout!");this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=t,this._virtualItems=[],this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new m;var e=this.getFromPool(null);if(null==e)throw new Error("Virtual List must have a default list item resource.");this._itemSize.x=e.width,this._itemSize.y=e.height,this.returnToPool(e)}0==this._layout||2==this._layout?(this._scrollPane.scrollStep=this._itemSize.y,this._loop&&(this._scrollPane._loop=2)):(this._scrollPane.scrollStep=this._itemSize.x,this._loop&&(this._scrollPane._loop=1)),this.on("fui_scroll",this,this.__scrolled),this.setVirtualListChangedFlag(!0)}},r.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},r.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),i.timer.clear(this,this._refreshVirtualList))},r.setVirtualListChangedFlag=function(t){void 0===t&&(t=!1),t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),i.timer.callLater(this,this._refreshVirtualList)},r._refreshVirtualList=function(){var t=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,t&&(0==this._layout||1==this._layout?this._curLineItemCount=1:2==this._layout?this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):3==this._layout?this._lineCount>0?this._curLineItemCount=this._lineCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(this._columnCount>0?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),this._lineCount>0?this._curLineItemCount2=this._lineCount:(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1))));var e=0,i=0;if(this._realNumItems>0){var s=0,n=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount,h=Math.min(this._curLineItemCount,this._realNumItems);if(0==this._layout||2==this._layout){for(s=0;n>s;s+=this._curLineItemCount)e+=this._virtualItems[s].height+this._lineGap;if(e>0&&(e-=this._lineGap),this._autoResizeItem)i=this._scrollPane.viewWidth;else{for(s=0;h>s;s++)i+=this._virtualItems[s].width+this._columnGap;i>0&&(i-=this._columnGap)}}else if(1==this._layout||3==this._layout){for(s=0;n>s;s+=this._curLineItemCount)i+=this._virtualItems[s].width+this._columnGap;if(i>0&&(i-=this._columnGap),this._autoResizeItem)e=this._scrollPane.viewHeight;else{for(s=0;h>s;s++)e+=this._virtualItems[s].height+this._lineGap;e>0&&(e-=this._lineGap)}}else{var r=Math.ceil(n/(this._curLineItemCount*this._curLineItemCount2));i=r*this.viewWidth,e=this.viewHeight}}this.handleAlign(i,e),this._scrollPane.setContentSize(i,e),this._eventLocked=!1,this.handleScroll(!0)},r.__scrolled=function(){this.handleScroll(!1)},r.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return e.pos_param=0,0;var i=0,s=0/0,n=0/0;if(this.numChildren>0&&!t){if(s=this.getChildAt(0).y,s>e.pos_param){for(i=this._firstIndex-this._curLineItemCount;i>=0;i-=this._curLineItemCount)if(s-=this._virtualItems[i].height+this._lineGap,s<=e.pos_param)return e.pos_param=s,i;
return e.pos_param=0,0}for(i=this._firstIndex;i<this._realNumItems;i+=this._curLineItemCount){if(n=s+this._virtualItems[i].height+this._lineGap,n>e.pos_param)return e.pos_param=s,i;s=n}return e.pos_param=s,this._realNumItems-this._curLineItemCount}for(s=0,i=0;i<this._realNumItems;i+=this._curLineItemCount){if(n=s+this._virtualItems[i].height+this._lineGap,n>e.pos_param)return e.pos_param=s,i;s=n}return e.pos_param=s,this._realNumItems-this._curLineItemCount},r.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return e.pos_param=0,0;var i=0,s=0/0,n=0/0;if(this.numChildren>0&&!t){if(s=this.getChildAt(0).x,s>e.pos_param){for(i=this._firstIndex-this._curLineItemCount;i>=0;i-=this._curLineItemCount)if(s-=this._virtualItems[i].width+this._columnGap,s<=e.pos_param)return e.pos_param=s,i;return e.pos_param=0,0}for(i=this._firstIndex;i<this._realNumItems;i+=this._curLineItemCount){if(n=s+this._virtualItems[i].width+this._columnGap,n>e.pos_param)return e.pos_param=s,i;s=n}return e.pos_param=s,this._realNumItems-this._curLineItemCount}for(s=0,i=0;i<this._realNumItems;i+=this._curLineItemCount){if(n=s+this._virtualItems[i].width+this._columnGap,n>e.pos_param)return e.pos_param=s,i;s=n}return e.pos_param=s,this._realNumItems-this._curLineItemCount},r.getIndexOnPos3=function(){if(this._realNumItems<this._curLineItemCount)return e.pos_param=0,0;var t=this.viewWidth,i=Math.floor(e.pos_param/t),s=i*this._curLineItemCount*this._curLineItemCount2,n=i*t,h=0,r=0/0;for(h=0;h<this._curLineItemCount;h++){if(r=n+this._virtualItems[s+h].width+this._columnGap,r>e.pos_param)return e.pos_param=n,s+h;n=r}return e.pos_param=n,s+this._curLineItemCount-1},r.handleScroll=function(t){if(!this._eventLocked){if(0==this._layout||2==this._layout){for(var e=0;this.handleScroll1(t);)if(e++,t=!1,e>20){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder1()}else if(1==this._layout||3==this._layout){for(e=0;this.handleScroll2(t);)if(e++,t=!1,e>20){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder2()}else this.handleScroll3(t);this._boundsChanged=!1}},r.handleScroll1=function(t){var e=this._scrollPane.scrollingPosY,i=e+this._scrollPane.viewHeight,s=i==this._scrollPane.contentHeight;fairygui.GList.pos_param=e;var n=this.getIndexOnPos1(t);if(e=fairygui.GList.pos_param,n==this._firstIndex&&!t)return!1;var h=this._firstIndex;this._firstIndex=n;var r,o,a=n,l=h>n,u=this.numChildren,_=h+u-1,c=l?_:h,d=0,f=e,g=!1,p=0,m=0,v=this.defaultItem,y=0,w=0,b=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;a<this._realNumItems&&(s||i>f);){if(r=this._virtualItems[a],(null==r.obj||t)&&(null!=this.itemProvider&&(v=this.itemProvider.runWith(a%this._numItems),null==v&&(v=this._defaultItem),v=$.normalizeURL(v)),null!=r.obj&&r.obj.resourceURL!=v&&(r.obj instanceof fairygui.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null)),null==r.obj){if(l){for(w=c;w>=h;w--)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=this.itemInfoVer&&o.obj.resourceURL==v){o.obj instanceof fairygui.GButton&&(o.selected=o.obj.selected),r.obj=o.obj,o.obj=null,w==c&&c--;break}}else for(w=c;_>=w;w++)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=this.itemInfoVer&&o.obj.resourceURL==v){o.obj instanceof fairygui.GButton&&(o.selected=o.obj.selected),r.obj=o.obj,o.obj=null,w==c&&c++;break}null!=r.obj?this.setChildIndex(r.obj,l?a-n:this.numChildren):(r.obj=this._pool.getObject(v),l?this.addChildAt(r.obj,a-n):this.addChild(r.obj)),r.obj instanceof fairygui.GButton&&(r.obj.selected=r.selected),g=!0}else g=t;g&&(this._autoResizeItem&&(0==this._layout||this._columnCount>0)&&r.obj.setSize(b,r.obj.height,!0),this.itemRenderer.runWith([a%this._numItems,r.obj]),a%this._curLineItemCount==0&&(p+=Math.ceil(r.obj.height)-r.height,a==n&&h>n&&(m=Math.ceil(r.obj.height)-r.height)),r.width=Math.ceil(r.obj.width),r.height=Math.ceil(r.obj.height)),r.updateFlag=this.itemInfoVer,r.obj.setXY(d,f),a==n&&(i+=r.height),d+=r.width+this._columnGap,a%this._curLineItemCount==this._curLineItemCount-1&&(d=0,f+=r.height+this._lineGap),a++}for(y=0;u>y;y++)r=this._virtualItems[h+y],r.updateFlag!=this.itemInfoVer&&null!=r.obj&&(r.obj instanceof fairygui.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null);for(u=this._children.length,y=0;u>y;y++){var C=this._virtualItems[n+y].obj;this._children[y]!=C&&this.setChildIndex(C,y)}return(0!=p||0!=m)&&this._scrollPane.changeContentSizeOnScrolling(0,p,0,m),a>0&&this.numChildren>0&&this._container.y<0&&this.getChildAt(0).y>-this._container.y?!0:!1},r.handleScroll2=function(t){var e=this._scrollPane.scrollingPosX,i=e+this._scrollPane.viewWidth,s=e==this._scrollPane.contentWidth;fairygui.GList.pos_param=e;var n=this.getIndexOnPos2(t);if(e=fairygui.GList.pos_param,n==this._firstIndex&&!t)return!1;var h=this._firstIndex;this._firstIndex=n;var r,o,a=n,l=h>n,u=this.numChildren,_=h+u-1,c=l?_:h,d=e,f=0,g=!1,p=0,m=0,v=this.defaultItem,y=0,w=0,b=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;a<this._realNumItems&&(s||i>d);){if(r=this._virtualItems[a],(null==r.obj||t)&&(null!=this.itemProvider&&(v=this.itemProvider.runWith(a%this._numItems),null==v&&(v=this._defaultItem),v=$.normalizeURL(v)),null!=r.obj&&r.obj.resourceURL!=v&&(r.obj instanceof fairygui.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null)),null==r.obj){if(l){for(w=c;w>=h;w--)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=this.itemInfoVer&&o.obj.resourceURL==v){o.obj instanceof fairygui.GButton&&(o.selected=o.obj.selected),r.obj=o.obj,o.obj=null,w==c&&c--;break}}else for(w=c;_>=w;w++)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=this.itemInfoVer&&o.obj.resourceURL==v){o.obj instanceof fairygui.GButton&&(o.selected=o.obj.selected),r.obj=o.obj,o.obj=null,w==c&&c++;break}null!=r.obj?this.setChildIndex(r.obj,l?a-n:this.numChildren):(r.obj=this._pool.getObject(v),l?this.addChildAt(r.obj,a-n):this.addChild(r.obj)),r.obj instanceof fairygui.GButton&&(r.obj.selected=r.selected),g=!0}else g=t;g&&(this._autoResizeItem&&(1==this._layout||this._lineCount>0)&&r.obj.setSize(r.obj.width,b,!0),this.itemRenderer.runWith([a%this._numItems,r.obj]),a%this._curLineItemCount==0&&(p+=Math.ceil(r.obj.width)-r.width,a==n&&h>n&&(m=Math.ceil(r.obj.width)-r.width)),r.width=Math.ceil(r.obj.width),r.height=Math.ceil(r.obj.height)),r.updateFlag=this.itemInfoVer,r.obj.setXY(d,f),a==n&&(i+=r.width),f+=r.height+this._lineGap,a%this._curLineItemCount==this._curLineItemCount-1&&(f=0,d+=r.width+this._columnGap),a++}for(y=0;u>y;y++)r=this._virtualItems[h+y],r.updateFlag!=this.itemInfoVer&&null!=r.obj&&(r.obj instanceof fairygui.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null);for(u=this._children.length,y=0;u>y;y++){var C=this._virtualItems[n+y].obj;this._children[y]!=C&&this.setChildIndex(C,y)}return(0!=p||0!=m)&&this._scrollPane.changeContentSizeOnScrolling(p,0,m,0),a>0&&this.numChildren>0&&this._container.x<0&&this.getChildAt(0).x>-this._container.x?!0:!1},r.handleScroll3=function(t){var e=this._scrollPane.scrollingPosX;fairygui.GList.pos_param=e;var i=this.getIndexOnPos3(t);if(e=fairygui.GList.pos_param,i!=this._firstIndex||t){var s=this._firstIndex;this._firstIndex=i;var n,h,r=s,o=this._virtualItems.length,a=this._curLineItemCount*this._curLineItemCount2,l=i%this._curLineItemCount,u=this.viewWidth,_=Math.floor(i/a),c=_*a,d=c+2*a,f=!1,g=0,p=0,m=this._defaultItem,v=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount,y=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount2-1))/this._curLineItemCount2;for(this.itemInfoVer++,g=c;d>g;g++)if(!(g>=this._realNumItems)){if(p=g%this._curLineItemCount,a>g-c){if(l>p)continue}else if(p>l)continue;n=this._virtualItems[g],n.updateFlag=this.itemInfoVer}var w=null,b=0;for(g=c;d>g;g++)if(!(g>=this._realNumItems)&&(n=this._virtualItems[g],n.updateFlag==this.itemInfoVer)){if(null==n.obj){for(;o>r;){if(h=this._virtualItems[r],null!=h.obj&&h.updateFlag!=this.itemInfoVer){h.obj instanceof fairygui.GButton&&(h.selected=h.obj.selected),n.obj=h.obj,h.obj=null;break}r++}-1==b&&(b=this.getChildIndex(w)+1),null==n.obj?(null!=this.itemProvider&&(m=this.itemProvider.runWith(g%this._numItems),null==m&&(m=this._defaultItem),m=$.normalizeURL(m)),n.obj=this._pool.getObject(m),this.addChildAt(n.obj,b)):b=this.setChildIndexBefore(n.obj,b),b++,n.obj instanceof fairygui.GButton&&(n.obj.selected=n.selected),f=!0}else f=t,b=-1,w=n.obj;f&&(this._autoResizeItem&&(this._curLineItemCount==this._columnCount&&this._curLineItemCount2==this._lineCount?n.obj.setSize(v,y,!0):this._curLineItemCount==this._columnCount?n.obj.setSize(v,n.obj.height,!0):this._curLineItemCount2==this._lineCount&&n.obj.setSize(n.obj.width,y,!0)),this.itemRenderer.runWith([g%this._numItems,n.obj]),n.width=Math.ceil(n.obj.width),n.height=Math.ceil(n.obj.height))}var C=c/a*u,x=C,S=0,I=0;for(g=c;d>g;g++)g>=this._realNumItems||(n=this._virtualItems[g],n.updateFlag==this.itemInfoVer&&n.obj.setXY(x,S),n.height>I&&(I=n.height),g%this._curLineItemCount==this._curLineItemCount-1?(x=C,S+=I+this._lineGap,I=0,g==c+a-1&&(C+=u,x=C,S=0)):x+=n.width+this._columnGap);for(g=r;o>g;g++)n=this._virtualItems[g],n.updateFlag!=this.itemInfoVer&&null!=n.obj&&(n.obj instanceof fairygui.GButton&&(n.selected=n.obj.selected),this.removeChildToPool(n.obj),n.obj=null)}},r.handleArchOrder1=function(){if(2==this.childrenRenderOrder){for(var t=this._scrollPane.posY+this.viewHeight/2,e=Number.POSITIVE_INFINITY,i=0,s=0,n=this.numChildren,h=0;n>h;h++){var r=this.getChildAt(h);(!this.foldInvisibleItems||r.visible)&&(i=Math.abs(t-r.y-r.height/2),e>i&&(e=i,s=h))}this.apexIndex=s}},r.handleArchOrder2=function(){if(2==this.childrenRenderOrder){for(var t=this._scrollPane.posX+this.viewWidth/2,e=Number.POSITIVE_INFINITY,i=0,s=0,n=this.numChildren,h=0;n>h;h++){var r=this.getChildAt(h);(!this.foldInvisibleItems||r.visible)&&(i=Math.abs(t-r.x-r.width/2),e>i&&(e=i,s=h))}this.apexIndex=s}},r.handleAlign=function(t,e){var i=0,s=0;e<this.viewHeight&&("middle"==this._verticalAlign?s=Math.floor((this.viewHeight-e)/2):"bottom"==this._verticalAlign&&(s=this.viewHeight-e)),t<this.viewWidth&&("center"==this._align?i=Math.floor((this.viewWidth-t)/2):"right"==this._align&&(i=this.viewWidth-t)),(i!=this._alignOffset.x||s!=this._alignOffset.y)&&(this._alignOffset.setTo(i,s),null!=this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.pos(this._margin.left+this._alignOffset.x,this._margin.top+this._alignOffset.y))},r.updateBounds=function(){if(!this._virtual){var t,e=0,i=0,s=0,n=0,h=0,r=0,o=0,a=0,l=0,u=0,_=this._children.length,c=this.viewWidth,d=this.viewHeight,f=0,g=0,p=0/0;if(0==this._layout){for(e=0;_>e;e++)t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0!=s&&(s+=this._lineGap),t.y=s,this._autoResizeItem&&t.setSize(c,t.height,!0),s+=Math.ceil(t.height),t.width>n&&(n=t.width));r=Math.ceil(n),o=s}else if(1==this._layout){for(e=0;_>e;e++)t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0!=i&&(i+=this._columnGap),t.x=i,this._autoResizeItem&&t.setSize(t.width,d,!0),i+=Math.ceil(t.width),t.height>h&&(h=t.height));r=i,o=Math.ceil(h)}else if(2==this._layout)if(this._autoResizeItem&&this._columnCount>0){for(e=0;_>e;e++)if(t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(f+=t.sourceWidth,a++,a==this._columnCount||e==_-1)){for(p=(c-f-(a-1)*this._columnGap)/f,i=0,a=g;e>=a;a++)t=this.getChildAt(a),(!this.foldInvisibleItems||t.visible)&&(t.setXY(i,s),e>a?(t.setSize(t.sourceWidth+Math.round(t.sourceWidth*p),t.height,!0),i+=Math.ceil(t.width)+this._columnGap):t.setSize(c-i,t.height,!0),t.height>h&&(h=t.height));s+=Math.ceil(h)+this._lineGap,h=0,a=0,g=e+1,f=0}o=s+Math.ceil(h),r=c}else{for(e=0;_>e;e++)t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0!=i&&(i+=this._columnGap),(0!=this._columnCount&&a>=this._columnCount||0==this._columnCount&&i+t.width>c&&0!=h)&&(i=0,s+=Math.ceil(h)+this._lineGap,h=0,a=0),t.setXY(i,s),i+=Math.ceil(t.width),i>n&&(n=i),t.height>h&&(h=t.height),a++);o=s+Math.ceil(h),r=Math.ceil(n)}else if(3==this._layout)if(this._autoResizeItem&&this._lineCount>0){for(e=0;_>e;e++)if(t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(f+=t.sourceHeight,a++,a==this._lineCount||e==_-1)){for(p=(d-f-(a-1)*this._lineGap)/f,s=0,a=g;e>=a;a++)t=this.getChildAt(a),(!this.foldInvisibleItems||t.visible)&&(t.setXY(i,s),e>a?(t.setSize(t.width,t.sourceHeight+Math.round(t.sourceHeight*p),!0),s+=Math.ceil(t.height)+this._lineGap):t.setSize(t.width,d-s,!0),t.width>n&&(n=t.width));i+=Math.ceil(n)+this._columnGap,n=0,a=0,g=e+1,f=0}r=i+Math.ceil(n),o=d}else{for(e=0;_>e;e++)t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0!=s&&(s+=this._lineGap),(0!=this._lineCount&&a>=this._lineCount||0==this._lineCount&&s+t.height>d&&0!=n)&&(s=0,i+=Math.ceil(n)+this._columnGap,n=0,a=0),t.setXY(i,s),s+=Math.ceil(t.height),s>h&&(h=s),t.width>n&&(n=t.width),a++);r=i+Math.ceil(n),o=Math.ceil(h)}else{var m=0;if(this._autoResizeItem&&this._lineCount>0&&(m=Math.floor((d-(this._lineCount-1)*this._lineGap)/this._lineCount)),this._autoResizeItem&&this._columnCount>0){for(e=0;_>e;e++)if(t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0==a&&(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&s+t.height>d)&&(l++,s=0,u=0),f+=t.sourceWidth,a++,a==this._columnCount||e==_-1)){for(p=(c-f-(a-1)*this._columnGap)/f,i=0,a=g;e>=a;a++)t=this.getChildAt(a),(!this.foldInvisibleItems||t.visible)&&(t.setXY(l*c+i,s),e>a?(t.setSize(t.sourceWidth+Math.round(t.sourceWidth*p),this._lineCount>0?m:t.height,!0),i+=Math.ceil(t.width)+this._columnGap):t.setSize(c-i,this._lineCount>0?m:t.height,!0),t.height>h&&(h=t.height));s+=Math.ceil(h)+this._lineGap,h=0,a=0,g=e+1,f=0,u++}}else for(e=0;_>e;e++)t=this.getChildAt(e),(!this.foldInvisibleItems||t.visible)&&(0!=i&&(i+=this._columnGap),this._autoResizeItem&&this._lineCount>0&&t.setSize(t.width,m,!0),(0!=this._columnCount&&a>=this._columnCount||0==this._columnCount&&i+t.width>c&&0!=h)&&(i=0,s+=Math.ceil(h)+this._lineGap,h=0,a=0,u++,(0!=this._lineCount&&u>=this._lineCount||0==this._lineCount&&s+t.height>d&&0!=n)&&(l++,s=0,u=0)),t.setXY(l*c+i,s),i+=Math.ceil(t.width),i>n&&(n=i),t.height>h&&(h=t.height),a++);o=l>0?d:s+Math.ceil(h),r=(l+1)*c}this.handleAlign(r,o),this.setBounds(0,0,r,o)}},r.setup_beforeAdd=function(t,e){fairygui.GObject.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5);var i,s=0,n=0,h=0,r=0,o=0;this._layout=t.readByte(),this._selectionMode=t.readByte(),r=t.readByte(),this._align=0==r?"left":1==r?"center":"right",r=t.readByte(),this._verticalAlign=0==r?"top":1==r?"middle":"bottom",this._lineGap=t.getInt16(),this._columnGap=t.getInt16(),this._lineCount=t.getInt16(),this._columnCount=t.getInt16(),this._autoResizeItem=t.readBool(),this._childrenRenderOrder=t.readByte(),this._apexIndex=t.getInt16(),t.readBool()&&(this._margin.top=t.getInt32(),this._margin.bottom=t.getInt32(),this._margin.left=t.getInt32(),this._margin.right=t.getInt32());var a=t.readByte();if(2==a){var l=t.pos;t.seek(e,7),this.setupScroll(t),t.pos=l}else this.setupOverflow(a);t.readBool()&&t.skip(8),t.seek(e,8),this._defaultItem=t.readS();var u=t.getInt16();for(s=0;u>s;s++)if(o=t.getInt16(),o+=t.pos,i=t.readS(),null!=i||(i=this.defaultItem)){var _=this.getFromPool(i);if(null!=_&&(this.addChild(_),i=t.readS(),null!=i&&(_.text=i),i=t.readS(),null!=i&&_ instanceof fairygui.GButton&&(_.selectedTitle=i),i=t.readS(),null!=i&&(_.icon=i),i=t.readS(),null!=i&&_ instanceof fairygui.GButton&&(_.selectedIcon=i),i=t.readS(),null!=i&&(_.name=i),_ instanceof fairygui.GComponent))for(h=t.getInt16(),n=0;h>n;n++){var c=_.getController(t.readS());i=t.readS(),null!=c&&(c.selectedPageId=i)}t.pos=o}else t.pos=o},r.setup_afterAdd=function(e,i){t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6);var s=e.getInt16();-1!=s&&(this._selectionController=this.parent.getControllerAt(s))},h(0,r,"layout",function(){return this._layout},function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"lineCount",function(){return this._lineCount},function(t){this._lineCount!=t&&(this._lineCount=t,(3==this._layout||4==this._layout)&&(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)))}),h(0,r,"columnCount",function(){return this._columnCount},function(t){this._columnCount!=t&&(this._columnCount=t,(2==this._layout||4==this._layout)&&(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)))}),h(0,r,"lineGap",function(){return this._lineGap},function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"columnGap",function(){return this._columnGap},function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"verticalAlign",function(){return this._verticalAlign},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"virtualItemSize",function(){return this._itemSize},function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new m),this._itemSize.setTo(t.x,t.y),this.setVirtualListChangedFlag(!0))}),h(0,r,"defaultItem",function(){return this._defaultItem},function(t){this._defaultItem=t}),h(0,r,"autoResizeItem",function(){return this._autoResizeItem},function(t){this._autoResizeItem!=t&&(this._autoResizeItem=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),h(0,r,"selectionMode",function(){return this._selectionMode},function(t){this._selectionMode=t}),h(0,r,"selectionController",function(){return this._selectionController},function(t){this._selectionController=t}),h(0,r,"itemPool",function(){return this._pool}),h(0,r,"selectedIndex",function(){var t=0;if(this._virtual)for(t=0;t<this._realNumItems;t++){var e=this._virtualItems[t];if(e.obj instanceof fairygui.GButton&&e.obj.selected||null==e.obj&&e.selected)return this._loop?t%this._numItems:t}else{var i=this._children.length;for(t=0;i>t;t++){var s=this._children[t].asButton;if(null!=s&&s.selected)return t}}return-1},function(t){t>=0&&t<this.numItems?(0!=this._selectionMode&&this.clearSelection(),this.addSelection(t)):this.clearSelection()}),h(0,r,"numItems",function(){return this._virtual?this._numItems:this._children.length},function(t){var e=0;if(this._virtual){if(null==this.itemRenderer)throw new Error("Set itemRenderer first!");this._numItems=t,this._realNumItems=this._loop?6*this._numItems:this._numItems;var n=this._virtualItems.length;if(this._realNumItems>n)for(e=n;e<this._realNumItems;e++){var h=new s;h.width=this._itemSize.x,h.height=this._itemSize.y,this._virtualItems.push(h)}else for(e=this._realNumItems;n>e;e++)this._virtualItems[e].selected=!1;0!=this._virtualListChanged&&i.timer.clear(this,this._refreshVirtualList),this._refreshVirtualList()}else{var r=this._children.length;if(t>r)for(e=r;t>e;e++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.runWith(e));else this.removeChildrenToPool(t,r);if(null!=this.itemRenderer)for(e=0;t>e;e++)this.itemRenderer.runWith([e,this.getChildAt(e)])}}),e.pos_param=0/0,e.__init$=function(){s=function(){function t(){this.width=0,this.height=0,this.obj=null,this.updateFlag=0,this.selected=!1}return n(t,""),t}()},e}(oe),Pe=function(t){function e(){this._titleObject=null,this._iconObject=null,e.__super.call(this)}n(e,"fairygui.GLabel",t);var s=e.prototype;return i.imps(s,{"fairygui.gears.IColorGear":!0}),s.getTextField=function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject:this._titleObject instanceof fairygui.GLabel?this._titleObject.getTextField():this._titleObject instanceof fairygui.GButton?this._titleObject.getTextField():null},s.constructExtension=function(){this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},s.setup_afterAdd=function(e,i){if(t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6)&&e.readByte()==this.packageItem.objectType){var s;s=e.readS(),null!=s&&(this.title=s),s=e.readS(),null!=s&&(this.icon=s),e.readBool()&&(this.titleColor=e.readColorS());var n=e.getInt32();if(0!=n&&(this.titleFontSize=n),e.readBool()){var h=this.getTextField();null!=h?(s=e.readS(),null!=s&&(h.promptText=s),s=e.readS(),null!=s&&(h.restrict=s),n=e.getInt32(),0!=n&&(h.maxLength=n),n=e.getInt32(),0!=n&&(4==n?h.keyboardType="number":3==n&&(h.keyboardType="url")),e.readBool()&&(h.password=!0)):e.skip(13)}}},h(0,s,"color",function(){return this.titleColor},function(t){this.titleColor=t}),h(0,s,"icon",function(){return null!=this._iconObject?this._iconObject.icon:null},function(t){null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),h(0,s,"editable",function(){return this._titleObject&&this._titleObject instanceof fairygui.GTextInput?this._titleObject.asTextInput.editable:!1},function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)}),h(0,s,"title",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),h(0,s,"text",function(){return this.title},function(t){this.title=t}),h(0,s,"titleColor",function(){var t=this.getTextField();return null!=t?t.color:"#000000"},function(t){var e=this.getTextField();null!=e&&(e.color=t),this.updateGear(4)}),h(0,s,"titleFontSize",function(){var t=this.getTextField();return null!=t?t.fontSize:0},function(t){var e=this.getTextField();null!=e&&(e.fontSize=t)}),e}(oe),Oe=function(t){function e(){this._max=0,this._value=0,this._titleType=0,this._reverse=!1,this._titleObject=null,this._aniObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._barStartX=0,this._barStartY=0,e.__super.call(this),this._titleType=0,this._value=50,this._max=100}n(e,"fairygui.GProgressBar",t);var i=e.prototype;return i.tweenValue=function(t,e){var i=0/0,s=T.getTween(this,this.update);return null!=s?(i=s.value.x,s.kill()):i=this._value,this._value=t,T.to(i,this._value,e).setTarget(this,this.update).setEase(0)},i.update=function(t){var e=0!=this._max?Math.min(t/this._max,1):0;if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*e)+"%";break;case 1:this._titleObject.text=Math.round(t)+"/"+Math.round(this._max);break;case 2:this._titleObject.text=""+Math.round(t);break;case 3:this._titleObject.text=""+Math.round(this._max)}var i=this.width-this._barMaxWidthDelta,s=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH instanceof fairygui.GImage&&0!=this._barObjectH.fillMethod?this._barObjectH.fillAmount=1-e:(this._barObjectH.width=Math.round(i*e),this._barObjectH.x=this._barStartX+(i-this._barObjectH.width))),this._barObjectV&&(this._barObjectV instanceof fairygui.GImage&&0!=this._barObjectV.fillMethod?this._barObjectV.fillAmount=1-e:(this._barObjectV.height=Math.round(s*e),this._barObjectV.y=this._barStartY+(s-this._barObjectV.height)))):(this._barObjectH&&(this._barObjectH instanceof fairygui.GImage&&0!=this._barObjectH.fillMethod?this._barObjectH.fillAmount=e:this._barObjectH.width=Math.round(i*e)),this._barObjectV&&(this._barObjectV instanceof fairygui.GImage&&0!=this._barObjectV.fillMethod?this._barObjectV.fillAmount=e:this._barObjectV.height=Math.round(s*e))),this._aniObject instanceof fairygui.GMovieClip&&(this._aniObject.frame=Math.round(100*e))},i.constructExtension=function(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},i.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},i.setup_afterAdd=function(e,i){return t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6)?e.readByte()!=this.packageItem.objectType?(this.update(this._value),void 0):(this._value=e.getInt32(),this._max=e.getInt32(),this.update(this._value),void 0):(this.update(this._value),void 0)},h(0,i,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update(this._value))}),h(0,i,"titleType",function(){return this._titleType},function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))}),h(0,i,"value",function(){return this._value},function(t){this._value!=t&&(T.kill(this,!1,this.update),this._value=t,this.update(this._value))}),e}(oe),Te=function(t){function e(){this._grip=null,this._arrowButton1=null,this._arrowButton2=null,this._bar=null,this._target=null,this._vertical=!1,this._scrollPerc=0,this._fixedGripSize=!1,this._dragOffset=null,e.__super.call(this),this._dragOffset=new laya.maths.Point,this._scrollPerc=0}n(e,"fairygui.GScrollBar",t);var r=e.prototype;return r.setScrollPane=function(t,e){this._target=t,this._vertical=e},r.constructExtension=function(t){return t.seek(0,6),this._fixedGripSize=t.readBool(),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.on("mousedown",this,this.__gripMouseDown),this._arrowButton1&&this._arrowButton1.on("mousedown",this,this.__arrowButton1Click),this._arrowButton2&&this._arrowButton2.on("mousedown",this,this.__arrowButton2Click),this.on("mousedown",this,this.__barMouseDown),void 0):(p.print("需要定义bar"),void 0)):(p.print("需要定义grip"),void 0)},r.__gripMouseDown=function(t){this._bar&&(t.stopPropagation(),i.stage.on("mousemove",this,this.__gripMouseMove),i.stage.on("mouseup",this,this.__gripMouseUp),this.globalToLocal(i.stage.mouseX,i.stage.mouseY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y)},r.__gripMouseMove=function(){var t=this.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);if(this._vertical){var e=t.y-this._dragOffset.y;this._target.setPercY((e-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var s=t.x-this._dragOffset.x;this._target.setPercX((s-this._bar.x)/(this._bar.width-this._grip.width),!1)}},r.__gripMouseUp=function(){this._bar&&(i.stage.off("mousemove",this,this.__gripMouseMove),i.stage.off("mouseup",this,this.__gripMouseUp))},r.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},r.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},r.__barMouseDown=function(){var t=this._grip.globalToLocal(i.stage.mouseX,i.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);this._vertical?t.y<0?this._target.scrollUp(4):this._target.scrollDown(4):t.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},h(0,r,"displayPerc",null,function(t){this._vertical?(this._fixedGripSize||(this._grip.height=t*this._bar.height),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=t*this._bar.width),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc)}),h(0,r,"scrollPerc",null,function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc}),h(0,r,"minSize",function(){return this._vertical?(null!=this._arrowButton1?this._arrowButton1.height:0)+(null!=this._arrowButton2?this._arrowButton2.height:0):(null!=this._arrowButton1?this._arrowButton1.width:0)+(null!=this._arrowButton2?this._arrowButton2.width:0)}),s(e,["sScrollbarHelperPoint",function(){return this.sScrollbarHelperPoint=new m}]),e}(oe),je=(function(t){function e(){this._contentPane=null,this._modalWaitPane=null,this._closeButton=null,this._dragArea=null,this._contentArea=null,this._frame=null,this._modal=!1,this._uiSources=null,this._inited=!1,this._loading=!1,this._requestingCmd=0,this.bringToFontOnClick=!1,e.__super.call(this),this.focusable=!0,this._uiSources=[],this.bringToFontOnClick=ie.bringWindowToFrontOnClick,this.displayObject.on("display",this,this.__onShown),this.displayObject.on("undisplay",this,this.__onHidden),this.displayObject.on("mousedown",this,this.__mouseDown)}n(e,"fairygui.Window",t,"Window$2");var i=e.prototype;return i.addUISource=function(t){this._uiSources.push(t)},i.show=function(){je.inst.showWindow(this)},i.showOn=function(t){t.showWindow(this)},i.hide=function(){this.isShowing&&this.doHideAnimation()},i.hideImmediately=function(){var t=this.parent instanceof fairygui.GRoot?this.parent:null;t||(t=je.inst),t.hideWindowImmediately(this)},i.centerOn=function(t,e){void 0===e&&(e=!1),this.setXY(Math.round((t.width-this.width)/2),Math.round((t.height-this.height)/2)),e&&(this.addRelation(t,3),this.addRelation(t,10))},i.toggleStatus=function(){this.isTop?this.hide():this.show()},i.bringToFront=function(){this.root.bringToFront(this)},i.showModalWait=function(t){void 0===t&&(t=0),0!=t&&(this._requestingCmd=t),ie.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=$.createObjectFromURL(ie.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},i.layoutModalWaitPane=function(){if(null!=this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},i.closeModalWait=function(t){return void 0===t&&(t=0),0!=t&&this._requestingCmd!=t?!1:(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},i.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},i.onInit=function(){},i.onShown=function(){},i.onHide=function(){},i.doShowAnimation=function(){this.onShown()},i.doHideAnimation=function(){this.hideImmediately()},i.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;t>e;e++){var i=this._uiSources[e];if(!i.loaded)return}this._loading=!1,this._init()},i._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},i.dispose=function(){null!=this.parent&&this.hideImmediately(),t.prototype.dispose.call(this)},i.closeEventHandler=function(){this.hide()},i.__onShown=function(){this._inited?this.doShowAnimation():this.init()},i.__onHidden=function(){this.closeModalWait(),this.onHide()},i.__mouseDown=function(){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},i.__dragStart=function(t){P.cast(t.currentTarget).stopDrag(),this.startDrag()},h(0,i,"contentPane",function(){return this._contentPane},function(t){this._contentPane!=t&&(null!=this._contentPane&&this.removeChild(this._contentPane),this._contentPane=t,null!=this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,24),this._frame=this._contentPane.getChild("frame"),null!=this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))
}),h(0,i,"isShowing",function(){return null!=this.parent}),h(0,i,"isTop",function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}),h(0,i,"modal",function(){return this._modal},function(t){this._modal=t}),h(0,i,"dragArea",function(){return this._dragArea},function(t){this._dragArea!=t&&(null!=this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.off("fui_drag_start",this,this.__dragStart)),this._dragArea=t,null!=this._dragArea&&(this._dragArea instanceof fairygui.GGraph&&this._dragArea.asGraph.drawRect(0,null,null),this._dragArea.draggable=!0,this._dragArea.on("fui_drag_start",this,this.__dragStart)))}),h(0,i,"frame",function(){return this._frame}),h(0,i,"closeButton",function(){return this._closeButton},function(t){null!=this._closeButton&&this._closeButton.offClick(this,this.closeEventHandler),this._closeButton=t,null!=this._closeButton&&this._closeButton.onClick(this,this.closeEventHandler)}),h(0,i,"contentArea",function(){return this._contentArea},function(t){this._contentArea=t}),h(0,i,"modalWaiting",function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent}),e}(oe),function(t){function e(){this._modalLayer=null,this._popupStack=null,this._justClosedPopups=null,this._modalWaitPane=null,this._focusedObject=null,this._tooltipWin=null,this._defaultTooltipWin=null,this._checkPopups=!1,e.__super.call(this),null==fairygui.GRoot._inst&&(fairygui.GRoot._inst=this),this.opaque=!1,this._popupStack=[],this._justClosedPopups=[],this.displayObject.once("display",this,this.__addedToStage)}n(e,"fairygui.GRoot",t);var s=e.prototype;return s.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},s.hideWindow=function(t){t.hide()},s.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},s.bringToFront=function(t){var e=this.numChildren,i=0/0;for(i=null==this._modalLayer.parent||t.modal?e-1:this.getChildIndex(this._modalLayer)-1;i>=0;i--){var s=this.getChildAt(i);if(s==t)return;if(s instanceof fairygui.Window)break}i>=0&&this.setChildIndex(t,i)},s.showModalWait=function(t){null!=ie.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=$.createObjectFromURL(ie.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,24),this.addChild(this._modalWaitPane),this._modalWaitPane.text=t)},s.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},s.closeAllExceptModals=function(){for(var t=this._children.slice(),e=t.length,i=0;e>i;i++){var s=t[i];s instanceof fairygui.Window&&!s.modal&&s.hide()}},s.closeAllWindows=function(){for(var t=this._children.slice(),e=t.length,i=0;e>i;i++){var s=t[i];s instanceof fairygui.Window&&s.hide()}},s.getTopWindow=function(){for(var t=this.numChildren,e=t-1;e>=0;e--){var i=this.getChildAt(e);if(i instanceof fairygui.Window)return i}return null},s.showPopup=function(t,e,s){if(this._popupStack.length>0){var n=this._popupStack.indexOf(t);if(-1!=n)for(var h=this._popupStack.length-1;h>=n;h--)this.removeChild(this._popupStack.pop())}if(this._popupStack.push(t),null!=e)for(var r=e;null!=r;){if(r.parent==this){t.sortingOrder<r.sortingOrder&&(t.sortingOrder=r.sortingOrder);break}r=r.parent}this.addChild(t),this.adjustModalLayer();var o,a=0,l=0;e?(o=e.localToGlobal(),a=e.width,l=e.height):o=this.globalToLocal(i.stage.mouseX,i.stage.mouseY);var u=0/0,_=0/0;u=o.x,u+t.width>this.width&&(u=u+a-t.width),_=o.y+l,(null==s&&_+t.height>this.height||0==s)&&(_=o.y-t.height-1,0>_&&(_=0,u+=a/2)),t.x=u,t.y=_},s.togglePopup=function(t,e,i){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},s.hidePopup=function(t){if(null!=t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;i>=e;i--)this.closePopup(this._popupStack.pop())}else{var s=this._popupStack.length;for(i=s-1;i>=0;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},s.closePopup=function(t){null!=t.parent&&(t instanceof fairygui.Window?t.hide():this.removeChild(t))},s.showTooltips=function(t){if(null==this._defaultTooltipWin){var e=ie.tooltipsWin;if(!e)return p.print("UIConfig.tooltipsWin not defined"),void 0;this._defaultTooltipWin=$.createObjectFromURL(e)}this._defaultTooltipWin.text=t,this.showTooltipsWin(this._defaultTooltipWin)},s.showTooltipsWin=function(t,e){this.hideTooltips(),this._tooltipWin=t;var s=0,n=0;null==e?(s=i.stage.mouseX+10,n=i.stage.mouseY+20):(s=e.x,n=e.y);var h=this.globalToLocal(s,n);s=h.x,n=h.y,s+this._tooltipWin.width>this.width&&(s=s-this._tooltipWin.width-1,0>s&&(s=10)),n+this._tooltipWin.height>this.height&&(n=n-this._tooltipWin.height-1,s-this._tooltipWin.width-1>0&&(s=s-this._tooltipWin.width-1),0>n&&(n=10)),this._tooltipWin.x=s,this._tooltipWin.y=n,this.addChild(this._tooltipWin)},s.hideTooltips=function(){null!=this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},s.getObjectUnderPoint=function(){return null},s.setFocus=function(t){this._focusedObject!=t&&(this._focusedObject=t,this.displayObject.event("fui_focus_changed"))},s.playOneShotSound=function(t,e){void 0===e&&(e=1),I.startsWith(t,"ui://")||w.playSound(t)},s.adjustModalLayer=function(){var t=this.numChildren;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,t-1);for(var e=t-1;e>=0;e--){var i=this.getChildAt(e);if(i instanceof fairygui.Window&&i.modal)return null==this._modalLayer.parent?this.addChildAt(this._modalLayer,e):this.setChildIndexBefore(this._modalLayer,e),void 0}null!=this._modalLayer.parent&&this.removeChild(this._modalLayer)},s.__addedToStage=function(){i.stage.on("mousedown",this,this.__stageMouseDown),i.stage.on("mouseup",this,this.__stageMouseUp),this._modalLayer=new _e,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,null,ie.modalLayerColor),this._modalLayer.addRelation(this,24),this.displayObject.stage.on("resize",this,this.__winResize),this.__winResize()},s.checkPopups=function(t){if(!this._checkPopups&&(this._checkPopups=!0,this._justClosedPopups.length=0,this._popupStack.length>0)){for(var e=t;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var i=this._popupStack.indexOf(e.$owner);if(-1!=i){for(var s=this._popupStack.length-1;s>i;s--){var n=this._popupStack.pop();this.closePopup(n),this._justClosedPopups.push(n)}return}}e=e.parent}var h=this._popupStack.length;for(s=h-1;s>=0;s--)n=this._popupStack[s],this.closePopup(n),this._justClosedPopups.push(n);this._popupStack.length=0}},s.__stageMouseDown=function(t){for(var e=t.target;e!=this.displayObject.stage&&null!=e;){if(e.$owner){var i=e.$owner;if(i.touchable&&i.focusable){this.setFocus(i);break}}e=e.parent}null!=this._tooltipWin&&this.hideTooltips(),this.checkPopups(t.target)},s.__stageMouseUp=function(){this._checkPopups=!1},s.__winResize=function(){this.setSize(i.stage.width,i.stage.height)},h(0,s,"focus",function(){return this._focusedObject&&!this._focusedObject.onStage&&(this._focusedObject=null),this._focusedObject},function(t){if(t&&(!t.focusable||!t.onStage))throw"invalid focus target";this.setFocus(t)}),h(0,s,"hasAnyPopup",function(){return 0!=this._popupStack.length}),h(0,s,"modalLayer",function(){return this._modalLayer}),h(0,s,"hasModalWindow",function(){return null!=this._modalLayer.parent}),h(0,s,"modalWaiting",function(){return this._modalWaitPane&&this._modalWaitPane.inContainer}),h(0,s,"volumeScale",function(){return w.soundVolume},function(t){w.soundVolume=t}),h(1,e,"inst",function(){return null==fairygui.GRoot._inst&&new e,fairygui.GRoot._inst},fairygui.GComponent._$SET_inst),e._inst=null,e}(oe)),ze=function(t){function e(){this.dropdown=null,this._titleObject=null,this._iconObject=null,this._list=null,this._items=null,this._icons=null,this._values=null,this._popupDirection=0,this._visibleItemCount=0,this._itemsUpdated=!1,this._selectedIndex=0,this._buttonController=null,this._selectionController=null,this._down=!1,this._over=!1,e.__super.call(this),this._visibleItemCount=ie.defaultComboBoxVisibleItemCount,this._itemsUpdated=!0,this._selectedIndex=-1,this._items=[],this._values=[]}n(e,"fairygui.GComboBox",t);var s=e.prototype;return s.getTextField=function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject:this._titleObject instanceof fairygui.GLabel?this._titleObject.getTextField():this._titleObject instanceof fairygui.GButton?this._titleObject.getTextField():null},s.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._selectionController==e&&(this.selectedIndex=e.selectedIndex)},s.updateSelectionController=function(){if(null!=this._selectionController&&!this._selectionController.changing&&this._selectedIndex<this._selectionController.pageCount){var t=this._selectionController;this._selectionController=null,t.selectedIndex=this._selectedIndex,this._selectionController=t}},s.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),this._selectionController=null,t.prototype.dispose.call(this)},s.constructExtension=function(t){var e;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),e=t.readS()){if(this.dropdown=$.createObjectFromURL(e),!this.dropdown)return p.print("下拉框必须为元件"),void 0;if(this.dropdown.name="this._dropdownObject",this._list=this.dropdown.getChild("list").asList,null==this._list)return p.print(this.resourceURL+": 下拉框的弹出元件里必须包含名为list的列表"),void 0;this._list.on("fui_click_item",this,this.__clickItem),this._list.addRelation(this.dropdown,14),this._list.removeRelation(this.dropdown,15),this.dropdown.addRelation(this._list,15),this.dropdown.removeRelation(this._list,14),this.dropdown.displayObject.on("undisplay",this,this.__popupWinClosed)}this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown)},s.setup_afterAdd=function(e,i){if(t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6)&&e.readByte()==this.packageItem.objectType){var s,n=0,h=0,r=0,o=e.getInt16();for(n=0;o>n;n++)r=e.getInt16(),r+=e.pos,this._items[n]=e.readS(),this._values[n]=e.readS(),s=e.readS(),null!=s&&(null==this._icons&&(this._icons=[]),this._icons[n]=s),e.pos=r;s=e.readS(),null!=s?(this.text=s,this._selectedIndex=this._items.indexOf(s)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,s=e.readS(),null!=s&&(this.icon=s),e.readBool()&&(this.titleColor=e.readColorS()),h=e.getInt32(),h>0&&(this._visibleItemCount=h),this._popupDirection=e.readByte(),h=e.getInt16(),h>=0&&(this._selectionController=this.parent.getControllerAt(h))}},s.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var t=this._items.length,e=0;t>e;e++){var i=this._list.addItemFromPool();i.name=e<this._values.length?this._values[e]:"",i.text=this._items[e],i.icon=null!=this._icons&&e<this._icons.length?this._icons[e]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width;var s=null;2==this._popupDirection?s=!0:1==this._popupDirection&&(s=!1),this.root.togglePopup(this.dropdown,this,s),this.dropdown.parent&&this.setState("down")},s.__popupWinClosed=function(){this._over?this.setState("over"):this.setState("up")},s.__clickItem=function(t,e){i.timer.callLater(this,this.__clickItem2,[this._list.getChildIndex(t),e])},s.__clickItem2=function(t,e){this.dropdown.parent instanceof fairygui.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=-1,this.selectedIndex=t,j.dispatch("fui_state_changed",this.displayObject,e)},s.__rollover=function(){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState("over")},s.__rollout=function(){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState("up")},s.__mousedown=function(t){t.target instanceof laya.display.Input||(this._down=!0,je.inst.checkPopups(t.target),i.stage.on("mouseup",this,this.__mouseup),this.dropdown&&this.showDropdown())},s.__mouseup=function(){this._down&&(this._down=!1,i.stage.off("mouseup",this,this.__mouseup),this.dropdown&&!this.dropdown.parent&&(this._over?this.setState("over"):this.setState("up")))},h(0,s,"text",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),h(0,s,"titleColor",function(){var t=this.getTextField();return null!=t?t.color:"#000000"},function(t){var e=this.getTextField();null!=e&&(e.color=t),this.updateGear(4)}),h(0,s,"titleFontSize",function(){var t=this.getTextField();return null!=t?t.fontSize:0},function(t){var e=this.getTextField();null!=e&&(e.fontSize=t)}),h(0,s,"icon",function(){return this._iconObject?this._iconObject.icon:null},function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),h(0,s,"icons",function(){return this._icons},function(t){this._icons=t,null!=this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])}),h(0,s,"selectionController",function(){return this._selectionController},function(t){this._selectionController=t}),h(0,s,"visibleItemCount",function(){return this._visibleItemCount},function(t){this._visibleItemCount=t}),h(0,s,"popupDirection",function(){return this._popupDirection},function(t){this._popupDirection=t}),h(0,s,"items",function(){return this._items},function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0}),h(0,s,"values",function(){return this._values},function(t){t?this._values=t.concat():this._values.length=0}),h(0,s,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._selectedIndex>=0&&this._selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null)),this.updateSelectionController())}),h(0,s,"value",function(){return this._values[this._selectedIndex]},function(t){this.selectedIndex=this._values.indexOf(t)}),e}(oe),Be=function(t){function e(){this.div=null,this._ubbEnabled=!1,this._color=null,e.__super.call(this),this._text=""}n(e,"fairygui.GRichTextField",t);var i=e.prototype;return i.createDisplayObject=function(){this._displayObject=this.div=new c,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},i.handleSizeChanged=function(){this.div.size(this.width,this.height),this.div.style.width=this.width,this.div.style.height=this.height},h(0,i,"bold",function(){return this.div.style.bold},function(t){this.div.style.bold=t}),h(0,i,"align",function(){return this.div.style.align},function(t){this.div.style.align=t}),h(0,i,"text",function(){return this._text},function(t){this._text=t;var e=this._text;null!=this._templateVars&&(e=this.parseTemplate(e)),this.div.innerHTML=this._ubbEnabled?I.parseUBB(e):e}),h(0,i,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.div.style.color=t,this._gearColor.controller&&this._gearColor.updateState())}),h(0,i,"font",function(){return this.div.style.font},function(t){this.div.style.font=t?t:ie.defaultFont}),h(0,i,"leading",function(){return this.div.style.leading},function(t){this.div.style.leading=t}),h(0,i,"fontSize",function(){return this.div.style.fontSize},function(t){this.div.style.fontSize=t}),h(0,i,"valign",function(){return this.div.style.valign},function(t){this.div.style.valign=t}),h(0,i,"italic",function(){return this.div.style.italic},function(t){this.div.style.italic=t}),h(0,i,"stroke",function(){return this.div.style.stroke},function(t){this.div.style.stroke=t}),h(0,i,"strokeColor",function(){return this.div.style.strokeColor},function(t){this.div.style.strokeColor=t,this.updateGear(4)}),h(0,i,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),e}(le),Me=function(t){function e(){this.input=null,e.__super.call(this)}n(e,"fairygui.GTextInput",t);var i=e.prototype;return i.createDisplayObject=function(){this._displayObject=this.input=new g,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},i.handleSizeChanged=function(){this.input.size(this.width,this.height)},i.setup_beforeAdd=function(e,i){t.prototype.setup_beforeAdd.call(this,e,i),e.seek(i,4);var s=e.readS();null!=s&&(this.promptText=s),s=e.readS(),null!=s&&(this.input.restrict=s);var n=e.getInt32();0!=n&&(this.input.maxChars=n),n=e.getInt32(),0!=n&&(4==n?this.keyboardType="number":3==n&&(this.keyboardType="url")),e.readBool()&&(this.password=!0)},h(0,i,"bold",function(){return this.input.bold},function(t){this.input.bold=t}),h(0,i,"align",function(){return this.input.align},function(t){this.input.align=t}),h(0,i,"text",function(){return this.input.text},function(t){this.input.text=t}),h(0,i,"password",function(){return"password"==this.input.type},function(t){this.input.type=t?"password":"text"}),h(0,i,"color",function(){return this.input.color},function(t){this.input.color=t}),h(0,i,"font",function(){return this.input.font},function(t){this.input.font=t}),h(0,i,"leading",function(){return this.input.leading},function(t){this.input.leading=t}),h(0,i,"maxLength",function(){return this.input.maxChars},function(t){this.input.maxChars=t}),h(0,i,"fontSize",function(){return this.input.fontSize},function(t){this.input.fontSize=t}),h(0,i,"valign",function(){return this.input.valign},function(t){this.input.valign=t}),h(0,i,"italic",function(){return this.input.italic},function(t){this.input.italic=t}),h(0,i,"singleLine",function(){return!this.input.multiline},function(t){this.input.multiline=!t}),h(0,i,"stroke",function(){return this.input.stroke},function(t){this.input.stroke=t}),h(0,i,"strokeColor",function(){return this.input.strokeColor},function(t){this.input.strokeColor=t,this.updateGear(4)}),h(0,i,"keyboardType",function(){return this.input.type},function(t){this.input.type=t}),h(0,i,"editable",function(){return this.input.editable},function(t){this.input.editable=t}),h(0,i,"promptText",function(){return this.input.prompt},function(t){this.input.prompt=t}),h(0,i,"restrict",function(){return this.input.restrict},function(t){this.input.restrict=t}),h(0,i,"textWidth",function(){return this.input.textWidth}),e}(le),Ae=function(t){function e(){this._titleObject=null,this._iconObject=null,this._relatedController=null,this._mode=0,this._selected=!1,this._title=null,this._selectedTitle=null,this._icon=null,this._selectedIcon=null,this._sound=null,this._soundVolumeScale=0,this._pageOption=null,this._buttonController=null,this._changeStateOnClick=!1,this._linkedPopup=null,this._downEffect=0,this._downEffectValue=0,this._downScaled=!1,this._down=!1,this._over=!1,e.__super.call(this),this._mode=0,this._title="",this._icon="",this._sound=ie.buttonSound,this._soundVolumeScale=ie.buttonSoundVolumeScale,this._pageOption=new D,this._changeStateOnClick=!0,this._downEffectValue=.8}n(e,"fairygui.GButton",t);var s=e.prototype;return s.getTextField=function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject:this._titleObject instanceof fairygui.GLabel?this._titleObject.getTextField():this._titleObject instanceof fairygui.GButton?this._titleObject.getTextField():null},s.fireClick=function(t){void 0===t&&(t=!0),t&&0==this._mode&&(this.setState("over"),i.timer.once(100,this,this.setState,["down"],!1),i.timer.once(200,this,this.setState,["up"],!1)),this.__click(j.createEvent("click",this.displayObject))},s.setState=function(t){if(this._buttonController&&(this._buttonController.selectedPage=t),1==this._downEffect){var e=this.numChildren;if("down"==t||"selectedOver"==t||"selectedDisabled"==t)for(var i=255*this._downEffectValue,s=S.toHexColor((i<<16)+(i<<8)+i),n=0;e>n;n++){var h=this.getChildAt(n);(h instanceof fairygui.GImage||h instanceof fairygui.GLoader||h instanceof fairygui.GMovieClip)&&(h.color=s)}else for(n=0;e>n;n++)h=this.getChildAt(n),(h instanceof fairygui.GImage||h instanceof fairygui.GLoader||h instanceof fairygui.GMovieClip)&&(h.color="#FFFFFF")}else 2==this._downEffect&&("down"==t||"selectedOver"==t||"selectedDisabled"==t?this._downScaled||(this.setScale(this.scaleX*this._downEffectValue,this.scaleY*this._downEffectValue),this._downScaled=!0):this._downScaled&&(this.setScale(this.scaleX/this._downEffectValue,this.scaleY/this._downEffectValue),this._downScaled=!1))},s.handleControllerChanged=function(e){t.prototype.handleControllerChanged.call(this,e),this._relatedController==e&&(this.selected=this._pageOption.id==e.selectedPageId)},s.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage("disabled")?this.grayed?this._selected&&this._buttonController.hasPage("selectedDisabled")?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState("down"):this.setState("up"):t.prototype.handleGrayedChanged.call(this)},s.constructExtension=function(t){t.seek(0,6),this._mode=t.readByte();var e=t.readS();e&&(this._sound=e),this._soundVolumeScale=t.getFloat32(),this._downEffect=t.readByte(),this._downEffectValue=t.getFloat32(),2==this._downEffect&&this.setPivot(.5,.5,this.pivotAsAnchor),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),null!=this._titleObject&&(this._title=this._titleObject.text),null!=this._iconObject&&(this._icon=this._iconObject.icon),0==this._mode&&this.setState("up"),this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown),this.on("click",this,this.__click)},s.setup_afterAdd=function(e,i){if(t.prototype.setup_afterAdd.call(this,e,i),e.seek(i,6)&&e.readByte()==this.packageItem.objectType){var s,n=0;s=e.readS(),null!=s&&(this.title=s),s=e.readS(),null!=s&&(this.selectedTitle=s),s=e.readS(),null!=s&&(this.icon=s),s=e.readS(),null!=s&&(this.selectedIcon=s),e.readBool()&&(this.titleColor=e.readColorS()),n=e.getInt32(),0!=n&&(this.titleFontSize=n),n=e.getInt16(),n>=0&&(this._relatedController=this.parent.getControllerAt(n)),this.pageOption.id=e.readS(),s=e.readS(),null!=s&&(this._sound=s),e.readBool()&&(this._soundVolumeScale=e.getFloat32()),this.selected=e.readBool()}},s.__rollover=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!0,this._down||this.grayed&&this._buttonController.hasPage("disabled")||this.setState(this._selected?"selectedOver":"over"))},s.__rollout=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!1,this._down||this.grayed&&this._buttonController.hasPage("disabled")||this.setState(this._selected?"down":"up"))},s.__mousedown=function(t){this._down=!0,je.inst.checkPopups(t.target),i.stage.on("mouseup",this,this.__mouseup),0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("selectedDisabled"):this.setState("down")),null!=this._linkedPopup&&(this._linkedPopup instanceof fairygui.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},s.__mouseup=function(){if(this._down){if(i.stage.off("mouseup",this,this.__mouseup),this._down=!1,null==this._displayObject)return;0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("disabled"):this._over?this.setState("over"):this.setState("up"))}},s.__click=function(t){if(this._sound){var e=$.getItemByURL(this._sound);e?je.inst.playOneShotSound(e.file):je.inst.playOneShotSound(this._sound)}1==this._mode?this._changeStateOnClick&&(this.selected=!this._selected,j.dispatch("fui_state_changed",this.displayObject,t)):2==this._mode?this._changeStateOnClick&&!this._selected&&(this.selected=!0,j.dispatch("fui_state_changed",this.displayObject,t)):this._relatedController&&(this._relatedController.selectedPageId=this._pageOption.id)},h(0,s,"relatedController",function(){return this._relatedController},function(t){t!=this._relatedController&&(this._relatedController=t,this._pageOption.controller=t,this._pageOption.clear())}),h(0,s,"icon",function(){return this._icon},function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),h(0,s,"titleFontSize",function(){var t=this.getTextField();return null!=t?t.fontSize:0},function(t){var e=this.getTextField();null!=e&&(e.fontSize=t)}),h(0,s,"selectedIcon",function(){return this._selectedIcon},function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t)}),h(0,s,"title",function(){return this._title},function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)}),h(0,s,"text",function(){return this.title},function(t){this.title=t}),h(0,s,"selectedTitle",function(){return this._selectedTitle},function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}),h(0,s,"soundVolumeScale",function(){return this._soundVolumeScale},function(t){this._soundVolumeScale=t}),h(0,s,"sound",function(){return this._sound},function(t){this._sound=t}),h(0,s,"titleColor",function(){var t=this.getTextField();return null!=t?t.color:"#000000"},function(t){var e=this.getTextField();null!=e&&(e.color=t),this.updateGear(4)}),h(0,s,"selected",function(){return this._selected},function(t){if(0!=this._mode&&this._selected!=t){if(this._selected=t,this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this._selected?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState(this._over?"selectedOver":"down"):this.setState(this._over?"over":"up"),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var e=this._selected?this._selectedIcon:this._icon;null!=this._iconObject&&(this._iconObject.icon=e)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._pageOption.id,this._relatedController.autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):1==this._mode&&this._relatedController.selectedPageId==this._pageOption.id&&(this._relatedController.oppositePageId=this._pageOption.id))}}),h(0,s,"mode",function(){return this._mode},function(t){this._mode!=t&&(0==t&&(this.selected=!1),this._mode=t)}),h(0,s,"pageOption",function(){return this._pageOption}),h(0,s,"changeStateOnClick",function(){return this._changeStateOnClick},function(t){this._changeStateOnClick=t}),h(0,s,"linkedPopup",function(){return this._linkedPopup},function(t){this._linkedPopup=t}),e.UP="up",e.DOWN="down",e.OVER="over",e.SELECTED_OVER="selectedOver",e.DISABLED="disabled",e.SELECTED_DISABLED="selectedDisabled",e}(oe),Le=function(t){function e(){this.textField=null,this._font=null,this._color=null,this._ubbEnabled=!1,this._singleLine=!1,this._letterSpacing=0,this._autoSize=0,this._widthAutoSize=!1,this._heightAutoSize=!1,this._updatingSize=!1,this._textWidth=0,this._textHeight=0,this._bitmapFont=null,this._lines=null,e.__super.call(this),this._text="",this._color="#000000",this.textField.align="left",this.textField.font=ie.defaultFont,this._autoSize=1,this._widthAutoSize=this._heightAutoSize=!0,this.textField._sizeDirty=!1}var s,r;n(e,"fairygui.GBasicTextField",t);var o=e.prototype;return o.createDisplayObject=function(){this._displayObject=this.textField=new r(this),this._displayObject.$owner=this,this._displayObject.mouseEnabled=!1},o.setAutoSize=function(t){this._autoSize=t,this._widthAutoSize=1==t,this._heightAutoSize=1==t||2==t,this.textField.wordWrap=!this._widthAutoSize&&!this._singleLine,this._underConstruct||(this._heightAutoSize?this._widthAutoSize||(this.textField.width=this.width):this.textField.size(this.width,this.height))},o.ensureSizeCorrect=function(){!this._underConstruct&&this.textField._isChanged&&this.textField.typeset()},o.typeset=function(){null!=this._bitmapFont?this.renderWithBitmapFont():(this._widthAutoSize||this._heightAutoSize)&&this.updateSize()},o.updateSize=function(){this._textWidth=Math.ceil(this.textField.textWidth),this._textHeight=Math.ceil(this.textField.textHeight);var t=0/0,e=0;this._widthAutoSize?(t=this._textWidth,this.textField.width!=t&&(this.textField.width=t,"left"!=this.textField.align&&this.textField.baseTypeset())):t=this.width,this._heightAutoSize?(e=this._textHeight,this._widthAutoSize||this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)):(e=this.height,this._textHeight>e&&(this._textHeight=e),this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)),this._updatingSize=!0,this.setSize(t,e),this._updatingSize=!1},o.renderWithBitmapFont=function(){var t=this._displayObject.graphics;t.clear(),this._lines?s.returnList(this._lines):this._lines=[];var e,i=this.letterSpacing,n=this.leading-1,h=this.width-4,r=0,o=0,a=0,l=0,u=0,_=0,c=0,d=0,f=0,g="",p=2,m=!this._widthAutoSize&&!this._singleLine,v=this.fontSize,y=this._bitmapFont.resizable?v/this._bitmapFont.size:1;this._textWidth=0,this._textHeight=0;var w=this._text;null!=this._templateVars&&(w=this.parseTemplate(w));for(var b=w.length,C=0;b>C;++C){var x=w.charAt(C),S=x.charCodeAt(0);if(10!=S){if(S>=65&&90>=S||S>=97&&122>=S?(0==_&&(c=r),_++):(_>0&&(d=r),_=0),32==S)l=Math.ceil(v/2),u=v;else{var k=this._bitmapFont.glyphs[x];k?(l=Math.ceil(k.advance*y),u=Math.ceil(k.lineHeight*y)):(l=0,u=0)}if(u>a&&(a=u),u>o&&(o=u),0!=r&&(r+=i),r+=l,!m||h>=r)g+=x;else{if(e=s.borrow(),e.height=o,e.textHeight=a,0==g.length)e.text=x;else if(_>0&&d>0){g+=x;var P=g.length-_;e.text=I.trimRight(g.substr(0,P)),e.width=d,g=g.substr(P),r-=c}else e.text=g,e.width=r-(l+i),g=x,r=l,o=u,a=u;e.y=p,p+=e.height+n,e.width>this._textWidth&&(this._textWidth=e.width),_=0,c=0,d=0,this._lines.push(e)}}else g+=x,e=s.borrow(),e.width=r,0==a&&(0==f&&(f=v),0==o&&(o=f),a=o),e.height=o,f=o,e.textHeight=a,e.text=g,e.y=p,p+=e.height+n,e.width>this._textWidth&&(this._textWidth=e.width),this._lines.push(e),g="",r=0,o=0,a=0,_=0,c=0,d=0}g.length>0&&(e=s.borrow(),e.width=r,0==o&&(o=f),0==a&&(a=o),e.height=o,e.textHeight=a,e.text=g,e.y=p,e.width>this._textWidth&&(this._textWidth=e.width),this._lines.push(e)),this._textWidth>0&&(this._textWidth+=4);var O=this._lines.length;0==O?this._textHeight=0:(e=this._lines[this._lines.length-1],this._textHeight=e.y+e.height+2);var T=0/0,j=0;if(T=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,j=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height,this._updatingSize=!0,this.setSize(T,j),this._updatingSize=!1,this.doAlign(),0!=T&&0!=j){var z=2,B=0,M=0;h=this.width-4;for(var A=this._lines.length,L=0;A>L;L++){e=this._lines[L],z=2,B="center"==this.align?(h-e.width)/2:"right"==this.align?h-e.width:0,b=e.text.length;for(var F=0;b>F;F++)x=e.text.charAt(F),S=x.charCodeAt(0),10!=S&&(32!=S?(k=this._bitmapFont.glyphs[x],null!=k?(M=(e.height+e.textHeight)/2-Math.ceil(k.lineHeight*y),k.texture&&t.drawTexture(k.texture,z+B+Math.ceil(k.offsetX*y),e.y+M+Math.ceil(k.offsetY*y),k.texture.width*y,k.texture.height*y),z+=i+Math.ceil(k.advance*y)):z+=i):z+=this._letterSpacing+Math.ceil(v/2))
}}},o.handleSizeChanged=function(){this._updatingSize||(this._underConstruct?this.textField.size(this.width,this.height):null!=this._bitmapFont?this._widthAutoSize?this.doAlign():this.textField.setChanged():this._widthAutoSize||(this._heightAutoSize?this.textField.width=this.width:this.textField.size(this.width,this.height)))},o.handleGrayedChanged=function(){fairygui.GObject.prototype.handleGrayedChanged.call(this),this.textField.color=this.grayed?"#AAAAAA":this._color},o.doAlign=function(){if("top"==this.valign||0==this._textHeight)this._yOffset=2;else{var t=this.height-this._textHeight;0>t&&(t=0),this._yOffset="middle"==this.valign?Math.floor(t/2):Math.floor(t)}this.handleXYChanged()},o.flushVars=function(){this.text=this._text},h(0,o,"bold",function(){return this.textField.bold},function(t){this.textField.bold=t}),h(0,o,"letterSpacing",function(){return this._letterSpacing},function(t){this._letterSpacing=t}),h(0,o,"align",function(){return this.textField.align},function(t){this.textField.align=t}),h(0,o,"text",function(){return this._text},function(t){if(this._text=t,null==this._text&&(this._text=""),null==this._bitmapFont){this._widthAutoSize&&(this.textField.width=1e4);var e=this._text;null!=this._templateVars&&(e=this.parseTemplate(e)),this.textField.text=this._ubbEnabled?I.removeUBB(I.encodeHTML(e)):e}else this.textField.text="",this.textField.setChanged();this.parent&&this.parent._underConstruct&&this.textField.typeset()}),h(0,o,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this._gearColor.controller&&this._gearColor.updateState(),this.textField.color=this.grayed?"#AAAAAA":this._color)}),h(0,o,"font",function(){return this.textField.font},function(t){this._font=t,this._bitmapFont=I.startsWith(this._font,"ui://")?$.getItemAssetByURL(this._font):null,null!=this._bitmapFont?this.textField.setChanged():this.textField.font=this._font?this._font:ie.defaultFont}),h(0,o,"leading",function(){return this.textField.leading},function(t){this.textField.leading=t}),h(0,o,"fontSize",function(){return this.textField.fontSize},function(t){this.textField.fontSize=t}),h(0,o,"valign",function(){return this.textField.valign},function(t){this.textField.valign=t}),h(0,o,"italic",function(){return this.textField.italic},function(t){this.textField.italic=t}),h(0,o,"underline",function(){return this.textField.underline},function(t){this.textField.underline=t}),h(0,o,"singleLine",function(){return this._singleLine},function(t){this._singleLine=t,this.textField.wordWrap=!this._widthAutoSize&&!this._singleLine}),h(0,o,"stroke",function(){return this.textField.stroke},function(t){this.textField.stroke=t}),h(0,o,"strokeColor",function(){return this.textField.strokeColor},function(t){this.textField.strokeColor=t,this.updateGear(4)}),h(0,o,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),h(0,o,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&this.setAutoSize(t)}),h(0,o,"textWidth",function(){return this.textField._isChanged&&this.textField.typeset(),this._textWidth}),e.GUTTER_X=2,e.GUTTER_Y=2,e.__init$=function(){s=function(){function t(){this.width=0,this.height=0,this.textHeight=0,this.text=null,this.y=0}return n(t,""),t.borrow=function(){if(t.pool.length){var e=t.pool.pop();return e.width=0,e.height=0,e.textHeight=0,e.text=null,e.y=0,e}return new t},t.returns=function(e){t.pool.push(e)},t.returnList=function(e){for(var i=e.length,s=0;i>s;s++){var n=e[s];t.pool.push(n)}e.length=0},t.pool=[],t}(),r=function(t){function e(t){this._owner=null,this._lock=!1,this._sizeDirty=!1,e.__super.call(this),this._owner=t}n(e,"",t);var s=e.prototype;return s.baseTypeset=function(){this._lock=!0,this.typeset(),this._lock=!1},s.typeset=function(){this._sizeDirty=!0,t.prototype.typeset.call(this),this._lock||this._owner.typeset(),this._isChanged&&(i.timer.clear(this,this.typeset),this._isChanged=!1),this._sizeDirty=!1},s.setChanged=function(){this.isChanged=!0},h(0,s,"isChanged",null,function(t){t&&!this._sizeDirty&&0!=this._owner.autoSize&&this._owner.parent&&(this._sizeDirty=!0,this.event("fui_size_delay_change")),i.superSet(C,this,"isChanged",t)}),e}(C)},e}(le),Fe=function(t){function e(){this._source=null,this._scaleByTile=!1,this._scale9Grid=null,this._tileGridIndice=0,this._needRebuild=0,this._fillMethod=0,this._fillOrigin=0,this._fillAmount=0,this._fillClockwise=!1,this._mask=null,this._color=null,e.__super.call(this),this.mouseEnabled=!1,this._color="#FFFFFF"}n(e,"fairygui.display.Image",t,"Image$1");var s=e.prototype;return s.markChanged=function(t){this._needRebuild?this._needRebuild|=t:(this._needRebuild=t,i.timer.callLater(this,this.rebuild))},s.rebuild=function(){0!=(1&this._needRebuild)&&this.doDraw(),0!=(2&this._needRebuild)&&0!=this._fillMethod&&this.doFill(),this._needRebuild=0},s.doDraw=function(){var t=this._width,e=this._height,i=this.graphics,s=this._source;if(i.clear(),null!=s&&0!=t&&0!=e)if(this._scaleByTile)i.fillTexture(s,0,0,t,e);else if(null!=this._scale9Grid){var n=s.width,h=s.height,r=this._scale9Grid.x,o=Math.max(n-this._scale9Grid.right,0),a=this._scale9Grid.y,l=Math.max(h-this._scale9Grid.bottom,0),u=0/0;e>=h-this._scale9Grid.height?(a=this._scale9Grid.y,l=h-this._scale9Grid.bottom):(u=this._scale9Grid.y/(h-this._scale9Grid.bottom),u=e*u/(1+u),a=Math.round(u),l=e-u),t>=n-this._scale9Grid.width?(r=this._scale9Grid.x,o=n-this._scale9Grid.right):(u=this._scale9Grid.x/(n-this._scale9Grid.right),u=t*u/(1+u),r=Math.round(u),o=t-u);var _=Math.max(t-r-o,0),c=Math.max(e-a-l,0);r&&a&&i.drawImage(fairygui.display.Image.getTexture(s,0,0,r,a),0,0,r,a),o&&a&&i.drawImage(fairygui.display.Image.getTexture(s,n-o,0,o,a),t-o,0,o,a),r&&l&&i.drawImage(fairygui.display.Image.getTexture(s,0,h-l,r,l),0,e-l,r,l),o&&l&&i.drawImage(fairygui.display.Image.getTexture(s,n-o,h-l,o,l),t-o,e-l,o,l),_&&a&&this.drawTexture(0,fairygui.display.Image.getTexture(s,r,0,n-r-o,a),r,0,_,a),_&&l&&this.drawTexture(1,fairygui.display.Image.getTexture(s,r,h-l,n-r-o,l),r,e-l,_,l),c&&r&&this.drawTexture(2,fairygui.display.Image.getTexture(s,0,a,r,h-a-l),0,a,r,c),c&&o&&this.drawTexture(3,fairygui.display.Image.getTexture(s,n-o,a,o,h-a-l),t-o,a,o,c),_&&c&&this.drawTexture(4,fairygui.display.Image.getTexture(s,r,a,n-r-o,h-a-l),r,a,_,c)}else i.drawImage(s,0,0,t,e)},s.drawTexture=function(t,e,i,s,n,h){void 0===n&&(n=0),void 0===h&&(h=0),-1==t||0==(this._tileGridIndice&1<<t)?this.graphics.drawImage(e,i,s,n,h):this.graphics.fillTexture(e,i,s,n,h)},s.doFill=function(){var t=this._width,e=this._height,i=this._mask.graphics;if(i.clear(),0!=t&&0!=e){var s=Z.fill(t,e,this._fillMethod,this._fillOrigin,this._fillClockwise,this._fillAmount);return null==s?(this.mask=null,this.mask=this._mask,void 0):(i.drawPoly(0,0,s,"#FFFFFF"),void 0)}},h(0,s,"width",t.prototype._$get_width,function(t){this._width!==t&&(i.superSet(b,this,"width",t),this.markChanged(1))}),h(0,s,"fillOrigin",function(){return this._fillOrigin},function(t){this._fillOrigin!=t&&(this._fillOrigin=t,0!=this._fillMethod&&this.markChanged(2))}),h(0,s,"height",t.prototype._$get_height,function(t){this._height!==t&&(i.superSet(b,this,"height",t),this.markChanged(1))}),h(0,s,"scaleByTile",function(){return this._scaleByTile},function(t){this._scaleByTile!=t&&(this._scaleByTile=t,this.markChanged(1))}),h(0,s,"texture",function(){return this._source},function(t){this._source!=t&&(this._source=t,0==this._width&&(this._source?this.size(this._source.width,this._source.height):this.size(0,0)),this.repaint(),this.markChanged(1))}),h(0,s,"scale9Grid",function(){return this._scale9Grid},function(t){this._scale9Grid=t,this.markChanged(1)}),h(0,s,"tileGridIndice",function(){return this._tileGridIndice},function(t){this._tileGridIndice!=t&&(this._tileGridIndice=t,this.markChanged(1))}),h(0,s,"fillMethod",function(){return this._fillMethod},function(t){this._fillMethod!=t&&(this._fillMethod=t,0!=this._fillMethod?(this._mask||(this._mask=new b,this._mask.mouseEnabled=!1),this.mask=this._mask,this.markChanged(2)):this.mask&&(this._mask.graphics.clear(),this.mask=null))}),h(0,s,"fillClockwise",function(){return this._fillClockwise},function(t){this._fillClockwise!=t&&(this._fillClockwise=t,0!=this._fillMethod&&this.markChanged(2))}),h(0,s,"fillAmount",function(){return this._fillAmount},function(t){this._fillAmount!=t&&(this._fillAmount=t,0!=this._fillMethod&&this.markChanged(2))}),h(0,s,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t)}),e.getTexture=function(t,e,i,s,n){0>=s&&(s=1),0>=n&&(n=1),t.$_GID||(t.$_GID=S.getGID());var h;return h&&h._getSource()||(h=x.createFromTexture(t,e,i,s,n)),h},e}(b),Ge=function(t){function e(){this.interval=0,this.swing=!1,this.repeatDelay=0,this.timeScale=1,this._playing=!0,this._frameCount=0,this._frames=null,this._frame=0,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this._endHandler=null,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,e.__super.call(this),this.mouseEnabled=!1,this.setPlaySettings(),this.on("display",this,this.__addToStage),this.on("undisplay",this,this.__removeFromStage)}n(e,"fairygui.display.MovieClip",t,"MovieClip$1");var s=e.prototype;return s.rewind=function(){this._frame=0,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this.drawFrame()},s.syncStatus=function(t){this._frame=t._frame,this._frameElapsed=t._frameElapsed,this._reversed=t._reversed,this._repeatedCount=t._repeatedCount,this.drawFrame()},s.advance=function(t){for(var e=this._frame,i=this._reversed,s=t;;){var n=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(n+=this.repeatDelay),n>t){this._frameElapsed=0;break}if(t-=n,this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),this._frame==e&&this._reversed==i){var h=s-t;t-=Math.floor(t/h)*h}}this.drawFrame()},s.setPlaySettings=function(t,e,i,s,n){void 0===t&&(t=0),void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=-1),this._start=t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=s,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._endHandler=n,this.frame=t},s.update=function(){if(this._playing&&0!=this._frameCount&&3!=this._status){var t=i.timer.delta;t>100&&(t=100),1!=this.timeScale&&(t*=this.timeScale),this._frameElapsed+=t;var e=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&this._repeatedCount>0&&(e+=this.repeatDelay),!(this._frameElapsed<e)){if(this._frameElapsed-=e,this._frameElapsed>this.interval&&(this._frameElapsed=this.interval),this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),1==this._status)this._frame=this._start,this._frameElapsed=0,this._status=0;else if(2==this._status){if(this._frame=this._endAt,this._frameElapsed=0,this._status=3,null!=this._endHandler){var s=this._endHandler;this._endHandler=null,s.run()}}else this._frame==this._end&&(this._times>0?(this._times--,this._status=0==this._times?2:1):0!=this._start&&(this._status=1));this.drawFrame()}}},s.drawFrame=function(){if(this._frameCount>0&&this._frame<this._frames.length){var t=this._frames[this._frame];this.texture=t.texture}else this.texture=null;this.rebuild()},s.checkTimer=function(){this._playing&&this._frameCount>0&&null!=this.stage?i.timer.frameLoop(1,this,this.update):i.timer.clear(this,this.update)},s.__addToStage=function(){this._playing&&this._frameCount>0&&i.timer.frameLoop(1,this,this.update)},s.__removeFromStage=function(){i.timer.clear(this,this.update)},h(0,s,"frames",function(){return this._frames},function(t){this._frames=t,this._scaleByTile=!1,this._scale9Grid=null,null!=this._frames?(this._frameCount=this._frames.length,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._frame<0||this._frame>this._frameCount-1)&&(this._frame=this._frameCount-1),this._frameElapsed=0,this._repeatedCount=0,this._reversed=!1):this._frameCount=0,this.drawFrame(),this.checkTimer()}),h(0,s,"playing",function(){return this._playing},function(t){this._playing!=t&&(this._playing=t,this.checkTimer())}),h(0,s,"frameCount",function(){return this._frameCount}),h(0,s,"frame",function(){return this._frame},function(t){this._frame!=t&&(null!=this._frames&&t>=this._frameCount&&(t=this._frameCount-1),this._frame=t,this._frameElapsed=0,this.drawFrame())}),e}(Fe);i.__init([Le,ke,W,ge,$,pe,N,Y,be,xe,te])}(window,document,Laya);
!function(t){window.JSZip=t()}(function(){return function t(e,r,n){function i(s,o){if(!r[s]){if(!e[s]){var d="function"==typeof require&&require;if(!o&&d)return d(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){var r=e[s][1][t];return i(r?r:t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var e,r,i,a,s,o,d,l="",h=0;h<t.length;)e=t.charCodeAt(h++),r=t.charCodeAt(h++),i=t.charCodeAt(h++),a=e>>2,s=(3&e)<<4|r>>4,o=(15&r)<<2|i>>6,d=63&i,isNaN(r)?o=d=64:isNaN(i)&&(d=64),l=l+n.charAt(a)+n.charAt(s)+n.charAt(o)+n.charAt(d);return l},r.decode=function(t){var e,r,i,a,s,o,d,l="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)a=n.indexOf(t.charAt(h++)),s=n.indexOf(t.charAt(h++)),o=n.indexOf(t.charAt(h++)),d=n.indexOf(t.charAt(h++)),e=a<<2|s>>4,r=(15&s)<<4|o>>2,i=(3&o)<<6|d,l+=String.fromCharCode(e),64!=o&&(l+=String.fromCharCode(r)),64!=d&&(l+=String.fromCharCode(i));return l}},{}],2:[function(t,e){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=r},{}],3:[function(t,e,r){"use strict";r.STORE={magic:"\x00\x00",compress:function(t){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},r.DEFLATE=t("./flate")},{"./flate":8}],4:[function(t,e){"use strict";var r=t("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if("undefined"==typeof t||!t.length)return 0;var i="string"!==r.getTypeOf(t);"undefined"==typeof e&&(e=0);var a=0,s=0,o=0;e=-1^e;for(var d=0,l=t.length;l>d;d++)o=i?t[d]:t.charCodeAt(d),s=255&(e^o),a=n[s],e=e>>>8^a;return-1^e}},{"./utils":21}],5:[function(t,e){"use strict";function r(){this.data=null,this.length=0,this.index=0}var n=t("./utils");r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||0>t)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=r},{"./utils":21}],6:[function(t,e,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!1,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],7:[function(t,e,r){"use strict";var n=t("./utils");r.string2binary=function(t){return n.string2binary(t)},r.string2Uint8Array=function(t){return n.transformTo("uint8array",t)},r.uint8Array2String=function(t){return n.transformTo("string",t)},r.string2Blob=function(t){var e=n.transformTo("arraybuffer",t);return n.arrayBuffer2Blob(e)},r.arrayBuffer2Blob=function(t){return n.arrayBuffer2Blob(t)},r.transformTo=function(t,e){return n.transformTo(t,e)},r.getTypeOf=function(t){return n.getTypeOf(t)},r.checkSupport=function(t){return n.checkSupport(t)},r.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,r.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,r.pretty=function(t){return n.pretty(t)},r.findCompression=function(t){return n.findCompression(t)},r.isRegExp=function(t){return n.isRegExp(t)}},{"./utils":21}],8:[function(t,e,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=t("pako");r.uncompressInputType=n?"uint8array":"array",r.compressInputType=n?"uint8array":"array",r.magic="\b\x00",r.compress=function(t,e){return i.deflateRaw(t,{level:e.level||-1})},r.uncompress=function(t){return i.inflateRaw(t)}},{pako:24}],9:[function(t,e){"use strict";function r(t,e){return this instanceof r?(this.files={},this.comment=null,this.root="",t&&this.load(t,e),void(this.clone=function(){var t=new r;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t})):new r(t,e)}var n=t("./base64");r.prototype=t("./object"),r.prototype.load=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.utils=t("./deprecatedPublicUtils"),r.base64={encode:function(t){return n.encode(t)},decode:function(t){return n.decode(t)}},r.compressions=t("./compressions"),e.exports=r},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(t,e){"use strict";var r=t("./base64"),n=t("./zipEntries");e.exports=function(t,e){var i,a,s,o;for(e=e||{},e.base64&&(t=r.decode(t)),a=new n(t,e),i=a.files,s=0;s<i.length;s++)o=i[s],this.file(o.fileName,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileComment.length?o.fileComment:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:e.createFolders});return a.zipComment.length&&(this.comment=a.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(t,e){(function(t){"use strict";e.exports=function(e,r){return new t(e,r)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(t,e){"use strict";function r(t){this.data=t,this.length=this.data.length,this.index=0}var n=t("./uint8ArrayReader");r.prototype=new n,r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=r},{"./uint8ArrayReader":18}],13:[function(t,e){"use strict";var r=t("./support"),n=t("./utils"),i=t("./crc32"),a=t("./signature"),s=t("./defaults"),o=t("./base64"),d=t("./compressions"),l=t("./compressedObject"),h=t("./nodeBuffer"),u=t("./utf8"),f=t("./stringWriter"),c=t("./uint8ArrayWriter"),p=function(t){if(t._data instanceof l&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===n.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},_=function(t){var e=p(t),i=n.getTypeOf(e);return"string"===i?!t.options.binary&&r.nodebuffer?h(e,"utf-8"):t.asBinary():e},m=function(t){var e=p(this);return null===e||"undefined"==typeof e?"":(this.options.base64&&(e=o.decode(e)),e=t&&this.options.binary?I.utf8decode(e):n.transformTo("string",e),t||this.options.binary||(e=n.transformTo("string",I.utf8encode(e))),e)},g=function(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}};g.prototype={asText:function(){return m.call(this,!0)},asBinary:function(){return m.call(this,!1)},asNodeBuffer:function(){var t=_(this);return n.transformTo("nodebuffer",t)},asUint8Array:function(){var t=_(this);return n.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var b=function(t,e){var r,n="";for(r=0;e>r;r++)n+=String.fromCharCode(255&t),t>>>=8;return n},w=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"==typeof r[e]&&(r[e]=arguments[t][e]);return r},v=function(t){return t=t||{},t.base64!==!0||null!==t.binary&&void 0!==t.binary||(t.binary=!0),t=w(t,s),t.date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},y=function(t,e,r){var i,a=n.getTypeOf(e);if(r=v(r),"string"==typeof r.unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(t=x(t)),r.createFolders&&(i=k(t))&&z.call(this,i,!0),r.dir||null===e||"undefined"==typeof e)r.base64=!1,r.binary=!1,e=null,a=null;else if("string"===a)r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(e=n.string2binary(e));else{if(r.base64=!1,r.binary=!0,!(a||e instanceof l))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===a&&(e=n.transformTo("uint8array",e))}var s=new g(t,e,r);return this.files[t]=s,s},k=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},x=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},z=function(t,e){return e="undefined"!=typeof e?e:!1,t=x(t),this.files[t]||y.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},E=function(t,e,r){var a,s=new l;return t._data instanceof l?(s.uncompressedSize=t._data.uncompressedSize,s.crc32=t._data.crc32,0===s.uncompressedSize||t.dir?(e=d.STORE,s.compressedContent="",s.crc32=0):t._data.compressionMethod===e.magic?s.compressedContent=t._data.getCompressedContent():(a=t._data.getContent(),s.compressedContent=e.compress(n.transformTo(e.compressInputType,a),r))):(a=_(t),(!a||0===a.length||t.dir)&&(e=d.STORE,a=""),s.uncompressedSize=a.length,s.crc32=i(a),s.compressedContent=e.compress(n.transformTo(e.compressInputType,a),r)),s.compressedSize=s.compressedContent.length,s.compressionMethod=e.magic,s},A=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16},C=function(t){return 63&(t||0)},S=function(t,e,r,s,o){var d,l,h,f,c=(r.compressedContent,n.transformTo("string",u.utf8encode(e.name))),p=e.comment||"",_=n.transformTo("string",u.utf8encode(p)),m=c.length!==e.name.length,g=_.length!==p.length,w=e.options,v="",y="",k="";h=e._initialMetadata.dir!==e.dir?e.dir:w.dir,f=e._initialMetadata.date!==e.date?e.date:w.date;var x=0,z=0;h&&(x|=16),"UNIX"===o?(z=798,x|=A(e.unixPermissions,h)):(z=20,x|=C(e.dosPermissions,h)),d=f.getHours(),d<<=6,d|=f.getMinutes(),d<<=5,d|=f.getSeconds()/2,l=f.getFullYear()-1980,l<<=4,l|=f.getMonth()+1,l<<=5,l|=f.getDate(),m&&(y=b(1,1)+b(i(c),4)+c,v+="up"+b(y.length,2)+y),g&&(k=b(1,1)+b(this.crc32(_),4)+_,v+="uc"+b(k.length,2)+k);var E="";E+="\n\x00",E+=m||g?"\x00\b":"\x00\x00",E+=r.compressionMethod,E+=b(d,2),E+=b(l,2),E+=b(r.crc32,4),E+=b(r.compressedSize,4),E+=b(r.uncompressedSize,4),E+=b(c.length,2),E+=b(v.length,2);var S=a.LOCAL_FILE_HEADER+E+c+v,I=a.CENTRAL_FILE_HEADER+b(z,2)+E+b(_.length,2)+"\x00\x00\x00\x00"+b(x,4)+b(s,4)+c+v+_;return{fileRecord:S,dirRecord:I,compressedObject:r}},I={load:function(){throw new Error("Load method is not defined. Is the file jszip.json-load.js included ?")},filter:function(t){var e,r,n,i,a=[];for(e in this.files)this.files.hasOwnProperty(e)&&(n=this.files[e],i=new g(n.name,n._data,w(n.options)),r=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(r,i)&&a.push(i));return a},file:function(t,e,r){if(1===arguments.length){if(n.isRegExp(t)){var i=t;return this.filter(function(t,e){return!e.dir&&i.test(t)})}return this.filter(function(e,r){return!r.dir&&e===t})[0]||null}return t=this.root+t,y.call(this,t,e,r),this},folder:function(t){if(!t)return this;if(n.isRegExp(t))return this.filter(function(e,r){return r.dir&&t.test(e)});var e=this.root+t,r=z.call(this,e),i=this.clone();return i.root=r.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter(function(e,r){return r.name.slice(0,t.length)===t}),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(t){t=w(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip"}),n.checkSupport(t.type),("darwin"===t.platform||"freebsd"===t.platform||"linux"===t.platform||"sunos"===t.platform)&&(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,r,i=[],s=0,l=0,h=n.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var u in this.files)if(this.files.hasOwnProperty(u)){var p=this.files[u],_=p.options.compression||t.compression.toUpperCase(),m=d[_];if(!m)throw new Error(_+" is not a valid compression method !");var g=p.options.compressionOptions||t.compressionOptions||{},v=E.call(this,p,m,g),y=S.call(this,u,p,v,s,t.platform);s+=y.fileRecord.length+v.compressedSize,l+=y.dirRecord.length,i.push(y)}var k="";k=a.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+b(i.length,2)+b(i.length,2)+b(l,4)+b(s,4)+b(h.length,2)+h;var x=t.type.toLowerCase();for(e="uint8array"===x||"arraybuffer"===x||"blob"===x||"nodebuffer"===x?new c(s+l+k.length):new f(s+l+k.length),r=0;r<i.length;r++)e.append(i[r].fileRecord),e.append(i[r].compressedObject.compressedContent);for(r=0;r<i.length;r++)e.append(i[r].dirRecord);e.append(k);var z=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(t.type.toLowerCase(),z);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",z),t.mimeType);case"base64":return t.base64?o.encode(z):z;default:return z}},crc32:function(t,e){return i(t,e)},utf8encode:function(t){return n.transformTo("string",u.utf8encode(t))},utf8decode:function(t){return u.utf8decode(t)}};e.exports=I},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(t,e,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(t,e){"use strict";function r(t,e){this.data=t,e||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}var n=t("./dataReader"),i=t("./utils");r.prototype=new n,r.prototype.byteAt=function(t){return this.data.charCodeAt(t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=r},{"./dataReader":5,"./utils":21}],16:[function(t,e){"use strict";var r=t("./utils"),n=function(){this.data=[]};n.prototype={append:function(t){t=r.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=n},{"./utils":21}],17:[function(t,e,r){(function(t){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof t,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var e=new ArrayBuffer(0);try{r.blob=0===new Blob([e],{type:"application/zip"}).size}catch(n){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,a=new i;a.append(e),r.blob=0===a.getBlob("application/zip").size}catch(n){r.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(t,e){"use strict";function r(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}var n=t("./dataReader");r.prototype=new n,r.prototype.byteAt=function(t){return this.data[t]},r.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===e&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i)return a;return-1},r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e},e.exports=r},{"./dataReader":5}],19:[function(t,e){"use strict";var r=t("./utils"),n=function(t){this.data=new Uint8Array(t),this.index=0};n.prototype={append:function(t){0!==t.length&&(t=r.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=n},{"./utils":21}],20:[function(t,e,r){"use strict";for(var n=t("./utils"),i=t("./support"),a=t("./nodeBuffer"),s=new Array(256),o=0;256>o;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;s[254]=s[254]=1;var d=function(t){var e,r,n,a,s,o=t.length,d=0;for(a=0;o>a;a++)r=t.charCodeAt(a),55296===(64512&r)&&o>a+1&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),d+=128>r?1:2048>r?2:65536>r?3:4;for(e=i.uint8array?new Uint8Array(d):new Array(d),s=0,a=0;d>s;a++)r=t.charCodeAt(a),55296===(64512&r)&&o>a+1&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),128>r?e[s++]=r:2048>r?(e[s++]=192|r>>>6,e[s++]=128|63&r):65536>r?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e},l=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return 0>r?e:0===r?e:r+s[t[r]]>e?r:e},h=function(t){var e,r,i,a,o=t.length,d=new Array(2*o);for(r=0,e=0;o>e;)if(i=t[e++],128>i)d[r++]=i;else if(a=s[i],a>4)d[r++]=65533,e+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&o>e;)i=i<<6|63&t[e++],a--;a>1?d[r++]=65533:65536>i?d[r++]=i:(i-=65536,d[r++]=55296|i>>10&1023,d[r++]=56320|1023&i)}return d.length!==r&&(d.subarray?d=d.subarray(0,r):d.length=r),n.applyFromCharCode(d)};r.utf8encode=function(t){return i.nodebuffer?a(t,"utf-8"):d(t)},r.utf8decode=function(t){if(i.nodebuffer)return n.transformTo("nodebuffer",t).toString("utf-8");t=n.transformTo(i.uint8array?"uint8array":"array",t);for(var e=[],r=0,a=t.length,s=65536;a>r;){var o=l(t,Math.min(r+s,a));e.push(h(i.uint8array?t.subarray(r,o):t.slice(r,o))),r=o}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(t,e,r){"use strict";function n(t){return t}function i(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}function a(t){var e=65536,n=[],i=t.length,a=r.getTypeOf(t),s=0,o=!0;try{switch(a){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,l(0))}}catch(d){o=!1}if(!o){for(var h="",u=0;u<t.length;u++)h+=String.fromCharCode(t[u]);return h}for(;i>s&&e>1;)try{n.push("array"===a||"nodebuffer"===a?String.fromCharCode.apply(null,t.slice(s,Math.min(s+e,i))):String.fromCharCode.apply(null,t.subarray(s,Math.min(s+e,i)))),s+=e}catch(d){e=Math.floor(e/2)}return n.join("")}function s(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}var o=t("./support"),d=t("./compressions"),l=t("./nodeBuffer");r.string2binary=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(255&t.charCodeAt(r));return e},r.arrayBuffer2Blob=function(t,e){r.checkSupport("blob"),e=e||"application/zip";try{return new Blob([t],{type:e})}catch(n){try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,a=new i;return a.append(t),a.getBlob(e)}catch(n){throw new Error("Bug : can't construct the Blob.")}}},r.applyFromCharCode=a;var h={};h.string={string:n,array:function(t){return i(t,new Array(t.length))},arraybuffer:function(t){return h.string.uint8array(t).buffer},uint8array:function(t){return i(t,new Uint8Array(t.length))},nodebuffer:function(t){return i(t,l(t.length))}},h.array={string:a,array:n,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return l(t)}},h.arraybuffer={string:function(t){return a(new Uint8Array(t))},array:function(t){return s(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:n,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return l(new Uint8Array(t))}},h.uint8array={string:a,array:function(t){return s(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:n,nodebuffer:function(t){return l(t)}},h.nodebuffer={string:a,array:function(t){return s(t,new Array(t.length))},arraybuffer:function(t){return h.nodebuffer.uint8array(t).buffer},uint8array:function(t){return s(t,new Uint8Array(t.length))},nodebuffer:n},r.transformTo=function(t,e){if(e||(e=""),!t)return e;r.checkSupport(t);var n=r.getTypeOf(e),i=h[n][t](e);return i},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":o.nodebuffer&&l.test(t)?"nodebuffer":o.uint8array&&t instanceof Uint8Array?"uint8array":o.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){var e=o[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this browser")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var e,r,n="";for(r=0;r<(t||"").length;r++)e=t.charCodeAt(r),n+="\\x"+(16>e?"0":"")+e.toString(16).toUpperCase();return n},r.findCompression=function(t){for(var e in d)if(d.hasOwnProperty(e)&&d[e].magic===t)return d[e];return null},r.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(t,e){"use strict";function r(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}var n=t("./stringReader"),i=t("./nodeBufferReader"),a=t("./uint8ArrayReader"),s=t("./utils"),o=t("./signature"),d=t("./zipEntry"),l=t("./support"),h=t("./object");r.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(e)+", expected "+s.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=h.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,n=this.zip64EndOfCentralSize-44,i=0;n>i;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===o.CENTRAL_FILE_HEADER;)t=new d({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(-1===t){var e=!0;try{this.reader.setIndex(0),this.checkSignature(o.LOCAL_FILE_HEADER),e=!1}catch(r){}throw new Error(e?"Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip.json/documentation/howto/read_zip.html":"Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(t),this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===t)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=s.getTypeOf(t);this.reader="string"!==e||l.uint8array?"nodebuffer"===e?new i(t):new a(s.transformTo("uint8array",t)):new n(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=r},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(t,e){"use strict";function r(t,e){this.options=t,this.loadOptions=e}var n=t("./stringReader"),i=t("./utils"),a=t("./compressedObject"),s=t("./object"),o=0,d=3;r.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(t,e,r){return function(){var n=t.index;t.setIndex(e);var i=t.readData(r);return t.setIndex(n),i}},prepareContent:function(t,e,r,n,a){return function(){var t=i.transformTo(n.uncompressInputType,this.getCompressedContent()),e=n.uncompress(t);if(e.length!==a)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(r),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(e=i.findCompression(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=i.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=16&this.externalFileAttributes?!0:!1,t===o&&(this.dosPermissions=63&this.externalFileAttributes),t===d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileName.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=new n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var e,r,n,i=t.index;for(this.extraFields=this.extraFields||{};t.index<i+this.extraFieldsLength;)e=t.readInt(2),r=t.readInt(2),n=t.readString(r),this.extraFields[e]={id:e,length:r,value:n}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new n(t.value);
return 1!==e.readInt(1)?null:s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new n(t.value);return 1!==e.readInt(1)?null:s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null}},e.exports=r},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(t,e){"use strict";var r=t("./lib/utils/common").assign,n=t("./lib/deflate"),i=t("./lib/inflate"),a=t("./lib/zlib/constants"),s={};r(s,n,i,a),e.exports=s},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(t,e,r){"use strict";function n(t,e){var r=new b(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function i(t,e){return e=e||{},e.raw=!0,n(t,e)}function a(t,e){return e=e||{},e.gzip=!0,n(t,e)}var s=t("./zlib/deflate.js"),o=t("./utils/common"),d=t("./utils/strings"),l=t("./zlib/messages"),h=t("./zlib/zstream"),u=0,f=4,c=0,p=1,_=-1,m=0,g=8,b=function(t){this.options=o.assign({level:_,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var r=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==c)throw new Error(l[r]);e.header&&s.deflateSetHeader(this.strm,e.header)};b.prototype.push=function(t,e){var r,n,i=this.strm,a=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:e===!0?f:u,i.input="string"==typeof t?d.string2buf(t):t,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new o.Buf8(a),i.next_out=0,i.avail_out=a),r=s.deflate(i,n),r!==p&&r!==c)return this.onEnd(r),this.ended=!0,!1;(0===i.avail_out||0===i.avail_in&&n===f)&&this.onData("string"===this.options.to?d.buf2binstring(o.shrinkBuf(i.output,i.next_out)):o.shrinkBuf(i.output,i.next_out))}while((i.avail_in>0||0===i.avail_out)&&r!==p);return n===f?(r=s.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):!0},b.prototype.onData=function(t){this.chunks.push(t)},b.prototype.onEnd=function(t){t===c&&(this.result="string"===this.options.to?this.chunks.join(""):o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=b,r.deflate=n,r.deflateRaw=i,r.gzip=a},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(t,e,r){"use strict";function n(t,e){var r=new f(e);if(r.push(t,!0),r.err)throw r.msg;return r.result}function i(t,e){return e=e||{},e.raw=!0,n(t,e)}var a=t("./zlib/inflate.js"),s=t("./utils/common"),o=t("./utils/strings"),d=t("./zlib/constants"),l=t("./zlib/messages"),h=t("./zlib/zstream"),u=t("./zlib/gzheader"),f=function(t){this.options=s.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var r=a.inflateInit2(this.strm,e.windowBits);if(r!==d.Z_OK)throw new Error(l[r]);this.header=new u,a.inflateGetHeader(this.strm,this.header)};f.prototype.push=function(t,e){var r,n,i,l,h,u=this.strm,f=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:e===!0?d.Z_FINISH:d.Z_NO_FLUSH,u.input="string"==typeof t?o.binstring2buf(t):t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new s.Buf8(f),u.next_out=0,u.avail_out=f),r=a.inflate(u,d.Z_NO_FLUSH),r!==d.Z_STREAM_END&&r!==d.Z_OK)return this.onEnd(r),this.ended=!0,!1;u.next_out&&(0===u.avail_out||r===d.Z_STREAM_END||0===u.avail_in&&n===d.Z_FINISH)&&("string"===this.options.to?(i=o.utf8border(u.output,u.next_out),l=u.next_out-i,h=o.buf2string(u.output,i),u.next_out=l,u.avail_out=f-l,l&&s.arraySet(u.output,u.output,i,l,0),this.onData(h)):this.onData(s.shrinkBuf(u.output,u.next_out)))}while(u.avail_in>0&&r!==d.Z_STREAM_END);return r===d.Z_STREAM_END&&(n=d.Z_FINISH),n===d.Z_FINISH?(r=a.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===d.Z_OK):!0},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===d.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=f,r.inflate=n,r.inflateRaw=i,r.ungzip=n},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(t,e,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)return void t.set(e.subarray(r,r+n),i);for(var a=0;n>a;a++)t[i+a]=e[r+a]},flattenChunks:function(t){var e,r,n,i,a,s;for(n=0,e=0,r=t.length;r>e;e++)n+=t[e].length;for(s=new Uint8Array(n),i=0,e=0,r=t.length;r>e;e++)a=t[e],s.set(a,i),i+=a.length;return s}},a={arraySet:function(t,e,r,n,i){for(var a=0;n>a;a++)t[i+a]=e[r+a]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(n)},{}],28:[function(t,e,r){"use strict";function n(t,e){if(65537>e&&(t.subarray&&s||!t.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var r="",n=0;e>n;n++)r+=String.fromCharCode(t[n]);return r}var i=t("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(o){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(o){s=!1}for(var d=new i.Buf8(256),l=0;256>l;l++)d[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;d[254]=d[254]=1,r.string2buf=function(t){var e,r,n,a,s,o=t.length,d=0;for(a=0;o>a;a++)r=t.charCodeAt(a),55296===(64512&r)&&o>a+1&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),d+=128>r?1:2048>r?2:65536>r?3:4;for(e=new i.Buf8(d),s=0,a=0;d>s;a++)r=t.charCodeAt(a),55296===(64512&r)&&o>a+1&&(n=t.charCodeAt(a+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),a++)),128>r?e[s++]=r:2048>r?(e[s++]=192|r>>>6,e[s++]=128|63&r):65536>r?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e},r.buf2binstring=function(t){return n(t,t.length)},r.binstring2buf=function(t){for(var e=new i.Buf8(t.length),r=0,n=e.length;n>r;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,i,a,s,o=e||t.length,l=new Array(2*o);for(i=0,r=0;o>r;)if(a=t[r++],128>a)l[i++]=a;else if(s=d[a],s>4)l[i++]=65533,r+=s-1;else{for(a&=2===s?31:3===s?15:7;s>1&&o>r;)a=a<<6|63&t[r++],s--;s>1?l[i++]=65533:65536>a?l[i++]=a:(a-=65536,l[i++]=55296|a>>10&1023,l[i++]=56320|1023&a)}return n(l,i)},r.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&128===(192&t[r]);)r--;return 0>r?e:0===r?e:r+d[t[r]]>e?r:e}},{"./common":27}],29:[function(t,e){"use strict";function r(t,e,r,n){for(var i=65535&t|0,a=t>>>16&65535|0,s=0;0!==r;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0}e.exports=r},{}],30:[function(t,e){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(t,e){"use strict";function r(){for(var t,e=[],r=0;256>r;r++){t=r;for(var n=0;8>n;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}function n(t,e,r,n){var a=i,s=n+r;t=-1^t;for(var o=n;s>o;o++)t=t>>>8^a[255&(t^e[o])];return-1^t}var i=r();e.exports=n},{}],32:[function(t,e,r){"use strict";function n(t,e){return t.msg=R[e],e}function i(t){return(t<<1)-(t>4?9:0)}function a(t){for(var e=t.length;--e>=0;)t[e]=0}function s(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(S.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function o(t,e){I._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,s(t.strm)}function d(t,e){t.pending_buf[t.pending++]=e}function l(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function h(t,e,r,n){var i=t.avail_in;return i>n&&(i=n),0===i?0:(t.avail_in-=i,S.arraySet(e,t.input,t.next_in,i,r),1===t.state.wrap?t.adler=B(t.adler,e,i,r):2===t.state.wrap&&(t.adler=O(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)}function u(t,e){var r,n,i=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,d=t.strstart>t.w_size-le?t.strstart-(t.w_size-le):0,l=t.window,h=t.w_mask,u=t.prev,f=t.strstart+de,c=l[a+s-1],p=l[a+s];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do if(r=e,l[r+s]===p&&l[r+s-1]===c&&l[r]===l[a]&&l[++r]===l[a+1]){a+=2,r++;do;while(l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&l[++a]===l[++r]&&f>a);if(n=de-(f-a),a=f-de,n>s){if(t.match_start=e,s=n,n>=o)break;c=l[a+s-1],p=l[a+s]}}while((e=u[e&h])>d&&0!==--i);return s<=t.lookahead?s:t.lookahead}function f(t){var e,r,n,i,a,s=t.w_size;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-le)){S.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,r=t.hash_size,e=r;do n=t.head[--e],t.head[e]=n>=s?n-s:0;while(--r);r=s,e=r;do n=t.prev[--e],t.prev[e]=n>=s?n-s:0;while(--r);i+=s}if(0===t.strm.avail_in)break;if(r=h(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=oe)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+oe-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<oe)););}while(t.lookahead<le&&0!==t.strm.avail_in)}function c(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(f(t),0===t.lookahead&&e===T)return be;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,o(t,!1),0===t.strm.avail_out))return be;if(t.strstart-t.block_start>=t.w_size-le&&(o(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ve:ye):t.strstart>t.block_start&&(o(t,!1),0===t.strm.avail_out)?be:be}function p(t,e){for(var r,n;;){if(t.lookahead<le){if(f(t),t.lookahead<le&&e===T)return be;if(0===t.lookahead)break}if(r=0,t.lookahead>=oe&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-le&&(t.match_length=u(t,r)),t.match_length>=oe)if(n=I._tr_tally(t,t.strstart-t.match_start,t.match_length-oe),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=oe){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=I._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(o(t,!1),0===t.strm.avail_out))return be}return t.insert=t.strstart<oe-1?t.strstart:oe-1,e===N?(o(t,!0),0===t.strm.avail_out?ve:ye):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?be:we}function _(t,e){for(var r,n,i;;){if(t.lookahead<le){if(f(t),t.lookahead<le&&e===T)return be;if(0===t.lookahead)break}if(r=0,t.lookahead>=oe&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=oe-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-le&&(t.match_length=u(t,r),t.match_length<=5&&(t.strategy===X||t.match_length===oe&&t.strstart-t.match_start>4096)&&(t.match_length=oe-1)),t.prev_length>=oe&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-oe,n=I._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-oe),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(0!==--t.prev_length);if(t.match_available=0,t.match_length=oe-1,t.strstart++,n&&(o(t,!1),0===t.strm.avail_out))return be}else if(t.match_available){if(n=I._tr_tally(t,0,t.window[t.strstart-1]),n&&o(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return be}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=I._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<oe-1?t.strstart:oe-1,e===N?(o(t,!0),0===t.strm.avail_out?ve:ye):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?be:we}function m(t,e){for(var r,n,i,a,s=t.window;;){if(t.lookahead<=de){if(f(t),t.lookahead<=de&&e===T)return be;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=oe&&t.strstart>0&&(i=t.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){a=t.strstart+de;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&a>i);t.match_length=de-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=oe?(r=I._tr_tally(t,1,t.match_length-oe),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=I._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(o(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ve:ye):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?be:we}function g(t,e){for(var r;;){if(0===t.lookahead&&(f(t),0===t.lookahead)){if(e===T)return be;break}if(t.match_length=0,r=I._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(o(t,!1),0===t.strm.avail_out))return be}return t.insert=0,e===N?(o(t,!0),0===t.strm.avail_out?ve:ye):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?be:we}function b(t){t.window_size=2*t.w_size,a(t.head),t.max_lazy_match=C[t.level].max_lazy,t.good_match=C[t.level].good_length,t.nice_match=C[t.level].nice_length,t.max_chain_length=C[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=oe-1,t.match_available=0,t.ins_h=0}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=G,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new S.Buf16(2*ae),this.dyn_dtree=new S.Buf16(2*(2*ne+1)),this.bl_tree=new S.Buf16(2*(2*ie+1)),a(this.dyn_ltree),a(this.dyn_dtree),a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new S.Buf16(se+1),this.heap=new S.Buf16(2*re+1),a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new S.Buf16(2*re+1),a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=q,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ue:me,t.adler=2===e.wrap?0:1,e.last_flush=T,I._tr_init(e),F):n(t,P)}function y(t){var e=v(t);return e===F&&b(t.state),e}function k(t,e){return t&&t.state?2!==t.state.wrap?P:(t.state.gzhead=e,F):P}function x(t,e,r,i,a,s){if(!t)return P;var o=1;if(e===H&&(e=6),0>i?(o=0,i=-i):i>15&&(o=2,i-=16),1>a||a>J||r!==G||8>i||i>15||0>e||e>9||0>s||s>Y)return n(t,P);8===i&&(i=9);var d=new w;return t.state=d,d.strm=t,d.wrap=o,d.gzhead=null,d.w_bits=i,d.w_size=1<<d.w_bits,d.w_mask=d.w_size-1,d.hash_bits=a+7,d.hash_size=1<<d.hash_bits,d.hash_mask=d.hash_size-1,d.hash_shift=~~((d.hash_bits+oe-1)/oe),d.window=new S.Buf8(2*d.w_size),d.head=new S.Buf16(d.hash_size),d.prev=new S.Buf16(d.w_size),d.lit_bufsize=1<<a+6,d.pending_buf_size=4*d.lit_bufsize,d.pending_buf=new S.Buf8(d.pending_buf_size),d.d_buf=d.lit_bufsize>>1,d.l_buf=3*d.lit_bufsize,d.level=e,d.strategy=s,d.method=r,y(t)}function z(t,e){return x(t,e,G,Q,$,W)}function E(t,e){var r,o,h,u;if(!t||!t.state||e>U||0>e)return t?n(t,P):P;if(o=t.state,!t.output||!t.input&&0!==t.avail_in||o.status===ge&&e!==N)return n(t,0===t.avail_out?j:P);if(o.strm=t,r=o.last_flush,o.last_flush=e,o.status===ue)if(2===o.wrap)t.adler=0,d(o,31),d(o,139),d(o,8),o.gzhead?(d(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),d(o,255&o.gzhead.time),d(o,o.gzhead.time>>8&255),d(o,o.gzhead.time>>16&255),d(o,o.gzhead.time>>24&255),d(o,9===o.level?2:o.strategy>=K||o.level<2?4:0),d(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(d(o,255&o.gzhead.extra.length),d(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(t.adler=O(t.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=fe):(d(o,0),d(o,0),d(o,0),d(o,0),d(o,0),d(o,9===o.level?2:o.strategy>=K||o.level<2?4:0),d(o,ke),o.status=me);else{var f=G+(o.w_bits-8<<4)<<8,c=-1;c=o.strategy>=K||o.level<2?0:o.level<6?1:6===o.level?2:3,f|=c<<6,0!==o.strstart&&(f|=he),f+=31-f%31,o.status=me,l(o,f),0!==o.strstart&&(l(o,t.adler>>>16),l(o,65535&t.adler)),t.adler=1}if(o.status===fe)if(o.gzhead.extra){for(h=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending!==o.pending_buf_size));)d(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=ce)}else o.status=ce;if(o.status===ce)if(o.gzhead.name){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending===o.pending_buf_size)){u=1;break}u=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,d(o,u)}while(0!==u);o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),0===u&&(o.gzindex=0,o.status=pe)}else o.status=pe;if(o.status===pe)if(o.gzhead.comment){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending===o.pending_buf_size)){u=1;break}u=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,d(o,u)}while(0!==u);o.gzhead.hcrc&&o.pending>h&&(t.adler=O(t.adler,o.pending_buf,o.pending-h,h)),0===u&&(o.status=_e)}else o.status=_e;if(o.status===_e&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&s(t),o.pending+2<=o.pending_buf_size&&(d(o,255&t.adler),d(o,t.adler>>8&255),t.adler=0,o.status=me)):o.status=me),0!==o.pending){if(s(t),0===t.avail_out)return o.last_flush=-1,F}else if(0===t.avail_in&&i(e)<=i(r)&&e!==N)return n(t,j);if(o.status===ge&&0!==t.avail_in)return n(t,j);if(0!==t.avail_in||0!==o.lookahead||e!==T&&o.status!==ge){var p=o.strategy===K?g(o,e):o.strategy===V?m(o,e):C[o.level].func(o,e);if((p===ve||p===ye)&&(o.status=ge),p===be||p===ve)return 0===t.avail_out&&(o.last_flush=-1),F;if(p===we&&(e===L?I._tr_align(o):e!==U&&(I._tr_stored_block(o,0,0,!1),e===D&&(a(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),s(t),0===t.avail_out))return o.last_flush=-1,F}return e!==N?F:o.wrap<=0?Z:(2===o.wrap?(d(o,255&t.adler),d(o,t.adler>>8&255),d(o,t.adler>>16&255),d(o,t.adler>>24&255),d(o,255&t.total_in),d(o,t.total_in>>8&255),d(o,t.total_in>>16&255),d(o,t.total_in>>24&255)):(l(o,t.adler>>>16),l(o,65535&t.adler)),s(t),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?F:Z)}function A(t){var e;return t&&t.state?(e=t.state.status,e!==ue&&e!==fe&&e!==ce&&e!==pe&&e!==_e&&e!==me&&e!==ge?n(t,P):(t.state=null,e===me?n(t,M):F)):P}var C,S=t("../utils/common"),I=t("./trees"),B=t("./adler32"),O=t("./crc32"),R=t("./messages"),T=0,L=1,D=3,N=4,U=5,F=0,Z=1,P=-2,M=-3,j=-5,H=-1,X=1,K=2,V=3,Y=4,W=0,q=2,G=8,J=9,Q=15,$=8,te=29,ee=256,re=ee+1+te,ne=30,ie=19,ae=2*re+1,se=15,oe=3,de=258,le=de+oe+1,he=32,ue=42,fe=69,ce=73,pe=91,_e=103,me=113,ge=666,be=1,we=2,ve=3,ye=4,ke=3,xe=function(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i};C=[new xe(0,0,0,0,c),new xe(4,4,8,4,p),new xe(4,5,16,8,p),new xe(4,6,32,32,p),new xe(4,4,16,16,_),new xe(8,16,32,32,_),new xe(8,16,128,128,_),new xe(8,32,128,256,_),new xe(32,128,258,1024,_),new xe(32,258,258,4096,_)],r.deflateInit=z,r.deflateInit2=x,r.deflateReset=y,r.deflateResetKeep=v,r.deflateSetHeader=k,r.deflate=E,r.deflateEnd=A,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(t,e){"use strict";function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=r},{}],34:[function(t,e){"use strict";var r=30,n=12;e.exports=function(t,e){var i,a,s,o,d,l,h,u,f,c,p,_,m,g,b,w,v,y,k,x,z,E,A,C,S;i=t.state,a=t.next_in,C=t.input,s=a+(t.avail_in-5),o=t.next_out,S=t.output,d=o-(e-t.avail_out),l=o+(t.avail_out-257),h=i.dmax,u=i.wsize,f=i.whave,c=i.wnext,p=i.window,_=i.hold,m=i.bits,g=i.lencode,b=i.distcode,w=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;t:do{15>m&&(_+=C[a++]<<m,m+=8,_+=C[a++]<<m,m+=8),y=g[_&w];e:for(;;){if(k=y>>>24,_>>>=k,m-=k,k=y>>>16&255,0===k)S[o++]=65535&y;else{if(!(16&k)){if(0===(64&k)){y=g[(65535&y)+(_&(1<<k)-1)];continue e}if(32&k){i.mode=n;break t}t.msg="invalid literal/length code",i.mode=r;break t}x=65535&y,k&=15,k&&(k>m&&(_+=C[a++]<<m,m+=8),x+=_&(1<<k)-1,_>>>=k,m-=k),15>m&&(_+=C[a++]<<m,m+=8,_+=C[a++]<<m,m+=8),y=b[_&v];r:for(;;){if(k=y>>>24,_>>>=k,m-=k,k=y>>>16&255,!(16&k)){if(0===(64&k)){y=b[(65535&y)+(_&(1<<k)-1)];continue r}t.msg="invalid distance code",i.mode=r;break t}if(z=65535&y,k&=15,k>m&&(_+=C[a++]<<m,m+=8,k>m&&(_+=C[a++]<<m,m+=8)),z+=_&(1<<k)-1,z>h){t.msg="invalid distance too far back",i.mode=r;break t}if(_>>>=k,m-=k,k=o-d,z>k){if(k=z-k,k>f&&i.sane){t.msg="invalid distance too far back",i.mode=r;break t}if(E=0,A=p,0===c){if(E+=u-k,x>k){x-=k;do S[o++]=p[E++];while(--k);E=o-z,A=S}}else if(k>c){if(E+=u+c-k,k-=c,x>k){x-=k;do S[o++]=p[E++];while(--k);if(E=0,x>c){k=c,x-=k;do S[o++]=p[E++];while(--k);E=o-z,A=S}}}else if(E+=c-k,x>k){x-=k;do S[o++]=p[E++];while(--k);E=o-z,A=S}for(;x>2;)S[o++]=A[E++],S[o++]=A[E++],S[o++]=A[E++],x-=3;x&&(S[o++]=A[E++],x>1&&(S[o++]=A[E++]))}else{E=o-z;do S[o++]=S[E++],S[o++]=S[E++],S[o++]=S[E++],x-=3;while(x>2);x&&(S[o++]=S[E++],x>1&&(S[o++]=S[E++]))}break}}break}}while(s>a&&l>o);x=m>>3,a-=x,m-=x<<3,_&=(1<<m)-1,t.next_in=a,t.next_out=o,t.avail_in=s>a?5+(s-a):5-(a-s),t.avail_out=l>o?257+(l-o):257-(o-l),i.hold=_,i.bits=m}},{}],35:[function(t,e,r){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=N,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new g.Buf32(pe),e.distcode=e.distdyn=new g.Buf32(_e),e.sane=1,e.back=-1,S):O}function s(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,a(t)):O}function o(t,e){var r,n;return t&&t.state?(n=t.state,0>e?(r=0,e=-e):(r=(e>>4)+1,48>e&&(e&=15)),e&&(8>e||e>15)?O:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,s(t))):O}function d(t,e){var r,n;return t?(n=new i,t.state=n,n.window=null,r=o(t,e),r!==S&&(t.state=null),r):O}function l(t){return d(t,ge)}function h(t){if(be){var e;for(_=new g.Buf32(512),m=new g.Buf32(32),e=0;144>e;)t.lens[e++]=8;for(;256>e;)t.lens[e++]=9;for(;280>e;)t.lens[e++]=7;for(;288>e;)t.lens[e++]=8;for(y(x,t.lens,0,288,_,0,t.work,{bits:9}),e=0;32>e;)t.lens[e++]=5;y(z,t.lens,0,32,m,0,t.work,{bits:5}),be=!1}t.lencode=_,t.lenbits=9,t.distcode=m,t.distbits=5}function u(t,e,r,n){var i,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new g.Buf8(a.wsize)),n>=a.wsize?(g.arraySet(a.window,e,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),g.arraySet(a.window,e,r-n,i,a.wnext),n-=i,n?(g.arraySet(a.window,e,r-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}function f(t,e){var r,i,a,s,o,d,l,f,c,p,_,m,pe,_e,me,ge,be,we,ve,ye,ke,xe,ze,Ee,Ae=0,Ce=new g.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return O;r=t.state,r.mode===Y&&(r.mode=W),o=t.next_out,a=t.output,l=t.avail_out,s=t.next_in,i=t.input,d=t.avail_in,f=r.hold,c=r.bits,p=d,_=l,xe=S;t:for(;;)switch(r.mode){case N:if(0===r.wrap){r.mode=W;break}for(;16>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(2&r.wrap&&35615===f){r.check=0,Ce[0]=255&f,Ce[1]=f>>>8&255,r.check=w(r.check,Ce,2,0),f=0,c=0,r.mode=U;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=ue;break}if((15&f)!==D){t.msg="unknown compression method",r.mode=ue;break}if(f>>>=4,c-=4,ke=(15&f)+8,0===r.wbits)r.wbits=ke;else if(ke>r.wbits){t.msg="invalid window size",r.mode=ue;break}r.dmax=1<<ke,t.adler=r.check=1,r.mode=512&f?K:Y,f=0,c=0;break;case U:for(;16>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(r.flags=f,(255&r.flags)!==D){t.msg="unknown compression method",r.mode=ue;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=ue;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(Ce[0]=255&f,Ce[1]=f>>>8&255,r.check=w(r.check,Ce,2,0)),f=0,c=0,r.mode=F;case F:for(;32>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.head&&(r.head.time=f),512&r.flags&&(Ce[0]=255&f,Ce[1]=f>>>8&255,Ce[2]=f>>>16&255,Ce[3]=f>>>24&255,r.check=w(r.check,Ce,4,0)),f=0,c=0,r.mode=Z;case Z:for(;16>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(Ce[0]=255&f,Ce[1]=f>>>8&255,r.check=w(r.check,Ce,2,0)),f=0,c=0,r.mode=P;case P:if(1024&r.flags){for(;16>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(Ce[0]=255&f,Ce[1]=f>>>8&255,r.check=w(r.check,Ce,2,0)),f=0,c=0}else r.head&&(r.head.extra=null);r.mode=M;case M:if(1024&r.flags&&(m=r.length,m>d&&(m=d),m&&(r.head&&(ke=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),g.arraySet(r.head.extra,i,s,m,ke)),512&r.flags&&(r.check=w(r.check,i,m,s)),d-=m,s+=m,r.length-=m),r.length))break t;r.length=0,r.mode=j;case j:if(2048&r.flags){if(0===d)break t;m=0;do ke=i[s+m++],r.head&&ke&&r.length<65536&&(r.head.name+=String.fromCharCode(ke));while(ke&&d>m);if(512&r.flags&&(r.check=w(r.check,i,m,s)),d-=m,s+=m,ke)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=H;case H:if(4096&r.flags){if(0===d)break t;m=0;do ke=i[s+m++],r.head&&ke&&r.length<65536&&(r.head.comment+=String.fromCharCode(ke));while(ke&&d>m);if(512&r.flags&&(r.check=w(r.check,i,m,s)),d-=m,s+=m,ke)break t}else r.head&&(r.head.comment=null);r.mode=X;case X:if(512&r.flags){for(;16>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(f!==(65535&r.check)){t.msg="header crc mismatch",r.mode=ue;break}f=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Y;break;case K:for(;32>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}t.adler=r.check=n(f),f=0,c=0,r.mode=V;case V:if(0===r.havedict)return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=d,r.hold=f,r.bits=c,B;t.adler=r.check=1,r.mode=Y;case Y:if(e===A||e===C)break t;case W:if(r.last){f>>>=7&c,c-=7&c,r.mode=de;break}for(;3>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}switch(r.last=1&f,f>>>=1,c-=1,3&f){case 0:r.mode=q;break;case 1:if(h(r),r.mode=ee,e===C){f>>>=2,c-=2;break t}break;case 2:r.mode=Q;break;case 3:t.msg="invalid block type",r.mode=ue}f>>>=2,c-=2;break;case q:for(f>>>=7&c,c-=7&c;32>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if((65535&f)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ue;break}if(r.length=65535&f,f=0,c=0,r.mode=G,e===C)break t;case G:r.mode=J;case J:if(m=r.length){if(m>d&&(m=d),m>l&&(m=l),0===m)break t;g.arraySet(a,i,s,m,o),d-=m,s+=m,l-=m,o+=m,r.length-=m;break}r.mode=Y;break;case Q:for(;14>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(r.nlen=(31&f)+257,f>>>=5,c-=5,r.ndist=(31&f)+1,f>>>=5,c-=5,r.ncode=(15&f)+4,f>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ue;break}r.have=0,r.mode=$;case $:for(;r.have<r.ncode;){for(;3>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.lens[Se[r.have++]]=7&f,f>>>=3,c-=3}for(;r.have<19;)r.lens[Se[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ze={bits:r.lenbits},xe=y(k,r.lens,0,19,r.lencode,0,r.work,ze),r.lenbits=ze.bits,xe){t.msg="invalid code lengths set",r.mode=ue;break}r.have=0,r.mode=te;case te:for(;r.have<r.nlen+r.ndist;){for(;Ae=r.lencode[f&(1<<r.lenbits)-1],me=Ae>>>24,ge=Ae>>>16&255,be=65535&Ae,!(c>=me);){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(16>be)f>>>=me,c-=me,r.lens[r.have++]=be;else{if(16===be){for(Ee=me+2;Ee>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(f>>>=me,c-=me,0===r.have){t.msg="invalid bit length repeat",r.mode=ue;break}ke=r.lens[r.have-1],m=3+(3&f),f>>>=2,c-=2}else if(17===be){for(Ee=me+3;Ee>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}f>>>=me,c-=me,ke=0,m=3+(7&f),f>>>=3,c-=3}else{for(Ee=me+7;Ee>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}f>>>=me,c-=me,ke=0,m=11+(127&f),f>>>=7,c-=7}if(r.have+m>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ue;break}for(;m--;)r.lens[r.have++]=ke}}if(r.mode===ue)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=ue;break}if(r.lenbits=9,ze={bits:r.lenbits},xe=y(x,r.lens,0,r.nlen,r.lencode,0,r.work,ze),r.lenbits=ze.bits,xe){t.msg="invalid literal/lengths set",r.mode=ue;break}if(r.distbits=6,r.distcode=r.distdyn,ze={bits:r.distbits},xe=y(z,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ze),r.distbits=ze.bits,xe){t.msg="invalid distances set",r.mode=ue;break}if(r.mode=ee,e===C)break t;case ee:r.mode=re;case re:if(d>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=d,r.hold=f,r.bits=c,v(t,_),o=t.next_out,a=t.output,l=t.avail_out,s=t.next_in,i=t.input,d=t.avail_in,f=r.hold,c=r.bits,r.mode===Y&&(r.back=-1);
break}for(r.back=0;Ae=r.lencode[f&(1<<r.lenbits)-1],me=Ae>>>24,ge=Ae>>>16&255,be=65535&Ae,!(c>=me);){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(ge&&0===(240&ge)){for(we=me,ve=ge,ye=be;Ae=r.lencode[ye+((f&(1<<we+ve)-1)>>we)],me=Ae>>>24,ge=Ae>>>16&255,be=65535&Ae,!(c>=we+me);){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}f>>>=we,c-=we,r.back+=we}if(f>>>=me,c-=me,r.back+=me,r.length=be,0===ge){r.mode=oe;break}if(32&ge){r.back=-1,r.mode=Y;break}if(64&ge){t.msg="invalid literal/length code",r.mode=ue;break}r.extra=15&ge,r.mode=ne;case ne:if(r.extra){for(Ee=r.extra;Ee>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=ie;case ie:for(;Ae=r.distcode[f&(1<<r.distbits)-1],me=Ae>>>24,ge=Ae>>>16&255,be=65535&Ae,!(c>=me);){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(0===(240&ge)){for(we=me,ve=ge,ye=be;Ae=r.distcode[ye+((f&(1<<we+ve)-1)>>we)],me=Ae>>>24,ge=Ae>>>16&255,be=65535&Ae,!(c>=we+me);){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}f>>>=we,c-=we,r.back+=we}if(f>>>=me,c-=me,r.back+=me,64&ge){t.msg="invalid distance code",r.mode=ue;break}r.offset=be,r.extra=15&ge,r.mode=ae;case ae:if(r.extra){for(Ee=r.extra;Ee>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ue;break}r.mode=se;case se:if(0===l)break t;if(m=_-l,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ue;break}m>r.wnext?(m-=r.wnext,pe=r.wsize-m):pe=r.wnext-m,m>r.length&&(m=r.length),_e=r.window}else _e=a,pe=o-r.offset,m=r.length;m>l&&(m=l),l-=m,r.length-=m;do a[o++]=_e[pe++];while(--m);0===r.length&&(r.mode=re);break;case oe:if(0===l)break t;a[o++]=r.length,l--,r.mode=re;break;case de:if(r.wrap){for(;32>c;){if(0===d)break t;d--,f|=i[s++]<<c,c+=8}if(_-=l,t.total_out+=_,r.total+=_,_&&(t.adler=r.check=r.flags?w(r.check,a,_,o-_):b(r.check,a,_,o-_)),_=l,(r.flags?f:n(f))!==r.check){t.msg="incorrect data check",r.mode=ue;break}f=0,c=0}r.mode=le;case le:if(r.wrap&&r.flags){for(;32>c;){if(0===d)break t;d--,f+=i[s++]<<c,c+=8}if(f!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=ue;break}f=0,c=0}r.mode=he;case he:xe=I;break t;case ue:xe=R;break t;case fe:return T;case ce:default:return O}return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=d,r.hold=f,r.bits=c,(r.wsize||_!==t.avail_out&&r.mode<ue&&(r.mode<de||e!==E))&&u(t,t.output,t.next_out,_-t.avail_out)?(r.mode=fe,T):(p-=t.avail_in,_-=t.avail_out,t.total_in+=p,t.total_out+=_,r.total+=_,r.wrap&&_&&(t.adler=r.check=r.flags?w(r.check,a,_,t.next_out-_):b(r.check,a,_,t.next_out-_)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Y?128:0)+(r.mode===ee||r.mode===G?256:0),(0===p&&0===_||e===E)&&xe===S&&(xe=L),xe)}function c(t){if(!t||!t.state)return O;var e=t.state;return e.window&&(e.window=null),t.state=null,S}function p(t,e){var r;return t&&t.state?(r=t.state,0===(2&r.wrap)?O:(r.head=e,e.done=!1,S)):O}var _,m,g=t("../utils/common"),b=t("./adler32"),w=t("./crc32"),v=t("./inffast"),y=t("./inftrees"),k=0,x=1,z=2,E=4,A=5,C=6,S=0,I=1,B=2,O=-2,R=-3,T=-4,L=-5,D=8,N=1,U=2,F=3,Z=4,P=5,M=6,j=7,H=8,X=9,K=10,V=11,Y=12,W=13,q=14,G=15,J=16,Q=17,$=18,te=19,ee=20,re=21,ne=22,ie=23,ae=24,se=25,oe=26,de=27,le=28,he=29,ue=30,fe=31,ce=32,pe=852,_e=592,me=15,ge=me,be=!0;r.inflateReset=s,r.inflateReset2=o,r.inflateResetKeep=a,r.inflateInit=l,r.inflateInit2=d,r.inflate=f,r.inflateEnd=c,r.inflateGetHeader=p,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(t,e){"use strict";var r=t("../utils/common"),n=15,i=852,a=592,s=0,o=1,d=2,l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,c,p,_,m,g,b){var w,v,y,k,x,z,E,A,C,S=b.bits,I=0,B=0,O=0,R=0,T=0,L=0,D=0,N=0,U=0,F=0,Z=null,P=0,M=new r.Buf16(n+1),j=new r.Buf16(n+1),H=null,X=0;for(I=0;n>=I;I++)M[I]=0;for(B=0;p>B;B++)M[e[c+B]]++;for(T=S,R=n;R>=1&&0===M[R];R--);if(T>R&&(T=R),0===R)return _[m++]=20971520,_[m++]=20971520,b.bits=1,0;for(O=1;R>O&&0===M[O];O++);for(O>T&&(T=O),N=1,I=1;n>=I;I++)if(N<<=1,N-=M[I],0>N)return-1;if(N>0&&(t===s||1!==R))return-1;for(j[1]=0,I=1;n>I;I++)j[I+1]=j[I]+M[I];for(B=0;p>B;B++)0!==e[c+B]&&(g[j[e[c+B]]++]=B);if(t===s?(Z=H=g,z=19):t===o?(Z=l,P-=257,H=h,X-=257,z=256):(Z=u,H=f,z=-1),F=0,B=0,I=O,x=m,L=T,D=0,y=-1,U=1<<T,k=U-1,t===o&&U>i||t===d&&U>a)return 1;for(var K=0;;){K++,E=I-D,g[B]<z?(A=0,C=g[B]):g[B]>z?(A=H[X+g[B]],C=Z[P+g[B]]):(A=96,C=0),w=1<<I-D,v=1<<L,O=v;do v-=w,_[x+(F>>D)+v]=E<<24|A<<16|C|0;while(0!==v);for(w=1<<I-1;F&w;)w>>=1;if(0!==w?(F&=w-1,F+=w):F=0,B++,0===--M[I]){if(I===R)break;I=e[c+g[B]]}if(I>T&&(F&k)!==y){for(0===D&&(D=T),x+=O,L=I-D,N=1<<L;R>L+D&&(N-=M[L+D],!(0>=N));)L++,N<<=1;if(U+=1<<L,t===o&&U>i||t===d&&U>a)return 1;y=F&k,_[y]=T<<24|L<<16|x-m|0}}return 0!==F&&(_[x+F]=I-D<<24|64<<16|0),b.bits=T,0}},{"../utils/common":27}],37:[function(t,e){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(t,e,r){"use strict";function n(t){for(var e=t.length;--e>=0;)t[e]=0}function i(t){return 256>t?se[t]:se[256+(t>>>7)]}function a(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function s(t,e,r){t.bi_valid>Y-r?(t.bi_buf|=e<<t.bi_valid&65535,a(t,t.bi_buf),t.bi_buf=e>>Y-t.bi_valid,t.bi_valid+=r-Y):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function o(t,e,r){s(t,r[2*e],r[2*e+1])}function d(t,e){var r=0;do r|=1&t,t>>>=1,r<<=1;while(--e>0);return r>>>1}function l(t){16===t.bi_valid?(a(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function h(t,e){var r,n,i,a,s,o,d=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,u=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,p=e.stat_desc.max_length,_=0;for(a=0;V>=a;a++)t.bl_count[a]=0;for(d[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;K>r;r++)n=t.heap[r],a=d[2*d[2*n+1]+1]+1,a>p&&(a=p,_++),d[2*n+1]=a,n>l||(t.bl_count[a]++,s=0,n>=c&&(s=f[n-c]),o=d[2*n],t.opt_len+=o*(a+s),u&&(t.static_len+=o*(h[2*n+1]+s)));if(0!==_){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,_-=2}while(_>0);for(a=p;0!==a;a--)for(n=t.bl_count[a];0!==n;)i=t.heap[--r],i>l||(d[2*i+1]!==a&&(t.opt_len+=(a-d[2*i+1])*d[2*i],d[2*i+1]=a),n--)}}function u(t,e,r){var n,i,a=new Array(V+1),s=0;for(n=1;V>=n;n++)a[n]=s=s+r[n-1]<<1;for(i=0;e>=i;i++){var o=t[2*i+1];0!==o&&(t[2*i]=d(a[o]++,o))}}function f(){var t,e,r,n,i,a=new Array(V+1);for(r=0,n=0;P-1>n;n++)for(de[n]=r,t=0;t<1<<$[n];t++)oe[r++]=n;for(oe[r-1]=n,i=0,n=0;16>n;n++)for(le[n]=i,t=0;t<1<<te[n];t++)se[i++]=n;for(i>>=7;H>n;n++)for(le[n]=i<<7,t=0;t<1<<te[n]-7;t++)se[256+i++]=n;for(e=0;V>=e;e++)a[e]=0;for(t=0;143>=t;)ie[2*t+1]=8,t++,a[8]++;for(;255>=t;)ie[2*t+1]=9,t++,a[9]++;for(;279>=t;)ie[2*t+1]=7,t++,a[7]++;for(;287>=t;)ie[2*t+1]=8,t++,a[8]++;for(u(ie,j+1,a),t=0;H>t;t++)ae[2*t+1]=5,ae[2*t]=d(t,5);he=new ce(ie,$,M+1,j,V),ue=new ce(ae,te,0,H,V),fe=new ce(new Array(0),ee,0,X,W)}function c(t){var e;for(e=0;j>e;e++)t.dyn_ltree[2*e]=0;for(e=0;H>e;e++)t.dyn_dtree[2*e]=0;for(e=0;X>e;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*q]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function p(t){t.bi_valid>8?a(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function _(t,e,r,n){p(t),n&&(a(t,r),a(t,~r)),B.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function m(t,e,r,n){var i=2*e,a=2*r;return t[i]<t[a]||t[i]===t[a]&&n[e]<=n[r]}function g(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&m(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!m(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function b(t,e,r){var n,a,d,l,h=0;if(0!==t.last_lit)do n=t.pending_buf[t.d_buf+2*h]<<8|t.pending_buf[t.d_buf+2*h+1],a=t.pending_buf[t.l_buf+h],h++,0===n?o(t,a,e):(d=oe[a],o(t,d+M+1,e),l=$[d],0!==l&&(a-=de[d],s(t,a,l)),n--,d=i(n),o(t,d,r),l=te[d],0!==l&&(n-=le[d],s(t,n,l)));while(h<t.last_lit);o(t,q,e)}function w(t,e){var r,n,i,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,d=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=K,r=0;d>r;r++)0!==a[2*r]?(t.heap[++t.heap_len]=l=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)i=t.heap[++t.heap_len]=2>l?++l:0,a[2*i]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=s[2*i+1]);for(e.max_code=l,r=t.heap_len>>1;r>=1;r--)g(t,a,r);i=d;do r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],g(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,a[2*i]=a[2*r]+a[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,a[2*r+1]=a[2*n+1]=i,t.heap[1]=i++,g(t,a,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],h(t,e),u(a,l,t.bl_count)}function v(t,e,r){var n,i,a=-1,s=e[1],o=0,d=7,l=4;for(0===s&&(d=138,l=3),e[2*(r+1)+1]=65535,n=0;r>=n;n++)i=s,s=e[2*(n+1)+1],++o<d&&i===s||(l>o?t.bl_tree[2*i]+=o:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[2*G]++):10>=o?t.bl_tree[2*J]++:t.bl_tree[2*Q]++,o=0,a=i,0===s?(d=138,l=3):i===s?(d=6,l=3):(d=7,l=4))}function y(t,e,r){var n,i,a=-1,d=e[1],l=0,h=7,u=4;for(0===d&&(h=138,u=3),n=0;r>=n;n++)if(i=d,d=e[2*(n+1)+1],!(++l<h&&i===d)){if(u>l){do o(t,i,t.bl_tree);while(0!==--l)}else 0!==i?(i!==a&&(o(t,i,t.bl_tree),l--),o(t,G,t.bl_tree),s(t,l-3,2)):10>=l?(o(t,J,t.bl_tree),s(t,l-3,3)):(o(t,Q,t.bl_tree),s(t,l-11,7));l=0,a=i,0===d?(h=138,u=3):i===d?(h=6,u=3):(h=7,u=4)}}function k(t){var e;for(v(t,t.dyn_ltree,t.l_desc.max_code),v(t,t.dyn_dtree,t.d_desc.max_code),w(t,t.bl_desc),e=X-1;e>=3&&0===t.bl_tree[2*re[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function x(t,e,r,n){var i;for(s(t,e-257,5),s(t,r-1,5),s(t,n-4,4),i=0;n>i;i++)s(t,t.bl_tree[2*re[i]+1],3);y(t,t.dyn_ltree,e-1),y(t,t.dyn_dtree,r-1)}function z(t){var e,r=4093624447;for(e=0;31>=e;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return R;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return T;for(e=32;M>e;e++)if(0!==t.dyn_ltree[2*e])return T;return R}function E(t){_e||(f(),_e=!0),t.l_desc=new pe(t.dyn_ltree,he),t.d_desc=new pe(t.dyn_dtree,ue),t.bl_desc=new pe(t.bl_tree,fe),t.bi_buf=0,t.bi_valid=0,c(t)}function A(t,e,r,n){s(t,(D<<1)+(n?1:0),3),_(t,e,r,!0)}function C(t){s(t,N<<1,3),o(t,q,ie),l(t)}function S(t,e,r,n){var i,a,o=0;t.level>0?(t.strm.data_type===L&&(t.strm.data_type=z(t)),w(t,t.l_desc),w(t,t.d_desc),o=k(t),i=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,i>=a&&(i=a)):i=a=r+5,i>=r+4&&-1!==e?A(t,e,r,n):t.strategy===O||a===i?(s(t,(N<<1)+(n?1:0),3),b(t,ie,ae)):(s(t,(U<<1)+(n?1:0),3),x(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),b(t,t.dyn_ltree,t.dyn_dtree)),c(t),n&&p(t)}function I(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(oe[r]+M+1)]++,t.dyn_dtree[2*i(e)]++),t.last_lit===t.lit_bufsize-1}var B=t("../utils/common"),O=4,R=0,T=1,L=2,D=0,N=1,U=2,F=3,Z=258,P=29,M=256,j=M+1+P,H=30,X=19,K=2*j+1,V=15,Y=16,W=7,q=256,G=16,J=17,Q=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=512,ie=new Array(2*(j+2));n(ie);var ae=new Array(2*H);n(ae);var se=new Array(ne);n(se);var oe=new Array(Z-F+1);n(oe);var de=new Array(P);n(de);var le=new Array(H);n(le);var he,ue,fe,ce=function(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length},pe=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e},_e=!1;r._tr_init=E,r._tr_stored_block=A,r._tr_flush_block=S,r._tr_tally=I,r._tr_align=C},{"../utils/common":27}],39:[function(t,e){"use strict";function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=r},{}]},{},[9])(9)});var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,r=function(){return t.URL||t.webkitURL||t},n=t.URL||t.webkitURL||t,i=e&&false||{},a=!t.externalHost&&"download"in i,s=t.webkitRequestFileSystem,o=t.requestFileSystem||s||t.mozRequestFileSystem,d=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},l="application/octet-stream",h=0,u=[],f=function(){for(var t=u.length;t--;){var e=u[t];"string"==typeof e?n.revokeObjectURL(e):e.remove()}u.length=0},c=function(t,e,r){e=[].concat(e);for(var n=e.length;n--;){var i=t["on"+e[n]];if("function"==typeof i)try{i.call(t,r||t)}catch(a){d(a)}}},p=function(n,d){var f,p,_,m=this,g=n.type,b=!1,w=function(){var t=r().createObjectURL(n);return u.push(t),t},v=function(){c(m,"writestart progress write writeend".split(" "))},y=function(){(b||!f)&&(f=w(n)),p?p.location.href=f:window.open(f,"_blank"),m.readyState=m.DONE,v()},k=function(t){return function(){return m.readyState!==m.DONE?t.apply(this,arguments):void 0}},x={create:!0,exclusive:!1};if(m.readyState=m.INIT,d||(d="download"),a){f=w(n),e=t.document,i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),i.href=f,i.download=d;var z=e.createEvent("MouseEvents");return z.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(z),m.readyState=m.DONE,void v()}return t.chrome&&g&&g!==l&&(_=n.slice||n.webkitSlice,n=_.call(n,0,n.size,l),b=!0),s&&"download"!==d&&(d+=".download"),(g===l||s)&&(p=t),o?(h+=n.size,void o(t.TEMPORARY,h,k(function(t){t.root.getDirectory("saved",x,k(function(t){var e=function(){t.getFile(d,x,k(function(t){t.createWriter(k(function(e){e.onwriteend=function(e){p.location.href=t.toURL(),u.push(t),m.readyState=m.DONE,c(m,"writeend",e)},e.onerror=function(){var t=e.error;t.code!==t.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(t){e["on"+t]=m["on"+t]}),e.write(n),m.abort=function(){e.abort(),m.readyState=m.DONE},m.readyState=m.WRITING}),y)}),y)};t.getFile(d,{create:!1},k(function(t){t.remove(),e()}),k(function(t){t.code===t.NOT_FOUND_ERR?e():y()}))}),y)}),y)):void y()},_=p.prototype,m=function(t,e){return new p(t,e)};return _.abort=function(){var t=this;t.readyState=t.DONE,c(t,"abort")},_.readyState=_.INIT=0,_.WRITING=1,_.DONE=2,_.error=_.onwritestart=_.onprogress=_.onwrite=_.onabort=_.onerror=_.onwriteend=null,t.addEventListener&&t.addEventListener("unload",f,!1),m.unload=function(){f(),t.removeEventListener("unload",f,!1)},m}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&(module.exports=saveAs);
var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var mpsdk;(function(mpsdk){var Env=function(){function Env(){}Env.version="2.15.5";Env.build="201999161054";Env.storagePrefix="mpsdk_";Env.loginServer="https://xyxcck-auth.raink.com.cn";Env.newLoginServer="https://xyxcck-login.raink.com.cn";Env.reportServer1="https://xyxcck-log.raink.com.cn";Env.reportServer2="https://xyxcck-log-ad.raink.com.cn";Env.publicServer="https://xyx-public.raink.com.cn";Env.friendServer="https://xyxcck-friend.raink.com.cn";Env.cdnServer="https://cdn-xyx.raink.com.cn";Env.extServer="https://xyx-pdd-api.raink.com.cn";Env.boxServer="https://xyx-mainland-api.raink.com.cn";Env.trackAdServer="https://mainland-xyxzsdl-wx.raink.com.cn";Env.showLog=true;Env.init=false;Env.isRewardedVideoAd2Back=false;Env.isClickRewardedVideoAdDialogOk=false;Env.isRewardedVideoAdDialogShow=false;Env.phoneModel="";Env.mpsdkChannel="mpsdk";return Env}();mpsdk.Env=Env})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var utils=function(){function utils(){}utils.parseAccountSource=function(options){var source;if(options.query.type=="share"){source={sourceType:options.query.type,sourceId:options.query.shareid}}else if(options.query.type=="wxad"){source={sourceType:options.query.type,sourceId:options.query.adid+"."+options.query.weixinadinfo}}else if(options.query.type){source={sourceType:options.query.type,sourceId:options.query.adid}}else{source={sourceType:"std",sourceId:options.scene}}return source};utils.value=function(model,attribute,defaultValue){if(defaultValue===void 0){defaultValue=undefined}if(typeof model=="undefined"){return defaultValue}for(var _i=0,_a=attribute.split(".");_i<_a.length;_i++){var key=_a[_i];if(typeof model[key]!="undefined"){model=model[key]}else{return defaultValue}}return model};utils.getQueryString=function(query,key){var reg=new RegExp("(\\?|&)"+key+"=([^&]*)(&|$)");var r=query.match(reg);if(r!=null){return r[2]}return""};utils.httpBuildQuery=function(params){var requestParams="";for(var key in params){requestParams+=key+"="+params[key]+"&"}return requestParams.substr(0,requestParams.length-1)};utils.httpParseQuery=function(url){var result={};if(!url){return result}var query=url.toString().split("?")[1]||url.toString();if(query.indexOf("=")==-1){return result}for(var _i=0,_a=query.split("&");_i<_a.length;_i++){var kv=_a[_i];var kvSplit=kv.split("=");result[kvSplit[0]]=kvSplit[1]}return result};utils.waitData=function(dataProvider,thisObject,interval,timeout){if(interval===void 0){interval=200}if(timeout===void 0){timeout=3e4}var params=[];for(var _i=4;_i<arguments.length;_i++){params[_i-4]=arguments[_i]}return new Promise(function(resolve,reject){var _timerInterval;var _timerTimeout;_timerInterval=mpsdk.Platform.instance.setInterval(function(){var data=dataProvider.call.apply(dataProvider,[thisObject].concat(params));if(data){mpsdk.Platform.instance.clearInterval(_timerInterval);mpsdk.Platform.instance.clearTimeout(_timerTimeout);resolve(data)}},interval);_timerTimeout=mpsdk.Platform.instance.setTimeout(function(){mpsdk.Platform.instance.clearInterval(_timerInterval)},timeout)})};utils.tableAlgorithm=function(dataList,weightKey,popOne,thresholdUp,thresholdLow){if(popOne===void 0){popOne=true}if(thresholdUp===void 0){thresholdUp=Number.MAX_VALUE}if(thresholdLow===void 0){thresholdLow=0}if(!dataList||!dataList.length){return[]}var headList=[];var tableList=[];var tableCount=0;for(var i=0;i<dataList.length||0;i++){if(isNaN(dataList[i][weightKey])){continue}dataList[i][weightKey]=Number(dataList[i][weightKey]);if(dataList[i][weightKey]<=thresholdLow){continue}if(dataList[i][weightKey]>=thresholdUp){headList.push(dataList[i]);continue}tableList.push(dataList[i]);tableCount+=dataList[i][weightKey]}if(!tableCount||!tableList.length){return headList}var sortList=[];while(tableList.length){var point=Math.random();var sectorStart=0;for(var i=0;i<tableList.length;i++){var sectorEnd=sectorStart+tableList[i][weightKey]/tableCount;if(point>=sectorStart&&point<sectorEnd){sortList.push(tableList[i]);tableCount-=tableList[i][weightKey];tableList.splice(i,1);break}sectorStart=sectorEnd}}var resultList=headList.concat(sortList);if(popOne){return resultList[0]}else{return resultList}};utils.string2Buffer=function(data){var buf=new ArrayBuffer(data.length);var bufView=new Uint8Array(buf);for(var i=0;i<data.length;i++){bufView[i]=data.charCodeAt(i)}return buf};utils.buffer2String=function(data){var charCode=new Array(data.byteLength);var dv=new Uint8Array(data);for(var i=0;i<data.byteLength;i++){charCode[i]=String.fromCharCode(dv[i])}return charCode.join("")};utils.deepCompare=function(x,y){var leftChain,rightChain;function compare2Objects(x,y){if(isNaN(x)&&isNaN(y)&&typeof x==="number"&&typeof y==="number"){return true}if(x===y){return true}if(typeof x==="function"&&typeof y==="function"||x instanceof Date&&y instanceof Date||x instanceof RegExp&&y instanceof RegExp||x instanceof String&&y instanceof String||x instanceof Number&&y instanceof Number){return x.toString()===y.toString()}if(!(x instanceof Object&&y instanceof Object)){return false}if(x.isPrototypeOf(y)||y.isPrototypeOf(x)){return false}if(x.constructor!==y.constructor){return false}if(x.prototype!==y.prototype){return false}if(leftChain.indexOf(x)>-1||rightChain.indexOf(y)>-1){return false}for(var p in y){if(y.hasOwnProperty(p)!==x.hasOwnProperty(p)){return false}else if(typeof y[p]!==typeof x[p]){return false}}for(var p in x){if(y.hasOwnProperty(p)!==x.hasOwnProperty(p)){return false}else if(typeof y[p]!==typeof x[p]){return false}switch(typeof x[p]){case"object":case"function":leftChain.push(x);rightChain.push(y);if(!compare2Objects(x[p],y[p])){return false}leftChain.pop();rightChain.pop();break;default:if(x[p]!==y[p]){return false}break}}return true}if(arguments.length<1){return true}for(var i=1,l=arguments.length;i<l;i++){leftChain=[];rightChain=[];if(!compare2Objects(arguments[0],arguments[i])){return false}}return true};utils.drawRoundRect=function(ctx,x,y,w,h,r,lineWidth){ctx.beginPath();ctx.strokeStyle="#FFF";ctx.lineWidth=lineWidth;ctx.arc(x+r,y+r,r,Math.PI,Math.PI*1.5);ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.arc(x+w-r,y+r,r,Math.PI*1.5,Math.PI*2);ctx.lineTo(x+w,y+h-r);ctx.arc(x+w-r,y+h-r,r,0,Math.PI*.5);ctx.lineTo(x+r,y+h);ctx.arc(x+r,y+h-r,r,Math.PI*.5,Math.PI);ctx.lineTo(x,y+r);ctx.stroke();ctx.closePath()};utils.generateUUID=function(){var d=(new Date).getTime();var uuid="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=="x"?r:r&3|8).toString(16)});return uuid};utils.createClientUUID=function(){return(new Date).getTime()+""+(Math.random()*1e7).toString(10).substr(0,6)};utils.setFirstLaunchOptions=function(launchOptions){if(!launchOptions||!launchOptions.scene){return}var oldLaunchOptions=mpsdk.Platform.instance.getStorage("mpsdk_first_into_launch_options");if(oldLaunchOptions&&oldLaunchOptions.scene){return}mpsdk.Platform.instance.setStorage("mpsdk_first_into_launch_options",launchOptions)};utils.getFirstLaunchOptions=function(){return mpsdk.Platform.instance.getStorage("mpsdk_first_into_launch_options")};utils.checkAbroadCity=function(hackData){var currentProvince=utils.value(hackData,"ipArea.province");var currentCity=utils.value(hackData,"ipArea.city");var currentCountry=utils.value(hackData,"ipArea.country");return currentCountry&&currentCountry.indexOf("中国")==-1||currentProvince&&currentProvince.indexOf("台湾")!=-1||currentCity&&currentCity.indexOf("台湾")!=-1||currentProvince&&currentProvince.indexOf("香港")!=-1||currentCity&&currentCity.indexOf("香港")!=-1||currentProvince&&currentProvince.indexOf("澳门")!=-1||currentCity&&currentCity.indexOf("澳门")!=-1};utils.nativeAppLogin=function(launchOptions){var openId=mpsdk.Account.getOpenId();mpsdk.log("服务端登录开始openid",openId);var beginTime=(new Date).getTime();if(mpsdk.Env.mpsdkChannel){mpsdk.Env.launchOptions={scene:mpsdk.Env.mpsdkChannel,query:{}}}var accountSource=utils.parseAccountSource(mpsdk.Env.launchOptions);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_BEGIN);var phoneMode=mpsdk.Env.phoneModel?mpsdk.Env.phoneModel:mpsdk.Platform.instance.getSystem().platform;return new Promise(function(resolve,reject){var data={gameId:mpsdk.Env.gameId,unionId:"false",sourceType:accountSource.sourceType,sourceId:accountSource.sourceId,model:encodeURIComponent(phoneMode),openId:openId};var loginUrl=mpsdk.Env.newLoginServer+"/MiniLogin/data/GetOpenIdApp.action";mpsdk.log("nativeAppLogin 参数:",JSON.stringify(data));mpsdk.Platform.instance.httpRequest(loginUrl,data,"get").then(function(res){mpsdk.log("服务端登录成功",JSON.stringify(res));if(res&&res.openid){mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime,res.openid)}else{mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_FAILS,beginTime+"_服务器登录成功,但未获取到openid,errorcode="+res.error)}resolve(res)}).catch(function(res){mpsdk.log("服务端登录失败",JSON.stringify(res));mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_FAILS,beginTime+"_服务器登录失败："+JSON.stringify(res));reject(res)})})};return utils}();mpsdk.utils=utils})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var BricksPlatform=function(){function BricksPlatform(){}BricksPlatform.prototype.writeFile=function(fileName,data){return""};BricksPlatform.prototype.getStorage=function(key){var file="GameSandBox://"+mpsdk.Env.storagePrefix+key;if(BK.FileUtil.isFileExist(file)){try{var data=BK.FileUtil.readFile(file).readAsString();return data?JSON.parse(data):""}catch(e){return""}}else{return""}};BricksPlatform.prototype.setStorage=function(key,data){BK.FileUtil.writeFile("GameSandBox://"+mpsdk.Env.storagePrefix+key,JSON.stringify(data))};BricksPlatform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}var requestParams="";if(params){for(var key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return new Promise(function(resolve,reject){var responseHandler=function(resBuffer,code){if(Number(code)!==200){}var reslen=resBuffer.bufferLength();var response=resBuffer.readAsString();while(response.length==0&&reslen>0){response+=resBuffer.readAsString()}if(response.length>reslen){response=response.substring(0,reslen)}var endPoint=Math.max(response.lastIndexOf("]"),response.lastIndexOf("}"))+1;response=response.substring(0,endPoint);try{resolve(JSON.parse(response))}catch(e){resolve(response)}};if(method=="get"){var httpget=new BK.HttpUtil(url);httpget.setHttpMethod("get");httpget.requestAsync(responseHandler)}else{var httppost=new BK.HttpUtil(url);httppost.setHttpMethod("post");httppost.setHttpPostData(requestParams);httppost.requestAsync(responseHandler)}})};BricksPlatform.prototype.getUserAccount=function(launchOptions){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{openid:GameStatusInfo.openId}]})})};BricksPlatform.prototype.getUserInfo=function(){var userInfo={nickName:"",avatarUrl:"1",gender:GameStatusInfo.sex};return new Promise(function(resolve,reject){BK.MQQ.Account.getNick(GameStatusInfo.openId,function(openId,nick){userInfo.nickName=nick;userInfo.nickName&&userInfo.avatarUrl&&resolve(userInfo)})})};BricksPlatform.prototype.getSystem=function(){return{platform:GameStatusInfo.platform}};BricksPlatform.prototype.getLaunchOptions=function(){return{scene:GameStatusInfo.src||0,query:GameStatusInfo.gameParam?mpsdk.utils.httpParseQuery(GameStatusInfo.gameParam):{}}};BricksPlatform.prototype.launchTo=function(app){return __awaiter(this,void 0,void 0,function(){var extendInfo,position;return __generator(this,function(_a){position=app.page.indexOf("?");if(position!=-1){extendInfo=app.page.substring(position+1)}else{extendInfo=app.page}BK.QQ.skipGame(Number(app.appid),extendInfo);mpsdk.log("打开其他程序，desGameId=",app.appid,"extendInfo=",extendInfo);return[2]})})};BricksPlatform.prototype.launchToSync=function(app,launchToCallback){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};BricksPlatform.prototype.share=function(shareInfo,success,fail,thisObject){var randomShareInfo=mpsdk.Share.genShareInfo(shareInfo);var info={};info.summary=randomShareInfo.title;info.picUrl=randomShareInfo.image;randomShareInfo.localPicPath&&(info.localPicPath=randomShareInfo.localPicPath);info.extendInfo=mpsdk.Share.getShareQuery(randomShareInfo.serial,randomShareInfo.params||{},randomShareInfo.imageId);mpsdk.log("分享外链参数 extendInfo =",info.extendInfo);BK.QQ.share(info,function(retCode,shareDest,isFirstShare){mpsdk.log("分享结果：(retCode, shareDest, isFirstShare)=>",retCode,shareDest,isFirstShare);if(retCode==0){mpsdk.Share.reportShareOut(shareInfo.serial,randomShareInfo.imageId.toString(),shareDest.toString(),isFirstShare.toString());success&&success.call(thisObject,shareDest,isFirstShare)}else{fail&&fail.call(thisObject,retCode)}});return info};BricksPlatform.prototype.getCacheRes=function(url,waitDownload){if(waitDownload===void 0){waitDownload=false}return Promise.resolve(url)};BricksPlatform.prototype.setTimeout=function(callback,timeout){var t=new BK.Ticker;t.interval=timeout/1e3*60;t.setTickerCallBack(function(ts,duration){t.paused=true;callback.call();t.dispose()});return t};BricksPlatform.prototype.setInterval=function(callback,timeout){var t=new BK.Ticker;t.interval=timeout/1e3*60;t.setTickerCallBack(function(ts,duration){callback.call()});return t};BricksPlatform.prototype.clearTimeout=function(t){if(t){t.paused=true;t.dispose()}};BricksPlatform.prototype.clearInterval=function(t){if(t){t.paused=true;t.dispose()}};BricksPlatform.prototype.checkBannerClick=function(res){throw new Error("Method not implemented.")};BricksPlatform.prototype.onHide=function(){};BricksPlatform.prototype.showModal=function(object){};return BricksPlatform}();mpsdk.BricksPlatform=BricksPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var MinaPlatform=function(){function MinaPlatform(){}MinaPlatform.prototype.writeFile=function(fileName,data){if(!fileName||!data){return""}var fs=wx.getFileSystemManager();var rootDir=wx.env.USER_DATA_PATH+"/mpsdkadwx";var filePath=rootDir+"/"+fileName;try{fs.accessSync(rootDir)}catch(error){fs.mkdirSync(rootDir)}try{fs.accessSync(filePath);return filePath}catch(error){}var fileNameList=new Array;try{fileNameList=fs.readdirSync(rootDir);var nameSplitArray=fileName.split("_");var prefixName=nameSplitArray[0];for(var i=0;i<fileNameList.length;i++){var tempFileName=fileNameList[i];if(tempFileName.indexOf(prefixName+"_")==0){fs.unlinkSync(filePath);break}}}catch(error){}try{fs.writeFileSync(filePath,data,"utf-8")}catch(e){console.log("write file fail. filename:",fileName," error:",e);filePath=""}return filePath};MinaPlatform.prototype.getStorage=function(key){return wx.getStorageSync(mpsdk.Env.storagePrefix+key)};MinaPlatform.prototype.setStorage=function(key,data,isSync){if(isSync===void 0){isSync=true}try{if(isSync){wx.setStorageSync(mpsdk.Env.storagePrefix+key,data)}else{wx.setStorage({key:mpsdk.Env.storagePrefix+key,data:data})}}catch(e){}};MinaPlatform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}return __awaiter(this,void 0,void 0,function(){var network,requestParams,key;return __generator(this,function(_a){switch(_a.label){case 0:return[4,new Promise(function(resolve,reject){wx.getNetworkType({success:function(res){resolve(res)},fail:function(res){reject(res)}})})];case 1:network=_a.sent();if(network.networkType=="none"){throw"当前网络不可用"}requestParams="";if(params){for(key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return[4,new Promise(function(resolve,reject){var requestOptions={url:url,header:{"Content-Type":"application/json;charset=UTF-8"}};if(method!="get"){requestOptions["method"]="POST";requestOptions["data"]=params}var retryCount=0;var retrySend=function(reason){if(++retryCount<=retryTimes){wx.request(requestOptions);mpsdk.log("HTTP请求重试("+retryCount+")",url);return true}reject(reason);return false};requestOptions.success=function(response){if(response.statusCode&&response.statusCode>=200&&response.statusCode<400){resolve(response.data)}else{retrySend(response)}};requestOptions.fail=function(reason){retrySend(reason)};wx.request(requestOptions)})];case 2:return[2,_a.sent()]}})})};MinaPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){mpsdk.log("login retry over.");reject(e)})})})})};MinaPlatform.prototype.getUserAccountOnce=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){var beginTime=(new Date).getTime();mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_BEGIN);wx.login({success:function(loginResult){if(!mpsdk.Env.isNeedUnionid){mpsdk.log("微信登录成功,不需要获取授权信息,继续服务器端登录 ",loginResult.code);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime);var credentials={code:loginResult.code,encryptedData:"",iv:""};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)});return}wx.getSetting({success:function(settingResult){if(settingResult.authSetting["scope.userInfo"]){wx.getUserInfo({withCredentials:true,success:function(userInfoResult){mpsdk.log("微信授权成功,继续服务器端登录 ",loginResult.code);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime);var credentials={code:loginResult.code,encryptedData:userInfoResult.encryptedData,iv:userInfoResult.iv};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}})}else{mpsdk.log("微信未授权,继续服务器端登录 ",loginResult.code);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime);var credentials={code:loginResult.code,encryptedData:"",iv:""};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}},fail:function(res){mpsdk.log("微信获取授权状态失败,继续服务器端登录 ",loginResult.code,res);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime);var credentials={code:loginResult.code,encryptedData:"",iv:""};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}})},fail:function(res){mpsdk.log("微信登录失败: ",res);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_FAILS,"微信登录失败:"+res);reject(res)}})})};MinaPlatform.prototype.login=function(credentials,launchOptions){var _this=this;var beginTime=(new Date).getTime();var accountSource=mpsdk.utils.parseAccountSource(launchOptions);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_BEGIN);return new Promise(function(resolve,reject){var data={gameId:mpsdk.Env.gameId,code:credentials.code,encryptedData:encodeURIComponent(credentials.encryptedData),iv:encodeURIComponent(credentials.iv),unionId:credentials.encryptedData&&credentials.iv?"true":"false",sourceType:accountSource.sourceType,sourceId:accountSource.sourceId,model:encodeURIComponent(wx.getSystemInfoSync().model)};var loginUrl=mpsdk.Env.newLoginServer+"/MiniLogin/data/getOpenId2.action";_this.httpRequest(loginUrl,data,"get",0).then(function(res){mpsdk.log("服务端登录成功",res);if(res&&res.openid){mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS,""+beginTime,res.openid)}else{mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_FAILS,beginTime+"_服务器登录成功,但未获取到openid,errorcode="+res.error)}resolve(res)}).catch(function(res){mpsdk.log("服务端登录失败",res);mpsdk.Report.reportNewUserLog(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END,mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_FAILS,beginTime+"_服务器登录失败："+JSON.stringify(res));reject(res)})})};MinaPlatform.prototype.getUserInfo=function(){return new Promise(function(resolve,reject){wx.getSetting({fail:function(res){reject()},success:function(settingResult){if(settingResult.authSetting["scope.userInfo"]){wx.getUserInfo({fail:function(res){reject()},success:function(userInfoResult){resolve(userInfoResult.userInfo)}})}else{reject()}}})})};MinaPlatform.prototype.getSystem=function(){var sys=wx.getSystemInfoSync();return{platform:sys.platform,model:sys.model}};MinaPlatform.prototype.getLaunchOptions=function(){if(wx.getLaunchOptionsSync){return wx.getLaunchOptionsSync()}else{throw new Error("小程序启动参数请从app.js的onLaunch回调函数中获取")}};MinaPlatform.prototype.launchTo=function(app){return new Promise(function(resolve,reject){if(!wx.redirectTo&&wx.getSystemInfoSync().SDKVersion<"2.2.0"){wx.previewImage({urls:[app.ad_image]});resolve();return}wx.showLoading({title:"请稍候...",mask:true});setTimeout(wx.hideLoading,5*1e3);wx.navigateToMiniProgram({appId:app.appid,path:app.page,success:function(res){wx.hideLoading();resolve();mpsdk.log("打开其他程序成功，appId=",app.appid,"path=",app.page)},fail:function(res){wx.hideLoading();if(app.ad_image&&[".jpg",".gif",".png"].indexOf(app.ad_image.substr(-4))!=-1){wx.previewImage({urls:[app.ad_image]});resolve();mpsdk.log("直接跳转失败，拉起小程序码，appId=",app.appid,"path=",app.page)}else{reject();mpsdk.log("直接跳转失败，小程序码未设置，appId=",app.appid,"path=",app.page,JSON.stringify(res))}}})})};MinaPlatform.prototype.launchToSync=function(app,launchToCallback){if(!wx.redirectTo&&wx.getSystemInfoSync().SDKVersion<"2.2.0"){wx.previewImage({urls:[app.ad_image]});launchToCallback(true);return}wx.showLoading({title:"请稍候...",mask:true});setTimeout(wx.hideLoading,5*1e3);wx.navigateToMiniProgram({appId:app.appid,path:app.page,success:function(res){wx.hideLoading();launchToCallback(true);mpsdk.log("打开其他程序成功，appId=",app.appid,"path=",app.page)},fail:function(res){wx.hideLoading();if(app.ad_image&&[".jpg",".gif",".png"].indexOf(app.ad_image.substr(-4))!=-1){wx.previewImage({urls:[app.ad_image]});launchToCallback(true);mpsdk.log("直接跳转失败，拉起小程序码，appId=",app.appid,"path=",app.page)}else{launchToCallback(false);mpsdk.log("直接跳转失败，小程序码未设置，appId=",app.appid,"path=",app.page,JSON.stringify(res))}}})};MinaPlatform.prototype.share=function(shareInfo,success,fail,thisObject){var randomShareInfo=mpsdk.Share.genShareInfo(shareInfo);var info={};info.title=randomShareInfo.title;info.imageUrl=randomShareInfo.image;info.prefix=randomShareInfo.prefix;if(wx.redirectTo){info.path=mpsdk.Share.getShareLink(shareInfo.serial,shareInfo.path||"/pages/index/index",shareInfo.params||{},randomShareInfo.imageId)}else{info.query=mpsdk.Share.getShareQuery(randomShareInfo.serial,randomShareInfo.params||{},randomShareInfo.imageId)}info.success=function(res){success&&success.call(thisObject,res)};info.fail=function(res){fail&&fail.call(thisObject,res)};info.cancel=function(res){fail&&fail.call(thisObject,res)};mpsdk.Share.reportShareOut(shareInfo.serial,randomShareInfo.imageId.toString());return info};MinaPlatform.prototype.getCacheRes=function(url,waitDownload){var _this=this;if(waitDownload===void 0){waitDownload=false}return new Promise(function(resolve,reject){if(url.substr(0,8).toLowerCase()!=="https://"){resolve(url);return}var cacheFile=wx.env.USER_DATA_PATH+"/mpsdk/"+url.substr(8);var fs=wx.getFileSystemManager();try{fs.accessSync(cacheFile);if(fs.statSync(cacheFile).isFile()){resolve(cacheFile);return}else{fs.rmdirSync(cacheFile)}}catch(e){}if(MinaPlatform.downloadQueue.indexOf(url)>=0){resolve(url);return}!waitDownload&&resolve(url);MinaPlatform.downloadQueue.push(url);wx.downloadFile({url:url,success:function(res){if(res.statusCode===200){_this.mkdirRecursiveSync(cacheFile.substring(0,cacheFile.lastIndexOf("/")));fs.saveFileSync(res.tempFilePath,cacheFile);waitDownload&&resolve(cacheFile)}else{waitDownload&&resolve(url)}},fail:function(){waitDownload&&resolve(url)},complete:function(){MinaPlatform.downloadQueue.splice(MinaPlatform.downloadQueue.indexOf(url),1)}})})};MinaPlatform.prototype.mkdirRecursiveSync=function(dirPath){var fs=wx.getFileSystemManager();var dirLevel=dirPath.replace(wx.env.USER_DATA_PATH,"").split("/");var currentDir=wx.env.USER_DATA_PATH;for(var _i=0,dirLevel_1=dirLevel;_i<dirLevel_1.length;_i++){var dirName=dirLevel_1[_i];if(!dirName){continue}currentDir+="/"+dirName;try{fs.accessSync(currentDir);if(!fs.statSync(currentDir).isDirectory()){fs.unlinkSync(currentDir);fs.mkdirSync(currentDir)}}catch(e){fs.mkdirSync(currentDir)}}return currentDir};MinaPlatform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};MinaPlatform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};MinaPlatform.prototype.clearTimeout=function(t){clearTimeout(t)};MinaPlatform.prototype.clearInterval=function(t){clearInterval(t)};MinaPlatform.prototype.parseShareTicket=function(shareTicket){var _this=this;return new Promise(function(resolve,reject){if(!shareTicket){reject("shareTicket required");return}wx.login({fail:function(err){reject(err)},success:function(resLogin){wx.getShareInfo({shareTicket:shareTicket,fail:function(err){reject(err)},success:function(resShareInfo){var data={gameId:mpsdk.Env.gameId,code:encodeURIComponent(resLogin.code),encryptedData:encodeURIComponent(resShareInfo.encryptedData),iv:resShareInfo.iv};_this.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/getShareInfo.action",data).then(function(resServer){if(resServer.openGId){resolve(resServer)}else{reject(resServer)}}).catch(function(err){reject(err)})}})}})})};MinaPlatform.prototype.subscribe=function(msgId,formId,param1){var _this=this;if(param1===void 0){param1=""}return new Promise(function(resolve,reject){if(formId=="the formId is a mock one"){mpsdk.log("只能在真机环境下才能订阅模板消息");return}if(!_this.subscribeEnable(msgId)){mpsdk.log("订阅有效期内无需重复订阅");return}mpsdk.Account.getAccountSafe().then(function(account){var data={clockId:msgId,gameId:mpsdk.Env.gameId,openId:account.openid,formId:formId,parameters:param1};_this.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/regNotify.action",data).then(function(res){wx.setStorageSync("regnotify_"+msgId+"_endtime",res.time);wx.setStorageSync("regnotify_"+msgId+"_starttime",(new Date).getTime());var localDateTime=new Date(res.time).toLocaleDateString()+" "+new Date(res.time).toLocaleTimeString();mpsdk.log("注册模板消息成功",JSON.stringify(data),"有效期至",localDateTime);resolve()})})})};MinaPlatform.prototype.subscribeEnable=function(msgId){var starttime=+wx.getStorageSync("regnotify_"+msgId+"_starttime");var endtime=+wx.getStorageSync("regnotify_"+msgId+"_endtime");var nowtime=(new Date).getTime();if(starttime<=nowtime&&nowtime<=endtime){return false}return true};MinaPlatform.prototype.checkBannerClick=function(res){if(res&&res.scene==1038){if(res.referrerInfo&&res.referrerInfo.appId){return true}}return false};MinaPlatform.prototype.onHide=function(){try{wx.onAppShow(function(options){mpsdk.Report.reportAppRun(options);mpsdk.Report.reportHotLaunch(options);mpsdk.Hack.onShow()});wx.onAppHide(function(options){mpsdk.Hack.checkRewardedVideoAd2Back(options);var account=mpsdk.Account.getAccount();var hideOptions={gameId:mpsdk.Env.gameId,gamePath:mpsdk.Env.gamePath,openid:account.openid,unionid:account.unionid,lastLoginTime:account.lastLoginTime,createTime:account.createTime,shareTime:account.shareTime,sid:account.sid,anonymous_openid:account.anonymous_openid,options:options,launchOptions:mpsdk.Env.launchOptions};mpsdk.Hack.onHide(hideOptions)})}catch(error){}try{wx.onShow(function(options){mpsdk.Report.reportAppRun(options);mpsdk.Report.reportHotLaunch(options);mpsdk.Hack.onShow()});wx.onHide(function(options){mpsdk.Hack.checkRewardedVideoAd2Back(options);var account=mpsdk.Account.getAccount();var hideOptions={gameId:mpsdk.Env.gameId,gamePath:mpsdk.Env.gamePath,openid:account.openid,unionid:account.unionid,lastLoginTime:account.lastLoginTime,createTime:account.createTime,shareTime:account.shareTime,sid:account.sid,anonymous_openid:account.anonymous_openid,options:options,launchOptions:mpsdk.Env.launchOptions};mpsdk.Hack.onHide(hideOptions)})}catch(error){}};MinaPlatform.prototype.showModal=function(object){wx.showModal(object)};MinaPlatform.downloadQueue=[];return MinaPlatform}();mpsdk.MinaPlatform=MinaPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ext;(function(ext){var EgretUI=function(){function EgretUI(){this.width=0;this.height=0;this.scrollItemList=[];this.showIndex=0}EgretUI.prototype.showSuggestBottom=function(dataList,width,height,bgColor,borderColor){if(width===void 0){width=600}if(height===void 0){height=120}if(bgColor===void 0){bgColor=16777215}if(borderColor===void 0){borderColor=16777215}this.width=width;this.height=height;var container=new egret.DisplayObjectContainer;var background=new egret.Shape;background.graphics.lineStyle(2,borderColor);background.graphics.beginFill(bgColor,.3);background.graphics.drawRoundRect(0,0,this.width,this.height,20,20);background.graphics.endFill();container.addChild(background);var label=new egret.TextField;label.width=30;label.size=20;label.textColor=16777215;label.lineSpacing=5;label.text="猜你喜欢";label.y=(this.height-label.height)/2;label.x=15;container.addChild(label);this.scrollView=new egret.ScrollView;this.scrollView.height=this.height;this.scrollView.width=this.width-70;this.scrollView.x=50;this.scrollView.verticalScrollPolicy="off";container.addChild(this.scrollView);this.addIcon(dataList);this.scrollView.setContent(this.scrollContainer);this.setTimeIcon();return container};EgretUI.prototype.addIcon=function(dataList){var _this=this;this.scrollContainer=new egret.DisplayObjectContainer;var _loop_1=function(i){this_1.imageLoader(dataList[i].icon).then(function(texture){var srcollViewItem=new egret.DisplayObjectContainer;var bitmap=new egret.Bitmap(texture);bitmap.width=_this.height-20;bitmap.height=_this.height-20;var len=Math.floor(_this.scrollView.width/bitmap.width);if(len>dataList.length){len=dataList.length}srcollViewItem.addChild(bitmap);var mask=new egret.Shape;mask.graphics.beginFill(16777215,1);mask.graphics.drawRoundRect(0,0,bitmap.width,bitmap.height,25,25);mask.graphics.endFill();srcollViewItem.addChild(mask);bitmap.mask=mask;srcollViewItem.anchorOffsetX=srcollViewItem.width/2;srcollViewItem.anchorOffsetY=srcollViewItem.height/2;srcollViewItem.x=i*bitmap.width+i*(_this.scrollView.width-len*bitmap.height)/(len-1)+srcollViewItem.width/2;srcollViewItem.y=srcollViewItem.height/2+(_this.scrollView.height-bitmap.height)/2;srcollViewItem.touchEnabled=true;srcollViewItem.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){mpsdk.Ad.click(dataList[i])},_this);_this.scrollContainer.addChild(srcollViewItem);_this.scrollItemList[i]=srcollViewItem})};var this_1=this;for(var i=0;i<dataList.length;i++){_loop_1(i)}};EgretUI.prototype.setTimeIcon=function(){var _this=this;clearTimeout(this.scrollTimer);this.scrollTimer=setTimeout(function(){var currentIndex=_this.showIndex;var viewAreaWidth=_this.scrollView.width;if(_this.scrollItemList[currentIndex].x>viewAreaWidth+_this.scrollView.scrollLeft){var scrollViewLeft=_this.scrollItemList[currentIndex].x-_this.scrollItemList[currentIndex].width/2;if(scrollViewLeft+viewAreaWidth>_this.scrollContainer.width){scrollViewLeft=_this.scrollContainer.width-viewAreaWidth}_this.scrollView.setScrollLeft(scrollViewLeft,200)}else if(_this.scrollView.scrollLeft>_this.scrollItemList[currentIndex].x){_this.scrollView.setScrollLeft(_this.scrollItemList[currentIndex].x-_this.scrollItemList[currentIndex].width/2,200)}_this.scrollContainer.setChildIndex(_this.scrollItemList[currentIndex],_this.scrollItemList.length);egret.Tween.get(_this.scrollItemList[currentIndex]).to({scaleX:1.2,scaleY:1.2},700).to({scaleX:1,scaleY:1},700).call(function(){_this.scrollContainer.setChildIndex(_this.scrollItemList[currentIndex],1);egret.Tween.removeTweens(_this.scrollItemList[currentIndex]);_this.setTimeIcon();_this.showIndex++;if(_this.showIndex>=_this.scrollItemList.length){_this.showIndex=0}})},5e3)};EgretUI.prototype.imageLoader=function(source){var _this=this;return new Promise(function(resolve,reject){var imageLoader=new egret.ImageLoader;imageLoader.addEventListener(egret.Event.COMPLETE,function(event){var imageLoader=event.currentTarget;var texture=new egret.Texture;texture._setBitmapData(imageLoader.data);resolve(texture)},_this);imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,function(event){reject(event)},_this);imageLoader.load(source)})};return EgretUI}();ext.EgretUI=EgretUI})(ext=mpsdk.ext||(mpsdk.ext={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var EgretPlatform=function(){function EgretPlatform(){}EgretPlatform.prototype.writeFile=function(fileName,data){return""};EgretPlatform.prototype.getStorage=function(key){try{var data=egret.localStorage.getItem(mpsdk.Env.storagePrefix+key);return data?JSON.parse(data):""}catch(e){return""}};EgretPlatform.prototype.setStorage=function(key,data){egret.localStorage.setItem(mpsdk.Env.storagePrefix+key,JSON.stringify(data))};EgretPlatform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}var requestParams="";if(params){for(var key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return new Promise(function(resolve,reject){var responseHandler=function(event){var response=event.currentTarget.response;try{resolve(JSON.parse(response))}catch(e){resolve(response)}};var errorHandler=function(event){};var request=new egret.HttpRequest;request.once(egret.Event.COMPLETE,responseHandler,null);request.once(egret.IOErrorEvent.IO_ERROR,errorHandler,null);if(method=="get"){request.open(url,egret.HttpMethod.GET);request.send()}else{request.open(url,egret.HttpMethod.POST);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(requestParams)}})};EgretPlatform.prototype.writeOpenId2Native=function(account){if(account&&account.openid){try{egret.ExternalInterface.call("getNativeAppOpenId",account.openid)}catch(error){}}};EgretPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){if(mpsdk.Account.getOpenId()){mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}else{try{egret.ExternalInterface.call("getNativeAppOpenId","");egret.ExternalInterface.addCallback("getNativeAppOpenId",function(nativeOpenId){mpsdk.log("egret receive message--getNativeAppOpenId : ",nativeOpenId);if(nativeOpenId){var account={openid:nativeOpenId};mpsdk.Account.setAccount(account)}mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})})}catch(error){mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}}})};EgretPlatform.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{nickName:"TestNickName",avatarUrl:"",gender:-1}]})})};EgretPlatform.prototype.getSystem=function(){return{platform:egret.Capabilities.os}};EgretPlatform.prototype.getLaunchOptions=function(){return{scene:0,query:{}}};EgretPlatform.prototype.launchTo=function(app){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};EgretPlatform.prototype.launchToSync=function(app,launchToCallback){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};EgretPlatform.prototype.share=function(shareInfo,success,fail,thisObject){mpsdk.log("测试分享，success和fail都调用，方便调试");success&&success.call(thisObject);fail&&fail.call(thisObject)};EgretPlatform.prototype.getCacheRes=function(url,waitDownload){if(waitDownload===void 0){waitDownload=false}return Promise.resolve(url)};EgretPlatform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};EgretPlatform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};EgretPlatform.prototype.clearTimeout=function(t){clearTimeout(t)};EgretPlatform.prototype.clearInterval=function(t){clearInterval(t)};EgretPlatform.prototype.showSuggestBottom=function(dataList,width,height,bgColor,borderColor){if(width===void 0){width=600}if(height===void 0){height=120}if(bgColor===void 0){bgColor=16777215}if(borderColor===void 0){borderColor=16777215}return(new mpsdk.ext.EgretUI).showSuggestBottom(dataList,width,height,bgColor,borderColor)};EgretPlatform.prototype.checkBannerClick=function(res){throw new Error("Method not implemented.")};EgretPlatform.prototype.onHide=function(){try{egret.ExternalInterface.call("getPhoneModel","");egret.ExternalInterface.addCallback("getPhoneModel",function(phoneModel){mpsdk.Env.phoneModel=phoneModel})}catch(error){}try{egret.ExternalInterface.call("getMetaDataByKey","MPSDK_CHANNEL");egret.ExternalInterface.addCallback("getMetaDataByKey",function(mpsdkChannel){mpsdk.Env.mpsdkChannel=mpsdkChannel})}catch(error){}};EgretPlatform.prototype.showModal=function(object){};EgretPlatform.prototype.send2Native=function(message){egret.ExternalInterface.call("sendToNative",message)};return EgretPlatform}();mpsdk.EgretPlatform=EgretPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var CocosPlatform=function(){function CocosPlatform(){}CocosPlatform.prototype.writeFile=function(fileName,data){return""};CocosPlatform.prototype.getStorage=function(key){try{var data=cc.sys.localStorage.getItem(mpsdk.Env.storagePrefix+key);return data?JSON.parse(data):""}catch(e){return""}};CocosPlatform.prototype.setStorage=function(key,data){cc.sys.localStorage.setItem(mpsdk.Env.storagePrefix+key,JSON.stringify(data))};CocosPlatform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}var requestParams="";if(params){for(var key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return new Promise(function(resolve,reject){var xhr=cc.loader.getXMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status>=200&&xhr.status<400){try{resolve(JSON.parse(xhr.responseText))}catch(e){resolve(xhr.responseText)}}else{}};if(method=="get"){xhr.open("GET",url,true);xhr.send()}else{xhr.open("POST",url,true);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send(requestParams)}})};CocosPlatform.prototype.writeOpenId2Native=function(account){if(account&&account.openid){try{jsb.reflection.callStaticMethod("com/qmo/game/mpsdk/utils/MpsdkNativeUtils","getNativeAppOpenId","(Ljava/lang/String;)Ljava/lang/String;",account.openid)}catch(error){}}};CocosPlatform.prototype.getNativeAppOpenId=function(){var nativeOpenid="";try{nativeOpenid=jsb.reflection.callStaticMethod("com/qmo/game/mpsdk/utils/MpsdkNativeUtils","getNativeAppOpenId","(Ljava/lang/String;)Ljava/lang/String;","")}catch(error){}return nativeOpenid};CocosPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){if(mpsdk.Account.getOpenId()){mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}else{var nativeOpenId=_this.getNativeAppOpenId();mpsdk.log("cocoscreator receive message--getNativeAppOpenId : ",nativeOpenId);if(nativeOpenId){var account={openid:nativeOpenId};mpsdk.Account.setAccount(account)}mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}})};CocosPlatform.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{nickName:"TestNickName",avatarUrl:"",gender:-1}]})})};CocosPlatform.prototype.getSystem=function(){return{platform:cc.sys.os}};CocosPlatform.prototype.getLaunchOptions=function(){return{scene:0,query:{}}};CocosPlatform.prototype.launchTo=function(app){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};CocosPlatform.prototype.launchToSync=function(app,launchToCallback){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};CocosPlatform.prototype.share=function(shareInfo,success,fail,thisObject){mpsdk.log("测试分享，success和fail都调用，方便调试");success&&success.call(thisObject);fail&&fail.call(thisObject)};CocosPlatform.prototype.getCacheRes=function(url,waitDownload){if(waitDownload===void 0){waitDownload=false}return Promise.resolve(url)};CocosPlatform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};CocosPlatform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};CocosPlatform.prototype.clearTimeout=function(t){clearTimeout(t)};CocosPlatform.prototype.clearInterval=function(t){clearInterval(t)};CocosPlatform.prototype.checkBannerClick=function(res){throw new Error("Method not implemented.")};CocosPlatform.prototype.onHide=function(){try{mpsdk.Env.phoneModel=jsb.reflection.callStaticMethod("com/qmo/game/mpsdk/utils/MpsdkNativeUtils","getPhoneModel","()Ljava/lang/String;");mpsdk.Env.mpsdkChannel=jsb.reflection.callStaticMethod("com/qmo/game/mpsdk/utils/MpsdkNativeUtils","getMetaDataByKey","(Ljava/lang/String;)Ljava/lang/String;","MPSDK_CHANNEL")}catch(error){}};CocosPlatform.prototype.showModal=function(object){};return CocosPlatform}();mpsdk.CocosPlatform=CocosPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var H5Platform=function(){function H5Platform(){}H5Platform.prototype.writeFile=function(fileName,data){return""};H5Platform.prototype.getStorage=function(key){try{var data=window.localStorage.getItem(mpsdk.Env.storagePrefix+key);return data?JSON.parse(data):""}catch(e){return""}};H5Platform.prototype.setStorage=function(key,data){window.localStorage.setItem(mpsdk.Env.storagePrefix+key,JSON.stringify(data))};H5Platform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}var requestParams="";if(params){for(var key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return new Promise(function(resolve,reject){var request=new XMLHttpRequest;request.onreadystatechange=function(){if(request.readyState==4){if(request.status==200){try{resolve(JSON.parse(request.responseText))}catch(e){resolve(request.responseText)}}else{reject("HTTP请求失败，statusCode="+request.status)}}};if(method=="get"){request.open("GET",url);request.send()}else{request.open("POST",url);request.send(requestParams)}})};H5Platform.prototype.getUserAccount=function(launchOptions){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{openid:"debug-user-openid"}]})})};H5Platform.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{nickName:"TestNickName",avatarUrl:"",gender:-1}]})})};H5Platform.prototype.getSystem=function(){return{platform:navigator.platform}};H5Platform.prototype.getLaunchOptions=function(){return{scene:0,query:{}}};H5Platform.prototype.launchTo=function(app){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};H5Platform.prototype.launchToSync=function(app,launchToCallback){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};H5Platform.prototype.share=function(shareInfo,success,fail,thisObject){mpsdk.log("测试分享，success和fail都调用，方便调试");success&&success.call(thisObject);fail&&fail.call(thisObject)};H5Platform.prototype.getCacheRes=function(url,waitDownload){if(waitDownload===void 0){waitDownload=false}return Promise.resolve(url)};H5Platform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};H5Platform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};H5Platform.prototype.clearTimeout=function(t){clearTimeout(t)};H5Platform.prototype.clearInterval=function(t){clearInterval(t)};H5Platform.prototype.checkBannerClick=function(res){throw new Error("Method not implemented.")};H5Platform.prototype.onHide=function(){};H5Platform.prototype.showModal=function(object){};return H5Platform}();mpsdk.H5Platform=H5Platform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var TTPlatform=function(_super){__extends(TTPlatform,_super);function TTPlatform(){return _super!==null&&_super.apply(this,arguments)||this}TTPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){_this.getTTUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getTTUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getTTUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){mpsdk.log("login retry over.");reject(e)})})})})};TTPlatform.prototype.getTTUserAccountOnce=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){wx.login({force:false,success:function(loginResult){wx.getSetting({success:function(settingResult){if(settingResult.authSetting["scope.userInfo"]){wx.getUserInfo({withCredentials:true,success:function(userInfoResult){mpsdk.log("头条授权成功,继续服务器端登录 ",loginResult);var credentials={code:loginResult.code?loginResult.code:"",anonymous_code:loginResult.anonymousCode?loginResult.anonymousCode:"",encryptedData:userInfoResult.encryptedData,iv:userInfoResult.iv};_this.ttLogin(credentials,launchOptions).then(function(account){if(!account.openid){account.openid=account.anonymous_openid?account.anonymous_openid:""}resolve(account)}).catch(function(e){reject(e)})},fail:function(res){mpsdk.log("头条授权成功,但获取userinfo失败,继续服务器端登录 ",loginResult);var credentials={code:loginResult.code?loginResult.code:"",anonymous_code:loginResult.anonymousCode?loginResult.anonymousCode:"",encryptedData:"",iv:""};_this.ttLogin(credentials,launchOptions).then(function(account){if(!account.openid){account.openid=account.anonymous_openid?account.anonymous_openid:""}resolve(account)}).catch(function(e){reject(e)})}})}else{mpsdk.log("头条未授权,继续服务器端登录 ",loginResult);var credentials={code:loginResult.code?loginResult.code:"",anonymous_code:loginResult.anonymousCode?loginResult.anonymousCode:"",encryptedData:"",iv:""};_this.ttLogin(credentials,launchOptions).then(function(account){if(!account.openid){account.openid=account.anonymous_openid?account.anonymous_openid:""}resolve(account)}).catch(function(e){reject(e)})}},fail:function(res){mpsdk.log("头条授权失败,继续服务器端登录 ",loginResult,res);var credentials={code:loginResult.code?loginResult.code:"",anonymous_code:loginResult.anonymousCode?loginResult.anonymousCode:"",encryptedData:"",iv:""};_this.ttLogin(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}})},fail:function(res){mpsdk.log("头条登录失败，继续匿名登录. ",res);wx.login({force:false,success:function(loginResult){mpsdk.log("头条匿名登录成功,继续服务器端登录 ",loginResult,res);var credentials={code:loginResult.code?loginResult.code:"",anonymous_code:loginResult.anonymousCode?loginResult.anonymousCode:"",encryptedData:"",iv:""};_this.ttLogin(credentials,launchOptions).then(function(account){if(!account.openid){account.openid=account.anonymous_openid?account.anonymous_openid:""}resolve(account)}).catch(function(e){reject(e)})},fail:function(res){mpsdk.log("头条匿名登录失败. ",res);reject(res)}})}})})};TTPlatform.prototype.ttLogin=function(credentials,launchOptions){var _this=this;var accountSource=mpsdk.utils.parseAccountSource(launchOptions);return new Promise(function(resolve,reject){var data={gameId:mpsdk.Env.gameId,code:credentials.code,anonymous_code:credentials.anonymous_code,encryptedData:encodeURIComponent(credentials.encryptedData),iv:encodeURIComponent(credentials.iv),unionId:credentials.encryptedData&&credentials.iv?"true":"false",sourceType:accountSource.sourceType,sourceId:accountSource.sourceId,model:encodeURIComponent(wx.getSystemInfoSync().model)};var loginUrl=mpsdk.Env.newLoginServer+"/MiniLogin/data/getTTOpenId.action";_this.httpRequest(loginUrl,data,"get",0).then(function(res){mpsdk.log("服务端登录成功",res);if(res&&res.anonymous_openid){mpsdk.Report.reportEvent(0,res.anonymous_openid,"")}resolve(res)}).catch(function(res){mpsdk.log("服务端登录失败",res);reject(res)})})};TTPlatform.prototype.onHide=function(){};return TTPlatform}(mpsdk.MinaPlatform);mpsdk.TTPlatform=TTPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var QQminiPlatform=function(){function QQminiPlatform(){}QQminiPlatform.prototype.writeFile=function(fileName,data){if(!fileName||!data){return""}var fs=qq.getFileSystemManager();var rootDir=qq.env.USER_DATA_PATH+"/mpsdkadqq";var filePath=rootDir+"/"+fileName;try{fs.accessSync(rootDir)}catch(error){fs.mkdirSync(rootDir)}try{fs.accessSync(filePath);return filePath}catch(error){}var fileNameList=new Array;try{fileNameList=fs.readdirSync(rootDir);var nameSplitArray=fileName.split("_");var prefixName=nameSplitArray[0];for(var i=0;i<fileNameList.length;i++){var tempFileName=fileNameList[i];if(tempFileName.indexOf(prefixName+"_")==0){fs.unlinkSync(filePath);break}}}catch(error){}try{fs.writeFileSync(filePath,data,"utf-8")}catch(e){console.log("write file fail. filename:",fileName," error:",e);filePath=""}return filePath};QQminiPlatform.prototype.onHide=function(){qq.onShow(function(options){mpsdk.Report.reportAppRun(options);mpsdk.Report.reportHotLaunch(options);mpsdk.Hack.onShow()});qq.onHide(function(options){mpsdk.Hack.checkRewardedVideoAd2Back(options);var account=mpsdk.Account.getAccount();var hideOptions={gameId:mpsdk.Env.gameId,gamePath:mpsdk.Env.gamePath,openid:account.openid,unionid:account.unionid,lastLoginTime:account.lastLoginTime,createTime:account.createTime,shareTime:account.shareTime,sid:account.sid,anonymous_openid:account.anonymous_openid,options:options,launchOptions:mpsdk.Env.launchOptions};mpsdk.Hack.onHide(hideOptions)})};QQminiPlatform.prototype.getStorage=function(key){return qq.getStorageSync(mpsdk.Env.storagePrefix+key)};QQminiPlatform.prototype.setStorage=function(key,data){qq.setStorageSync(mpsdk.Env.storagePrefix+key,data)};QQminiPlatform.prototype.httpRequest=function(url,params,method,retryTimes){if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}return __awaiter(this,void 0,void 0,function(){var network,requestParams,key;return __generator(this,function(_a){switch(_a.label){case 0:return[4,new Promise(function(resolve,reject){qq.getNetworkType({success:function(res){resolve(res)},fail:function(res){reject(res)}})})];case 1:network=_a.sent();if(network.networkType=="none"){throw"当前网络不可用"}requestParams="";if(params){for(key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return[4,new Promise(function(resolve,reject){var requestOptions={url:url};if(method!="get"){requestOptions["method"]="POST";requestOptions["data"]=params}var retryCount=0;var retrySend=function(reason){if(++retryCount<=retryTimes){qq.request(requestOptions);mpsdk.log("HTTP请求重试("+retryCount+")",url);return true}reject(reason);return false};requestOptions.success=function(response){if(response.statusCode&&response.statusCode>=200&&response.statusCode<400){resolve(response.data)}else{retrySend(response)}};requestOptions.fail=function(reason){retrySend(reason)};qq.request(requestOptions)})];case 2:return[2,_a.sent()]}})})};QQminiPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){_this.getUserAccountOnce(launchOptions).then(function(account){resolve(account)}).catch(function(e){mpsdk.log("login retry over.");reject(e)})})})})};QQminiPlatform.prototype.getUserAccountOnce=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){qq.login({success:function(loginResult){qq.getSetting({success:function(settingResult){if(settingResult.authSetting["scope.userInfo"]){qq.getUserInfo({withCredentials:true,success:function(userInfoResult){mpsdk.log("QQ授权成功,继续服务器端登录 ",loginResult.code);var credentials={code:loginResult.code,encryptedData:userInfoResult.encryptedData,iv:userInfoResult.iv};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}})}else{mpsdk.log("QQ未授权,继续服务器端登录 ",loginResult.code);var credentials={code:loginResult.code,encryptedData:"",iv:""};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}},fail:function(res){mpsdk.log("QQ授权失败,继续服务器端登录 ",loginResult.code,res);var credentials={code:loginResult.code,encryptedData:"",iv:""};_this.login(credentials,launchOptions).then(function(account){resolve(account)}).catch(function(e){reject(e)})}})},fail:function(res){mpsdk.log("QQ登录失败: ",res);reject(res)}})})};QQminiPlatform.prototype.login=function(credentials,launchOptions){var _this=this;var accountSource=mpsdk.utils.parseAccountSource(launchOptions);return new Promise(function(resolve,reject){var data={gameId:mpsdk.Env.gameId,code:credentials.code,encryptedData:encodeURIComponent(credentials.encryptedData),iv:encodeURIComponent(credentials.iv),unionId:credentials.encryptedData&&credentials.iv?"true":"false",sourceType:accountSource.sourceType,sourceId:accountSource.sourceId,model:encodeURIComponent(qq.getSystemInfoSync().model)};var loginUrl=mpsdk.Env.newLoginServer+"/MiniLogin/data/getQQOpenId.action";_this.httpRequest(loginUrl,data,"get",0).then(function(res){mpsdk.log("服务端登录成功",res);resolve(res)}).catch(function(res){mpsdk.log("服务端登录失败",res);reject(res)})})};QQminiPlatform.prototype.getUserInfo=function(){return new Promise(function(resolve,reject){qq.getSetting({fail:function(res){reject()},success:function(settingResult){if(settingResult.authSetting["scope.userInfo"]){qq.getUserInfo({fail:function(res){reject()},success:function(userInfoResult){resolve(userInfoResult.userInfo)}})}else{reject()}}})})};QQminiPlatform.prototype.getSystem=function(){var sys=qq.getSystemInfoSync();return{platform:sys.platform}};QQminiPlatform.prototype.getLaunchOptions=function(){if(qq.getLaunchOptionsSync){return qq.getLaunchOptionsSync()}else{throw new Error("小程序启动参数请从app.js的onLaunch回调函数中获取")}};QQminiPlatform.prototype.launchTo=function(app){return new Promise(function(resolve,reject){if(!qq.redirectTo&&qq.getSystemInfoSync().SDKVersion<"2.2.0"){qq.previewImage({urls:[app.ad_image]});resolve();return}qq.showLoading({title:"请稍候...",mask:true});setTimeout(qq.hideLoading,5*1e3);qq.navigateToMiniProgram({appId:app.appid,path:app.page,success:function(res){qq.hideLoading();resolve();mpsdk.log("打开其他程序成功，appId=",app.appid,"path=",app.page)},fail:function(res){qq.hideLoading();if(app.ad_image&&[".jpg",".gif",".png"].indexOf(app.ad_image.substr(-4))!=-1){qq.previewImage({urls:[app.ad_image]});resolve();mpsdk.log("直接跳转失败，拉起小程序码，appId=",app.appid,"path=",app.page)}else{reject();mpsdk.log("直接跳转失败，小程序码未设置，appId=",app.appid,"path=",app.page,JSON.stringify(res))}}})})};QQminiPlatform.prototype.launchToSync=function(app,launchToCallback){};QQminiPlatform.prototype.share=function(shareInfo,success,fail,thisObject){var randomShareInfo=mpsdk.Share.genShareInfo(shareInfo);var info={};info.title=randomShareInfo.title;info.imageUrl=randomShareInfo.image;if(qq.redirectTo){info.path=mpsdk.Share.getShareLink(shareInfo.serial,shareInfo.path||"/pages/index/index",shareInfo.params||{},randomShareInfo.imageId)}else{info.query=mpsdk.Share.getShareQuery(randomShareInfo.serial,randomShareInfo.params||{},randomShareInfo.imageId)}info.success=function(res){success&&success.call(thisObject,res)};info.fail=function(res){fail&&fail.call(thisObject,res)};info.cancel=function(res){fail&&fail.call(thisObject,res)};mpsdk.Share.reportShareOut(shareInfo.serial,randomShareInfo.imageId.toString());return info};QQminiPlatform.prototype.getCacheRes=function(url,waitDownload){var _this=this;if(waitDownload===void 0){waitDownload=false}return new Promise(function(resolve,reject){if(url.substr(0,8).toLowerCase()!=="https://"){resolve(url);return}var cacheFile=qq.env.USER_DATA_PATH+"/mpsdk/"+url.substr(8);var fs=qq.getFileSystemManager();try{fs.accessSync(cacheFile);if(fs.statSync(cacheFile).isFile()){resolve(cacheFile);return}else{fs.rmdirSync(cacheFile)}}catch(e){}if(QQminiPlatform.downloadQueue.indexOf(url)>=0){resolve(url);return}!waitDownload&&resolve(url);QQminiPlatform.downloadQueue.push(url);qq.downloadFile({url:url,success:function(res){if(res.statusCode===200){_this.mkdirRecursiveSync(cacheFile.substring(0,cacheFile.lastIndexOf("/")));fs.saveFileSync(res.tempFilePath,cacheFile);waitDownload&&resolve(cacheFile)}else{waitDownload&&resolve(url)}},fail:function(){waitDownload&&resolve(url)},complete:function(){QQminiPlatform.downloadQueue.splice(QQminiPlatform.downloadQueue.indexOf(url),1)}})})};QQminiPlatform.prototype.mkdirRecursiveSync=function(dirPath){var fs=qq.getFileSystemManager();var dirLevel=dirPath.replace(qq.env.USER_DATA_PATH,"").split("/");var currentDir=qq.env.USER_DATA_PATH;for(var _i=0,dirLevel_2=dirLevel;_i<dirLevel_2.length;_i++){var dirName=dirLevel_2[_i];if(!dirName){continue}currentDir+="/"+dirName;try{fs.accessSync(currentDir);if(!fs.statSync(currentDir).isDirectory()){fs.unlinkSync(currentDir);fs.mkdirSync(currentDir,true)}}catch(e){fs.mkdirSync(currentDir,true)}}return currentDir};QQminiPlatform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};QQminiPlatform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};QQminiPlatform.prototype.clearTimeout=function(t){clearTimeout(t)};QQminiPlatform.prototype.clearInterval=function(t){clearInterval(t)};QQminiPlatform.prototype.parseShareTicket=function(shareTicket){var _this=this;return new Promise(function(resolve,reject){if(!shareTicket){reject("shareTicket required");return}qq.login({fail:function(err){reject(err)},success:function(resLogin){qq.getShareInfo({shareTicket:shareTicket,fail:function(err){reject(err)},success:function(resShareInfo){var data={gameId:mpsdk.Env.gameId,code:encodeURIComponent(resLogin.code),encryptedData:encodeURIComponent(resShareInfo.encryptedData),iv:resShareInfo.iv};_this.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/getShareInfo.action",data).then(function(resServer){if(resServer.openGId){resolve(resServer)}else{reject(resServer)}}).catch(function(err){reject(err)})}})}})})};QQminiPlatform.prototype.subscribe=function(msgId,formId,param1){var _this=this;if(param1===void 0){param1=""}return new Promise(function(resolve,reject){if(formId=="the formId is a mock one"){mpsdk.log("只能在真机环境下才能订阅模板消息");return}if(!_this.subscribeEnable(msgId)){mpsdk.log("订阅有效期内无需重复订阅");return}mpsdk.Account.getAccountSafe().then(function(account){var data={clockId:msgId,gameId:mpsdk.Env.gameId,openId:account.openid,formId:formId,parameters:param1};_this.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/regNotify.action",data).then(function(res){qq.setStorageSync("regnotify_"+msgId+"_endtime",res.time);qq.setStorageSync("regnotify_"+msgId+"_starttime",(new Date).getTime());var localDateTime=new Date(res.time).toLocaleDateString()+" "+new Date(res.time).toLocaleTimeString();mpsdk.log("注册模板消息成功",JSON.stringify(data),"有效期至",localDateTime);resolve()})})})};QQminiPlatform.prototype.subscribeEnable=function(msgId){var starttime=+qq.getStorageSync("regnotify_"+msgId+"_starttime");var endtime=+qq.getStorageSync("regnotify_"+msgId+"_endtime");var nowtime=(new Date).getTime();if(starttime<=nowtime&&nowtime<=endtime){return false}return true};QQminiPlatform.prototype.checkBannerClick=function(res){if(res&&res.scene==1038){if(res.referrerInfo&&res.referrerInfo.appId){return true}}return false};QQminiPlatform.prototype.showModal=function(object){};QQminiPlatform.downloadQueue=[];return QQminiPlatform}();mpsdk.QQminiPlatform=QQminiPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Platform=function(){function Platform(){}Object.defineProperty(Platform,"platformType",{get:function(){if(typeof BK=="object"){return"bk"}else if(typeof tt=="object"){return"tt"}else if(typeof qq=="object"){return"qq"}else if(typeof wx=="object"){return"wx"}else if(typeof egret=="object"){return"egret"}else if(typeof cc=="object"){return"cocos"}else if(typeof Laya=="object"){return"laya"}else{return"unknow"}},enumerable:true,configurable:true});Object.defineProperty(Platform,"instance",{get:function(){if(!this._instance){switch(this.platformType){case"bk":this._instance=new mpsdk.BricksPlatform;mpsdk.log("识别到玩一玩/厘米游戏平台");break;case"qq":this._instance=new mpsdk.QQminiPlatform;mpsdk.log("识别到QQ平台");break;case"tt":this._instance=new mpsdk.TTPlatform;mpsdk.log("识别到字节跳动平台");break;case"wx":this._instance=new mpsdk.MinaPlatform;mpsdk.log("识别到微信平台");break;case"egret":this._instance=new mpsdk.EgretPlatform;mpsdk.log("识别到Egret引擎");break;case"cocos":this._instance=new mpsdk.CocosPlatform;mpsdk.log("识别到Cocos引擎");break;case"laya":this._instance=new mpsdk.LayaPlatform;mpsdk.log("识别到Laya引擎");break;default:mpsdk.log("未能识别平台类型，默认当前处于H5环境");this._instance=new mpsdk.H5Platform}}return this._instance},enumerable:true,configurable:true});return Platform}();mpsdk.Platform=Platform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Account=function(){function Account(){}Account.loadBlackNames=function(){if(!this.blackNamesPromise){this.blackNamesPromise=new Promise(function(resolve,reject){if(mpsdk.Platform.platformType!="wx"){resolve();return}var black_names_ver=mpsdk.Platform.instance.getStorage("black_names_ver");var black_names_data=mpsdk.Platform.instance.getStorage("black_names_data");if(typeof black_names_data=="object"){}mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/black_names_ver.json").then(function(verData){if(!mpsdk.utils.value(verData,mpsdk.Platform.platformType)){resolve();return}if(mpsdk.utils.value(verData,mpsdk.Platform.platformType)==mpsdk.utils.value(black_names_ver,mpsdk.Platform.platformType)){resolve();return}mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/black_names_"+mpsdk.Platform.platformType+".json").then(function(res){if(typeof res=="object"){mpsdk.Platform.instance.setStorage("black_names_ver",verData);mpsdk.Platform.instance.setStorage("black_names_data",res)}resolve();return})})})}return this.blackNamesPromise};Account.setAccount=function(account){if(!account.openid){mpsdk.log("设置用户帐号失败，请至少设置openid，account=",account);return false}if(account.createTime){account.sid=account.createTime.toString().slice(2,-4)+account.openid.substr(account.openid.length-4,account.openid.length)}if(!account.unionid){account.unionid=""}if(account.unionid=='"null"'||account.unionid=="null"){account.unionid=""}mpsdk.Platform.instance.setStorage("user_account",account);mpsdk.log("更新openid成功",account.openid);return true};Account.getLastShareTime=function(){return __awaiter(this,void 0,void 0,function(){var account;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getAccountSafe()];case 1:account=_a.sent();if(account.shareTime){return[2,Number(account.shareTime)]}if(account.createTime&&new Date(account.createTime).toLocaleDateString()==(new Date).toLocaleDateString()){return[2,Math.floor(account.createTime/1e3)]}return[2,undefined]}})})};Account.getAccount=function(){var account=mpsdk.Platform.instance.getStorage("user_account");if(account&&account.openid){account.unionid=account.unionid||"";return account}return{openid:"",unionid:"",lastLoginTime:0,createTime:0}};Account.getAccountSafe=function(){var _this=this;return new Promise(function(resolve,reject){if(_this.getAccount().openid){resolve(_this.getAccount());return}var _timerInterval;var _timerTimeout;_timerInterval=mpsdk.Platform.instance.setInterval(function(){if(_this.getAccount().openid){mpsdk.Platform.instance.clearInterval(_timerInterval);mpsdk.Platform.instance.clearTimeout(_timerTimeout);resolve(_this.getAccount())}},200);_timerTimeout=mpsdk.Platform.instance.setTimeout(function(){mpsdk.Platform.instance.clearInterval(_timerInterval)},3e4)})};Account.setAccountSource=function(sourceType,sourceId){this.getAccountSafe().then(function(account){mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setAccountLogin.action",{gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,sourceType:sourceType,sourceId:sourceId}).then(function(res){mpsdk.log("上报用户来源成功","sourceType=",sourceType,"sourceId=",sourceId)})}).catch(function(){mpsdk.log("openid超时未就绪，上报用户来源失败")})};Account.setAccountInfo=function(userInfo){if(!mpsdk.utils.deepCompare(mpsdk.Platform.instance.getStorage("user_info"),userInfo)){mpsdk.Platform.instance.setStorage("user_info",userInfo);this.getAccountSafe().then(function(account){mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setAccountShow.action",{gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,show:encodeURIComponent(JSON.stringify(userInfo))}).then(function(res){mpsdk.log("上报用户信息成功")})}).catch(function(){mpsdk.log("openid超时未就绪，上报用户信息失败")})}return new Promise(function(resolve,reject){resolve(false)})};Account.setAccountProperty=function(key,val){this.getAccountSafe().then(function(account){mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/updateAccount.action",{gameid:mpsdk.Env.gameId,userid:account.openid,column:key,value:val}).then(function(res){mpsdk.log("更新账号属性成功","key=",key,"val=",val)})}).catch(function(){mpsdk.log("openid超时未就绪，更新账号属性失败")})};Account.setAccountActive=function(activeType,activeValue){var storageKey="activeType_"+activeType;if(mpsdk.Platform.instance.getStorage(storageKey)==activeValue){mpsdk.log("重复激活，不再上报数据");return}this.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid};if(activeType===mpsdk.constant.ActiveType.GET_USER_INFO){data.acceptStatus=activeValue}if(activeType===mpsdk.constant.ActiveType.START_GAME){data.startGame=activeValue}mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setAccountStatus.action",data).then(function(res){mpsdk.Platform.instance.setStorage(storageKey,activeValue);mpsdk.log("账号激活成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，账号激活失败")})};Account.saveData=function(key,val){var _this=this;return new Promise(function(resolve,reject){_this.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:key,dataValue:val};mpsdk.Platform.instance.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/saveData.action",data).then(function(res){if(res&&res.error==0){resolve();mpsdk.log("更新账号数据成功","key=",key,"val=",val)}else{reject(res);mpsdk.log("更新账号数据失败",JSON.stringify(res))}}).catch(function(){reject("网络错误")})}).catch(function(){reject("openid超时未就绪，更新账号数据失败");mpsdk.log("openid超时未就绪，更新账号数据失败")})})};Account.getData=function(key,openId){return new Promise(function(resolve,reject){Account.getAccountSafe().then(function(account){var tempOpenId=openId?openId:account.openid;var data={gameId:mpsdk.Env.gameId,openId:tempOpenId,dataKey:key};mpsdk.Platform.instance.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/getData.action",data).then(function(res){if(res&&res.error==0){resolve(res.value);mpsdk.log("获取账号数据成功",JSON.stringify(res))}else{reject(res);mpsdk.log("获取账号数据失败",JSON.stringify(res))}}).catch(function(){reject("网络错误")})}).catch(function(){reject("openid超时未就绪，更新账号数据失败");mpsdk.log("openid超时未就绪，获取账号数据失败")})})};Account.isOpenIdExist=function(){return Account.getAccount().openid?true:false};Account.isUnionIdExist=function(){return Account.getAccount().unionid?true:false};Account.getClientUUID=function(){var clientUUID=mpsdk.Platform.instance.getStorage("sdk-clent-uuid");if(clientUUID){return clientUUID}return""};Account.clearClientUUID=function(){mpsdk.Platform.instance.setStorage("sdk-clent-uuid","")};Account.getClientUserId=function(stepId){if(stepId===void 0){stepId=mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END}if(mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END<stepId&&Account.isOpenIdExist()){return Account.getOpenId()}var clientUUID=Account.getClientUUID();if(clientUUID){return clientUUID}var newClientUUID=mpsdk.utils.createClientUUID();mpsdk.Platform.instance.setStorage("sdk-clent-uuid",newClientUUID);return newClientUUID};Account.getOpenId=function(){return Account.getAccount().openid};return Account}();mpsdk.Account=Account})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Ad=function(){function Ad(){}Ad.updateUserValue=function(userValue){userValue>this.userValue&&(this.userValue=userValue)};Ad.loadAdData=function(){this.loadRecommendData();this.loadSuggestData()};Ad.loadFilterData=function(){var _this=this;return new Promise(function(resolve,reject){mpsdk.Platform.instance.getUserInfo().then(function(userInfo){resolve({os:mpsdk.Platform.instance.getSystem().platform,gender:Number(userInfo.gender),userValue:_this.userValue})}).catch(function(){resolve({os:mpsdk.Platform.instance.getSystem().platform,gender:-1,userValue:_this.userValue})})})};Ad.loadRecommendData=function(){if(!this.recommendPromise){this.recommendPromise=new Promise(function(resolve,reject){var recommendList=mpsdk.Platform.instance.getStorage("recommendList")||[];mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/ad/"+mpsdk.Env.gamePath+"/advlist.json").then(function(res){if(typeof res!="object"){mpsdk.log("加载线上浮标广告失败，服务器返回错误",res);resolve(recommendList);return}resolve(res);mpsdk.Platform.instance.setStorage("recommendList",res);mpsdk.log("加载线上浮标广告成功","共"+res.length+"条")}).catch(function(res){mpsdk.log("加载线上浮标广告失败，HTTP错误",res);resolve(recommendList)})})}return this.recommendPromise};Ad.loadSuggestData=function(){if(!this.suggestPromise){this.suggestPromise=new Promise(function(resolve,reject){var suggestList=mpsdk.Platform.instance.getStorage("suggestList")||[];mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/ad/"+mpsdk.Env.gamePath+"/version.json").then(function(verData){if(typeof verData!="object"){mpsdk.log("检查推荐列表版本失败，服务器返回错误",verData);resolve(suggestList);return}if(mpsdk.Platform.instance.getStorage("suggestVer")==verData.ver){mpsdk.log("线上推荐列表版本和本地一致，无需更新");resolve(suggestList);return}mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/ad/"+mpsdk.Env.gamePath+"/"+verData.ver).then(function(sugData){if(typeof sugData!="object"){mpsdk.log("加载线上推荐列表失败，服务器返回错误",sugData);resolve(suggestList);return}resolve(sugData);mpsdk.Platform.instance.setStorage("suggestVer",verData.ver);mpsdk.Platform.instance.setStorage("suggestList",sugData);mpsdk.log("加载线上推荐列表成功","共"+sugData.length+"条")}).catch(function(){mpsdk.log("加载线上推荐列表失败，HTTP错误");resolve(suggestList)})}).catch(function(res){mpsdk.log("检查推荐列表版本失败，HTTP错误",res);resolve(suggestList)})})}return this.suggestPromise};Ad.getBoxDataList=function(codeVer,gender,userValue,navigateToMiniProgramAppIdList){if(codeVer===void 0){codeVer=""}if(gender===void 0){gender=-1}if(userValue===void 0){userValue=0}if(navigateToMiniProgramAppIdList===void 0){navigateToMiniProgramAppIdList=[]}return __awaiter(this,void 0,void 0,function(){var cacheKey,rawData,_i,_a,item,bridge_appid,bridge_path,filterData,hackData,appIdList_1,importantCategory,j,i;return __generator(this,function(_b){switch(_b.label){case 0:if(this.boxData){return[2,this.boxData]}cacheKey="cache_data_list";return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.boxServer+"/v1/index/list?box_id="+mpsdk.Env.gameId).then(function(serverData){serverData&&mpsdk.Platform.instance.setStorage(cacheKey,serverData);return serverData}).catch(function(){return mpsdk.Platform.instance.getStorage(cacheKey)})];case 1:rawData=_b.sent();if(!rawData.category||!rawData.data){throw"获取数据失败"}for(_i=0,_a=rawData.data;_i<_a.length;_i++){item=_a[_i];bridge_appid=mpsdk.utils.getQueryString(item.page,"bridge_appid");bridge_path=mpsdk.utils.getQueryString(item.page,"bridge_path");if(bridge_appid){item.page=bridge_path+"?"+item.page.replace("bridge_appid="+bridge_appid,"bridge2appid="+item.appid).replace("bridge_path="+bridge_path,"bridge2path="+item.page.split("?")[0]).split("?")[1];item.appid=bridge_appid}}filterData={os:mpsdk.Platform.instance.getSystem().platform,gender:gender,userValue:userValue};rawData.data=rawData.data.filter(function(item){if(item.platform&&item.platform!=filterData.os&&filterData.os!="devtools"){return false}else if(item.sex&&parseInt(item.sex)!=3&&parseInt(item.sex)!=filterData.gender){return false}else if(item.uservalue&&parseInt(item.uservalue)<filterData.userValue){return false}else if(parseInt(item.table)){var p=parseInt(item.table);var r=Math.random()*100;return r<p}else{return true}});return[4,mpsdk.Hack.getOpenLevel(codeVer)];case 2:hackData=_b.sent();if(mpsdk.utils.value(hackData,"serverConfig.ipAddr","")!="221.237.157.133"){rawData.data=rawData.data.filter(function(item){return mpsdk.utils.value(item,"audi","1")!="2"})}if(hackData.codeVer==codeVer&&hackData.status=="0"){appIdList_1=[];rawData.data=rawData.data.filter(function(item){if(navigateToMiniProgramAppIdList.indexOf(item.appid)==-1){return false}if(appIdList_1.indexOf(item.appid)==-1){appIdList_1.push(item.appid);return true}return false});importantCategory=["4","5","7"];for(j=0;j<importantCategory.length;j++){for(i=j*4;i<(j+1)*4&&i<rawData.data.length;i++){rawData.data[i].category=importantCategory[j]}}}rawData.category.forEach(function(category){category.children=rawData.data.filter(function(item){return item.category==category.category})});this.boxData=rawData;this.reportShowBat(rawData.data);return[2,rawData]}})})};Ad.getRecommendInfo=function(score){var _this=this;if(score===void 0){score=0}return new Promise(function(resolve,reject){Promise.all([_this.loadRecommendData(),mpsdk.Hack.getOpenLevel(""),_this.loadFilterData()]).then(function(_a){var dataList=_a[0],hackData=_a[1],filterData=_a[2];dataList=_this.dataFilter(dataList,filterData,hackData,"icon");if(!dataList.length){reject("没有符合条件的项目");return}dataList=_this.dataFixPip(dataList,filterData.gender,filterData.userValue);var dataListPromise;if(_this.checkLimit(hackData,score)){dataListPromise=new Promise(function(resolve2,reject2){_this.loadSuggestData().then(function(suggestList){var aidList=suggestList.map(function(item){return item.aid});dataList=dataList.filter(function(item){return aidList.indexOf(item.aid)!=-1});dataList.sort(function(a,b){return parseInt(a.aid)-parseInt(b.aid)});resolve2(dataList.slice(0,3))}).catch(function(){resolve2(dataList)})})}else{dataListPromise=Promise.resolve(dataList)}dataListPromise.then(_this.dataFixCacheRes).then(function(dataList){var result=mpsdk.utils.tableAlgorithm(dataList,"table");_this.reportShowBat([result]);resolve(result)})}).catch(function(res){reject("获取浮标广告出错");mpsdk.log("获取浮标广告出错",res)})})};Ad.getSuggestList=function(original,count,score,advType){var _this=this;if(original===void 0){original=true}if(count===void 0){count=0}if(score===void 0){score=0}if(advType===void 0){advType=""}return new Promise(function(resolve,reject){Promise.all([_this.loadSuggestData(),mpsdk.Hack.getOpenLevel(""),_this.loadFilterData()]).then(function(_a){var dataList=_a[0],hackData=_a[1],filterData=_a[2];dataList=_this.dataFilter(dataList,filterData,hackData,advType);if(!dataList.length){reject("没有符合条件的项目");return}dataList=_this.dataFixPip(dataList,filterData.gender,filterData.userValue);var dataListPromise;if(_this.checkLimit(hackData,score)){dataListPromise=new Promise(function(resolve2,reject2){_this.loadRecommendData().then(function(recommendList){var aidList=recommendList.map(function(item){return item.aid});dataList=dataList.filter(function(item){return aidList.indexOf(item.aid)!=-1});dataList.sort(function(a,b){return parseInt(a.aid)-parseInt(b.aid)});resolve2(dataList.slice(0,3))}).catch(function(){resolve2(dataList)})})}else{dataListPromise=Promise.resolve(dataList)}dataListPromise.then(_this.dataFixCacheRes).then(function(dataList){var resultList=original?dataList:mpsdk.utils.tableAlgorithm(dataList,"table",false);if(count){resultList=resultList.slice(0,count)}_this.reportShowBat(resultList);resolve(resultList)})}).catch(function(res){reject("获取推荐列表出错");mpsdk.log("获取推荐列表出错",res)})})};Ad.getBannerInfo=function(score){var _this=this;if(score===void 0){score=0}return new Promise(function(resolve,reject){Promise.all([_this.loadSuggestData(),mpsdk.Hack.getOpenLevel(""),_this.loadFilterData()]).then(function(_a){var dataList=_a[0],hackData=_a[1],filterData=_a[2];dataList=_this.dataFilter(dataList,filterData,hackData,"mp_banner");if(!dataList.length){reject("没有符合条件的项目");mpsdk.log("没有符合条件的banner广告.");return}dataList=_this.dataFixPip(dataList,filterData.gender,filterData.userValue);var dataListPromise;if(_this.checkLimit(hackData,score)){dataListPromise=new Promise(function(resolve2,reject2){reject2()})}else{dataListPromise=Promise.resolve(dataList)}dataListPromise.then(_this.dataFixCacheRes).then(function(dataList){var result=mpsdk.utils.tableAlgorithm(dataList,"table");_this.reportShowBat([result]);resolve(result)}).catch(function(e){reject("审核状态下,屏蔽banner广告.");mpsdk.log("审核状态下,屏蔽banner广告.")})}).catch(function(res){reject("获取banner广告出错");mpsdk.log("获取banner广告出错",res)})})};Ad.getExcitationList=function(original,count,score){if(original===void 0){original=true}if(count===void 0){count=0}if(score===void 0){score=0}return this.getSuggestList(original,count,score,"excitation")};Ad.checkLimit=function(hackData,score){var result=mpsdk.Hack.checkAdTimeLimit(hackData)&&mpsdk.Hack.checkAdCityLimit(hackData)&&mpsdk.Hack.checkAdScoreLimit(hackData,score);mpsdk.log("审查时段",hackData.link_time,"审查城市",hackData.link_city,"审查分值",hackData.link_enable_level||"1");mpsdk.log("当前时段",(new Date).getHours(),"当前城市",mpsdk.utils.value(hackData,"ipArea.city"),"当前分值",score);mpsdk.log("审查结果",result);return result};Ad.dataFilter=function(dataList,filterData,hackData,advType){var _this=this;if(advType===void 0){advType=""}return dataList.filter(function(item){if(item.platform&&filterData.os&&item.platform!=filterData.os&&filterData.os!="devtools"){return false}else if(item.sex&&item.sex!=3&&item.sex!=filterData.gender){return false}else if(item.audi&&item.audi=="2"&&(!hackData.ipAddr||hackData.ipAddr!="221.237.157.133")){return false}if(_this.checkCityInvisible(hackData,item.city_hide)){mpsdk.log("广告屏蔽城市过滤：",item.city_hide," ; 被过滤广告id:",item.adid);return false}if(!_this.checkCityVisible(hackData,item.city_show)){mpsdk.log("广告可见城市过滤：",item.city_show," ; 被过滤广告id:",item.adid);return false}if(advType=="banner"&&item.category!==2){return false}else if(advType=="icon"&&item.category!==2){return false}else if(advType=="video"&&item.category!==3){return false}else if(advType=="excitation"&&item.category!==12){return false}else if(advType=="mp_banner"&&item.category!==13){return false}if(!advType&&item.category==12){return false}if(!advType&&item.category==13){return false}return true})};Ad.checkCityVisible=function(hackData,city){var currentProvince=mpsdk.utils.value(hackData,"ipArea.province");var currentCity=mpsdk.utils.value(hackData,"ipArea.city");return(!city||city=="all")&&!mpsdk.utils.checkAbroadCity(hackData)||city&&currentCity&&city.indexOf(currentCity)!=-1||city&&currentProvince&&city.indexOf(currentProvince)!=-1};Ad.checkCityInvisible=function(hackData,city){var currentProvince=mpsdk.utils.value(hackData,"ipArea.province");var currentCity=mpsdk.utils.value(hackData,"ipArea.city");return city=="all"||mpsdk.utils.checkAbroadCity(hackData)||city&&currentCity&&city.indexOf(currentCity)!=-1||city&&currentProvince&&city.indexOf(currentProvince)!=-1};Ad.dataFixPip=function(dataList,gender,userValue){var iterationList=JSON.parse(JSON.stringify(dataList));for(var _i=0,iterationList_1=iterationList;_i<iterationList_1.length;_i++){var item=iterationList_1[_i];if(!item.start_time||!item.end_time||!item.plan_number){item.page+=item.page.indexOf("?")==-1?"?":"&";item.page+="type=link&adid="+item.adid+"&gender="+gender+"&uservalue="+userValue}var bridge_appid=mpsdk.utils.getQueryString(item.page,"bridge_appid");var bridge_path=mpsdk.utils.getQueryString(item.page,"bridge_path");if(bridge_appid){item.page=bridge_path+"?"+item.page.replace("bridge_appid="+bridge_appid,"bridge2appid="+item.appid).replace("bridge_path="+bridge_path,"bridge2path="+item.page.split("?")[0]).split("?")[1];item.appid=bridge_appid}if(item.ad_image&&item.ad_image.indexOf("http")!=0){item.ad_image=mpsdk.Env.cdnServer+"/ad/images/"+item.ad_image}if(item.icon&&item.icon.indexOf("http")!=0){item.icon=mpsdk.Env.cdnServer+"/ad/images/"+item.icon}if(item.image&&item.image.indexOf("http")!=0){item.image=mpsdk.Env.cdnServer+"/ad/images/"+item.image}if(item.banner&&item.banner.indexOf("http")!=0){item.banner=mpsdk.Env.cdnServer+"/ad/images/"+item.banner}if(item.atlas_photo&&item.atlas_photo.indexOf("http")!=0){item.atlas_photo=mpsdk.Env.cdnServer+"/atlas/"+item.atlas_photo}if(item.atlas_config&&item.atlas_config.indexOf("http")!=0){item.atlas_config=mpsdk.Env.cdnServer+"/atlas/"+item.atlas_config}if(item.title_bg&&item.title_bg.indexOf("http")!=0){item.title_bg=mpsdk.Env.cdnServer+"/bgtext/"+item.title_bg}item.clicked=!this.checkClickRecord(Number(item.adid));if(item.clicked){item.table=Number(item.table)/2}}return iterationList};Ad.dataFixCacheRes=function(dataList){return __awaiter(this,void 0,void 0,function(){var i,_a,_b,_c,_d,atlas_photo,_e,title_bg,_f;return __generator(this,function(_g){switch(_g.label){case 0:i=0;_g.label=1;case 1:if(!(i<dataList.length))return[3,14];if(!dataList[i].ad_image)return[3,3];_a=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(dataList[i].ad_image,false)];case 2:_a.ad_image=_g.sent();_g.label=3;case 3:if(!dataList[i].icon)return[3,5];_b=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(dataList[i].icon,false)];case 4:_b.icon=_g.sent();_g.label=5;case 5:if(!dataList[i].image)return[3,7];_c=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(dataList[i].image,false)];case 6:_c.image=_g.sent();_g.label=7;case 7:if(!dataList[i].banner)return[3,9];_d=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(dataList[i].banner,false)];case 8:_d.banner=_g.sent();_g.label=9;case 9:atlas_photo=dataList[i].atlas_photo;if(!atlas_photo)return[3,11];_e=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(atlas_photo,false)];case 10:_e.atlas_photo=_g.sent();_g.label=11;case 11:title_bg=dataList[i].title_bg;if(!title_bg)return[3,13];_f=dataList[i];return[4,mpsdk.Platform.instance.getCacheRes(title_bg,false)];case 12:_f.title_bg=_g.sent();_g.label=13;case 13:i++;return[3,1];case 14:return[2,dataList]}})})};Ad.reportShowBat=function(appList){mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var gameId=[],adId=[],params=[];for(var _i=0,appList_1=appList;_i<appList_1.length;_i++){var appItem=appList_1[_i];gameId[gameId.length]=appItem.aid;adId[adId.length]=appItem.adid||appItem.id;params[params.length]=appItem.category.toString()}var data={gameid:mpsdk.Env.gameId,userid:account.openid,show_game_id:gameId.join(","),show_ad_id:adId.join(","),param1:params.join(",")};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer2+"/MiniGameLog/log/showEvent2.action",data).then(function(res){mpsdk.log("批量上报展示事件成功","共"+gameId.length+"条数据",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报展示日志失败")})};Ad.reportShow=function(appItem){this.reportShowBat([appItem])};Ad.reportClick=function(appItem,serial){if(serial===void 0){serial=0}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,link_to_game_id:appItem.aid,link_ad_id:appItem.adid||appItem.id,param1:serial};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer2+"/MiniGameLog/log/linkEvent.action",data).then(function(res){mpsdk.log("上报点击事件成功",appItem.title,JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报展示日志失败")})};Ad.click=function(appItem,serial,returnPromise){var _this=this;if(serial===void 0){serial=0}if(returnPromise===void 0){returnPromise=false}var clickPromise=new Promise(function(resolve,reject){wx.getNetworkType({success:function(res){if(res.networkType=="none"){wx.showToast({title:"网络已断开，无法跳转...",icon:"none"});reject();return}_this.reportClick(appItem,serial);mpsdk.Platform.instance.launchTo(appItem).then(function(res){resolve(_this.checkClickRecord(Number(appItem.adid),true))}).catch(function(res){reject()})},fail:function(){reject()}})});if(returnPromise){return clickPromise}return this.checkClickRecord(Number(appItem.adid),true)};Ad.clickSync=function(appItem,serial,clickCallback){var _this=this;if(serial===void 0){serial=0}var isFirstClick=this.checkClickRecord(Number(appItem.adid),true);var mIsLaunchToSuccess=false;wx.getNetworkType({success:function(res){if(res.networkType=="none"){wx.showToast({title:"网络已断开，无法跳转...",icon:"none"});mIsLaunchToSuccess=false;if(clickCallback){clickCallback(mIsLaunchToSuccess,isFirstClick);return}}else{_this.reportClick(appItem,serial);mpsdk.Platform.instance.launchToSync(appItem,function(isLaunchToSuccess){mIsLaunchToSuccess=isLaunchToSuccess;if(clickCallback){clickCallback(mIsLaunchToSuccess,isFirstClick);return}})}},fail:function(){mIsLaunchToSuccess=false;if(clickCallback){clickCallback(mIsLaunchToSuccess,isFirstClick);return}}});return isFirstClick};Ad.checkClickRecord=function(adid,save){if(save===void 0){save=false}var isFirstClick=false;var record=mpsdk.Platform.instance.getStorage("adClickRecord")||[];if(record.indexOf(adid)==-1){isFirstClick=true;if(save){record.push(adid);mpsdk.Platform.instance.setStorage("adClickRecord",record)}}return isFirstClick};Ad.trackAdConversion=function(options,pagePath){var _this=this;mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var actionType="";if(account.lastLoginTime==0){actionType="REGISTER"}else if(_this.checkSecondaryRetention(account.createTime)){actionType="START_APP"}if(!actionType){return}var url="";var tempUrl="gdt_vid="+options.gdt_vid+"&weixinadinfo="+options.weixinadinfo;var aid=0;if(options.weixinadinfo){var weixinadinfoArr=options.weixinadinfo.split(".");aid=weixinadinfoArr[0]}console.log("来源广告的广告id是:"+aid);if(pagePath){url=pagePath+"&"+tempUrl}else{url=tempUrl}var pid=mpsdk.Env.gameId;var openid=account.openid;var source="";if(mpsdk.Env.launchOptions.query.adid){source=mpsdk.Env.launchOptions.query.adid}var data={product_id:pid,openid:openid,action_type:actionType,url:url,source:source};mpsdk.log("上报广告转化事件参数",data);mpsdk.Platform.instance.httpRequest(mpsdk.Env.trackAdServer+"/v1/adv/return",data,"post").then(function(res){mpsdk.log("上报广告转化事件成功",res,JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报广告转化事件失败")})};Ad.checkSecondaryRetention=function(createTime){var date=new Date;var year=date.getFullYear();var month=date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1;var day=date.getDate()<10?"0"+date.getDate():date.getDate();var todayBegin=year+"/"+month+"/"+day+" 00:00:00";var todayEnd=year+"/"+month+"/"+day+" 23:59:59";var yesterdayBeginTime=Date.parse(todayBegin)-1e3*3600*24;var yesterdayEndTime=Date.parse(todayEnd)-1e3*3600*24;return createTime>=yesterdayBeginTime&&createTime<=yesterdayEndTime};Ad.showRewardedVideoAdDialog=function(dialogMsg,showDialogDelayTime){if(dialogMsg===void 0){dialogMsg="️️️⬇⬇⬇点击下方绿色按钮获得3倍奖励"}if(showDialogDelayTime===void 0){showDialogDelayTime=5}mpsdk.Env.isClickRewardedVideoAdDialogOk=false;mpsdk.Env.isRewardedVideoAdDialogShow=false;mpsdk.Env.isRewardedVideoAd2Back=false;Promise.all([mpsdk.Hack.getOpenLevel("")]).then(function(_a){var hackData=_a[0];if(hackData.level=="0"){mpsdk.log("level=0；激励广告提示框不会弹出。");return}if(!mpsdk.Hack.isStrongFission()){return}if(mpsdk.Hack.checkCityLimit(hackData,"video_ad_city")){return}if(!Ad.checkVideoAdShowByHitProb(hackData)){return}var showModalObject={content:dialogMsg,success:function(res){mpsdk.Env.isClickRewardedVideoAdDialogOk=true;if(res.confirm){mpsdk.Report.reportEvent(123463);mpsdk.log("上报激励广告提示框点击确认事件,ID=123463")}else if(res.cancel){mpsdk.Report.reportEvent(123462);mpsdk.log("上报激励广告提示框点击取消事件,ID=123462")}},fail:function(res){mpsdk.log("激励广告确认框事件：fail:",res)}};Ad.crrentTimeout=mpsdk.Platform.instance.setTimeout(function(){mpsdk.Env.isRewardedVideoAdDialogShow=true;mpsdk.Report.reportEvent(123461);mpsdk.log("上报激励广告弹出提示框事件,ID=123461");mpsdk.Platform.instance.showModal(showModalObject)},showDialogDelayTime*1e3)})};Ad.getRewardedVideoAdClickStatus=function(){if(this.crrentTimeout){mpsdk.Platform.instance.clearTimeout(this.crrentTimeout);this.crrentTimeout=null}mpsdk.Env.isRewardedVideoAdDialogShow=false;if(!mpsdk.Env.isClickRewardedVideoAdDialogOk){return false}mpsdk.Env.isClickRewardedVideoAdDialogOk=false;return mpsdk.Env.isRewardedVideoAd2Back};Ad.checkVideoAdShowByHitProb=function(hackData){if(!hackData["video_ad_show_prob"]){return false}if(hackData["video_ad_show_prob"]=="0"){mpsdk.log("激励广告提示框弹出概率；概率:0");return false}if(hackData["video_ad_show_prob"]=="100"){mpsdk.log("激励广告提示框弹出概率；概率:100");return true}if(isNaN(hackData["video_ad_show_prob"])){return false}var myRandom=Math.random()*100;var prob=Number(hackData["video_ad_show_prob"]);mpsdk.log("激励广告提示框弹出概率；概率:",prob,";目标值:",myRandom);if(myRandom<=prob){return true}return false};Ad.userValue=0;return Ad}();mpsdk.Ad=Ad})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var EngineUtility=function(){function EngineUtility(){}EngineUtility.assert=function(value){var message=[];for(var _i=1;_i<arguments.length;_i++){message[_i-1]=arguments[_i]}if(!value&&this.bIsDebug){var reason="EngineAssert";if(message.length>0){var key=message[0];message.shift();reason=EngineUtility.fmt(key,message)}console.error(reason);debugger;throw new Error(reason)}};EngineUtility.fmt=function(key){var argv=[];for(var _i=1;_i<arguments.length;_i++){argv[_i-1]=arguments[_i]}if(argv.length>0){return vsprintf(key,argv)}else{return key}};EngineUtility.EncodeNumberToUtf8Character=function(index){var minUtf8Char=19968;var maxUtf8Char=40869;var utf8Range=maxUtf8Char-minUtf8Char;var ret="";if(index>utf8Range){var firstPart=String(Math.floor(index/utf8Range));var secondPart=String(index%utf8Range);var firstIndex=Number(firstPart);var secondIndex=Number(secondPart);EngineUtility.assert(firstIndex<=utf8Range);EngineUtility.assert(secondIndex<=utf8Range);ret=String.fromCharCode(minUtf8Char+firstIndex)+String.fromCharCode(minUtf8Char+secondIndex)}else{ret=String.fromCharCode(minUtf8Char+index)}return ret};EngineUtility.DecodeUtf8CharacterToNumber=function(str){var minUtf8Char=19968;var maxUtf8Char=40869;var utf8Range=maxUtf8Char-minUtf8Char;var ret=-1;if(str.length==1){var index=str.charCodeAt(0);ret=index-minUtf8Char}else if(str.length==2){var first=str.charCodeAt(0)-minUtf8Char;var second=str.charCodeAt(1)-minUtf8Char;ret=Number(String(first))*utf8Range+Number(String(second))}return ret};EngineUtility.bIsDebug=true;EngineUtility.randomSeed=0;EngineUtility.enablePerformDetect=false;EngineUtility.performData=[];EngineUtility.lastResetTime=0;EngineUtility.silencePerformMode=true;EngineUtility.renderSubmitLog=false;EngineUtility.InitCallback=[];EngineUtility.enableMultiTextureSampler=true;EngineUtility.enableSpriteOutline=true;EngineUtility.enableHitRectOutline=true;return EngineUtility}();mpsdk.EngineUtility=EngineUtility})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Hack=function(){function Hack(){}Hack.outRequest=function(){this.outPermission=true};Object.defineProperty(Hack,"outCheckEnable",{set:function(value){if(value){wx.offHide(this.outCheck.bind(this));wx.onHide(this.outCheck.bind(this))}else{wx.offHide(this.outCheck.bind(this))}},enumerable:true,configurable:true});Hack.outCheck=function(){if(mpsdk.Platform.platformType!="wx"||wx.redirectTo){return}if(this.outPermission){this.outPermission=false;return}while(!this.outPermission){wx.exitMiniProgram({success:function(res){mpsdk.log(res)},fail:function(res){mpsdk.log(res)}})}};Hack.getOpenLevel=function(codeVer,gameId){var _this=this;mpsdk.Env.codeVer=codeVer?codeVer:"";gameId=gameId||mpsdk.Env.gameId;var p=new Promise(function(resolve,reject){if(!gameId){mpsdk.log("获取功能限制级别失败，默认启用高级限制保护（请先初始化SDK或传入gameId参数）");resolve({level:"0"});mpsdk.Env.openLevelData={level:"0"};return}if(!_this.serverConfigPromise){_this.serverConfigPromise=mpsdk.Platform.instance.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/getIp.action?gameId="+gameId)}_this.serverConfigPromise.then(function(res){if(!res.open){mpsdk.log("获取功能限制级别失败，默认启用高级限制保护（服务端参数未设置）");resolve({level:"0"});mpsdk.Env.openLevelData={level:"0"};return}var data;try{data=JSON.parse(res.open);data.ipArea={country:mpsdk.utils.value(res,"country",""),province:mpsdk.utils.value(res,"province",""),city:mpsdk.utils.value(res,"city","")};data.ipAddr=mpsdk.utils.value(res,"ip","")}catch(e){mpsdk.log("获取功能限制级别失败，默认启用高级限制保护（解析服务端参数错误）");resolve({level:"0"});mpsdk.Env.openLevelData={level:"0"};return}if(data.codeVer==codeVer&&data.status=="0"){mpsdk.log("当前应用版本受到高级限制保护");data.level="0";resolve(data);mpsdk.Env.openLevelData=data;return}if(res.check===0){mpsdk.log("当前地域受到高级限制保护");data.level="0";resolve(data);mpsdk.Env.openLevelData=data;return}var hour=(new Date).getHours();for(var key in data){var match=/^time(\d+)-(\d+)$/.exec(key);if(match&&data[key]=="0"&&Number(match[1])<=hour&&hour<=Number(match[2])){mpsdk.log("当前时段受到中级限制保护");data.level="1";resolve(data);mpsdk.Env.openLevelData=data;return}}mpsdk.log("当前处于低级保护");data.level="2";resolve(data);mpsdk.Env.openLevelData=data}).catch(function(){mpsdk.log("获取功能限制级别失败，默认启用高级限制保护（拉取服务端配置失败）");resolve({level:"0"});mpsdk.Env.openLevelData={level:"0"}})});if(codeVer){p.then(function(res){_this.appStatus=res;return res})}return p};Hack.checkAdTimeLimit=function(hackData){var timeLimit=false;if(hackData.link_time){var _a=hackData.link_time.indexOf("_")>0?hackData.link_time.split("_",2):hackData.link_time.split("-",2),timeStart=_a[0],timeEnd=_a[1];var hour=(new Date).getHours();if(parseInt(timeStart||"0")<=hour&&hour<=parseInt(timeEnd||"24")){timeLimit=true}}return timeLimit};Hack.checkAdCityLimit=function(hackData){var currentProvince=mpsdk.utils.value(hackData,"ipArea.province");var currentCity=mpsdk.utils.value(hackData,"ipArea.city");return hackData.link_city=="all"||mpsdk.utils.checkAbroadCity(hackData)||hackData.link_city&&currentCity&&hackData.link_city.indexOf(currentCity)!=-1||hackData.link_city&&currentProvince&&hackData.link_city.indexOf(currentProvince)!=-1};Hack.checkAdScoreLimit=function(hackData,score){return score<parseInt(hackData.link_enable_level||"1")};Hack.isStrongFission=function(fromAppId){if(fromAppId===void 0){fromAppId="wxcff7381e631cf54e"}if(mpsdk.Env.launchOptions&&mpsdk.Env.launchOptions.scene=="1037"&&mpsdk.Env.launchOptions.referrerInfo&&fromAppId==mpsdk.Env.launchOptions.referrerInfo.appId){mpsdk.log("小游戏助手进入，不可强烈变");return false}if(mpsdk.Env.launchOptions&&1048==mpsdk.Env.launchOptions.scene&&(!mpsdk.Env.launchOptions.query||!mpsdk.Env.launchOptions.query.type)){mpsdk.log("本地强烈变检查：长按图片识别小程序码进入, 不可强烈变；当前场景值：",mpsdk.Env.launchOptions.scene);return false}var senceArray=[1e3,1005,1006,1011,1012,1013,1017,1025,1027,1030,1031,1032,1042,1047,1049,1053,1054,1084,1106,2001,2970];var isLoaclStrongFission=senceArray.indexOf(mpsdk.Env.launchOptions.scene)==-1;if(!isLoaclStrongFission){mpsdk.log("本地强烈变检查：不可强烈变；当前场景值：",mpsdk.Env.launchOptions.scene);return false}var serverSence=mpsdk.Account.getAccount().sourceId?Number(mpsdk.Account.getAccount().sourceId):0;if(1048==serverSence){mpsdk.log("服务器端强烈变检查：长按图片识别小程序码进入，不可强烈变"," ; 当前场景值：",serverSence," ; 当前本地场景值：",mpsdk.Env.launchOptions.scene);return false}var isServerStrongFission=senceArray.indexOf(serverSence)==-1;mpsdk.log("服务器端强烈变检查：强烈变状态：",isServerStrongFission," ; 当前场景值：",serverSence," ; 当前本地场景值：",mpsdk.Env.launchOptions.scene);return isServerStrongFission};Hack.checkShareCityLimit=function(hackData){var currentProvince=mpsdk.utils.value(hackData,"ipArea.province");var currentCity=mpsdk.utils.value(hackData,"ipArea.city");return hackData.sharemodecity=="all"||mpsdk.utils.checkAbroadCity(hackData)||hackData.sharemodecity&&currentCity&&hackData.sharemodecity.indexOf(currentCity)!=-1||hackData.sharemodecity&&currentProvince&&hackData.sharemodecity.indexOf(currentProvince)!=-1};Hack.checkCityLimit=function(hackData,cityKey){var currentProvince=mpsdk.utils.value(hackData,"ipArea.province");var currentCity=mpsdk.utils.value(hackData,"ipArea.city");mpsdk.log("目标城市：",hackData[cityKey]," ; 当前城市：",currentCity);return hackData[cityKey]=="all"||mpsdk.utils.checkAbroadCity(hackData)||hackData[cityKey]&&currentCity&&hackData[cityKey].indexOf(currentCity)!=-1||hackData[cityKey]&&currentProvince&&hackData[cityKey].indexOf(currentProvince)!=-1};Hack.onHide=function(hideOptions){mpsdk.log("[onHide] hideOptions : ",hideOptions);var that=this;var options=hideOptions.options;if(!options||!options.targetAction||options.targetAction!=8||!options.targetPagePath){return}var targetPagePathArray=["NewWAProfileViewController","com.tencent.mm.plugin.appbrand.ui.AppBrandProfileUI"];if(targetPagePathArray.indexOf(options.targetPagePath)==-1){return}var openStatus=mpsdk.Env.openLevelData;if(!openStatus){return}if(openStatus.ipAddr){var date=new Date;that.lastOnHideTime=date.getTime();that.isIntoAboutPage=true;mpsdk.Report.reportEvent(12345,openStatus.ipAddr);mpsdk.log("上报用户进入关于页面事件,ID=12345 ， ip:",openStatus.ipAddr)}return;if(openStatus.level=="0"){}else{if(that.checkHideStatus(openStatus)){mpsdk.log("[onHide] openStatus:",openStatus);mpsdk.log("[onHide] status is true");while(true){var s="";for(var i=0;i<Number.MAX_VALUE;i++){s=s+i}}}}};Hack.onShow=function(){if(!Hack.isIntoAboutPage){return}Hack.isIntoAboutPage=false;var openStatus=mpsdk.Env.openLevelData;if(!openStatus){return}if(openStatus.ipAddr){var date=new Date;var diffTime=(date.getTime()-Hack.lastOnHideTime)/1e3;mpsdk.Report.reportEvent(123451,openStatus.ipAddr,diffTime+"");mpsdk.log("上报用户进入关于页面事件,ID=123451 ， ip:",openStatus.ipAddr,", 耗时[s]：",diffTime)}};Hack.checkHideStatus=function(hideStatus){if(!hideStatus.sdk_hide_status||hideStatus.sdk_hide_status=="0"){return false}if(hideStatus.sdk_hide_status=="1"&&!hideStatus.sdk_hide_time){return true}var currentDate=(new Date).getHours();var hidetimes=hideStatus.sdk_hide_time;var hidetimeArray=hidetimes.split("-");var begin=Number(hidetimeArray[0]);var end=hidetimeArray[1]?Number(hidetimeArray[1]):24;if(currentDate<begin||currentDate>end){return false}return true};Hack.checkRewardedVideoAd2Back=function(options){if(!options){return}if(!mpsdk.Env.isRewardedVideoAdDialogShow){return}if(options.targetPagePath){mpsdk.Env.isRewardedVideoAd2Back=true;mpsdk.Env.isRewardedVideoAdDialogShow=false;mpsdk.Report.reportEvent(123464);mpsdk.log("上报激励广告切换后台事件,ID=123464");return}if("ios"==mpsdk.Platform.instance.getSystem().platform){if(!options.targetPagePath){mpsdk.Env.isRewardedVideoAd2Back=true;mpsdk.Env.isRewardedVideoAdDialogShow=false;mpsdk.Report.reportEvent(123464);mpsdk.log("上报激励广告切换后台事件,ID=123464")}}};Hack.outPermission=false;Hack.isIntoAboutPage=false;Hack.lastOnHideTime=0;return Hack}();mpsdk.Hack=Hack})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var LayaPlatform=function(){function LayaPlatform(){}LayaPlatform.prototype.writeFile=function(fileName,data){return""};LayaPlatform.prototype.getStorage=function(key){try{var data=window.localStorage.getItem(mpsdk.Env.storagePrefix+key);return data?JSON.parse(data):""}catch(e){return""}};LayaPlatform.prototype.setStorage=function(key,data){window.localStorage.setItem(mpsdk.Env.storagePrefix+key,JSON.stringify(data))};LayaPlatform.prototype.httpRequest=function(url,params,method,retryTimes){var _this=this;if(method===void 0){method="get"}if(retryTimes===void 0){retryTimes=2}var requestParams="";if(params){for(var key in params){requestParams+=key+"="+params[key]+"&"}if(requestParams){requestParams=requestParams.substr(0,requestParams.length-1);if(method=="get"){url+=url.indexOf("?")==-1?"?":"&";url+=requestParams}}}return new Promise(function(resolve,reject){var responseHandler=function(data){try{resolve(JSON.parse(data))}catch(e){resolve(data)}};var errorHandler=function(event){};var xhr=new Laya.HttpRequest;xhr.once(Laya.Event.COMPLETE,_this,responseHandler);xhr.once(Laya.Event.ERROR,_this,errorHandler);if(method=="get"){xhr.send(url,"","get","text")}else{xhr.send(url,requestParams,"post","text")}})};LayaPlatform.prototype.writeOpenId2Native=function(account){if(account&&account.openid){try{this.MpsdkNativeUtils.call("getNativeAppOpenId",account.openid)}catch(error){}}};LayaPlatform.prototype.getNativeAppOpenId=function(){var nativeOpenid="";try{nativeOpenid=this.MpsdkNativeUtils.call("getNativeAppOpenId","")}catch(error){}return nativeOpenid};LayaPlatform.prototype.getUserAccount=function(launchOptions){var _this=this;return new Promise(function(resolve,reject){if(mpsdk.Account.getOpenId()){mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}else{var nativeOpenId=_this.getNativeAppOpenId();mpsdk.log("laya receive message--getNativeAppOpenId : ",nativeOpenId);if(nativeOpenId){var account={openid:nativeOpenId};mpsdk.Account.setAccount(account)}mpsdk.utils.nativeAppLogin(launchOptions).then(function(account){_this.writeOpenId2Native(account);resolve(account)}).catch(function(e){reject(e)})}})};LayaPlatform.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{nickName:"TestNickName",avatarUrl:"",gender:-1}]})})};LayaPlatform.prototype.getSystem=function(){return{platform:"debugPlatform"}};LayaPlatform.prototype.getLaunchOptions=function(){return{scene:0,query:{}}};LayaPlatform.prototype.launchTo=function(app){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};LayaPlatform.prototype.launchToSync=function(app,launchToCallback){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){mpsdk.log("打开其他程序，appId=",app.appid,"path=",app.page);return[2]})})};LayaPlatform.prototype.share=function(shareInfo,success,fail,thisObject){mpsdk.log("测试分享，success和fail都调用，方便调试");success&&success.call(thisObject);fail&&fail.call(thisObject)};LayaPlatform.prototype.setTimeout=function(callback,timeout){return setTimeout(callback,timeout)};LayaPlatform.prototype.setInterval=function(callback,timeout){return setInterval(callback,timeout)};LayaPlatform.prototype.clearTimeout=function(t){clearTimeout(t)};LayaPlatform.prototype.clearInterval=function(t){clearInterval(t)};LayaPlatform.prototype.getCacheRes=function(url,waitDownload){if(waitDownload===void 0){waitDownload=false}return Promise.resolve(url)};LayaPlatform.prototype.checkBannerClick=function(res){return false};LayaPlatform.prototype.onHide=function(){try{this.MpsdkNativeUtils=Laya.PlatformClass.createClass("com.qmo.game.mpsdk.utils.MpsdkNativeUtils");mpsdk.Env.phoneModel=this.MpsdkNativeUtils.call("getPhoneModel");mpsdk.Env.mpsdkChannel=this.MpsdkNativeUtils.call("getMetaDataByKey","MPSDK_CHANNEL")}catch(error){}};LayaPlatform.prototype.showModal=function(object){};return LayaPlatform}();mpsdk.LayaPlatform=LayaPlatform})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Quiz=function(){function Quiz(){}Quiz.uploadCustomizeQuiz=function(showInfo,quiz){if(!quiz){mpsdk.log("上传自定义题目失败:题目内容为空");return}mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,show:showInfo?showInfo:"",quiz:quiz};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/uploadQuiz.action",data,"POST").then(function(res){mpsdk.log("上传自定义题目成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上传自定义题目失败")})};Quiz.getRandomQuiz=function(){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getCustomizeQuiz.action",data).then(function(res){resolve(res);mpsdk.log("获取随机题目结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，获取随机题目失败")})})};Quiz.getQuizRank=function(openId){return new Promise(function(resolve,reject){if(!openId){mpsdk.log("题库作者openid未就绪，获取答题排行失败");return}var data={gameId:mpsdk.Env.gameId,openId:openId};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getQuizRank.action",data).then(function(res){resolve(res);mpsdk.log("获取答题排行结果",JSON.stringify(res))})})};Quiz.uploadAnswerQuizScore=function(quizAuthorId,score,showInfo){if(!quizAuthorId){mpsdk.log("上报答题分数失败:题目作者openid为空");return}mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,quizOpenId:quizAuthorId,score:score,show:showInfo};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/answerQuiz.action",data).then(function(res){mpsdk.log("上报答题分数成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报答题分数失败")})};return Quiz}();mpsdk.Quiz=Quiz})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Report=function(){function Report(){}Report.reportAppRun=function(options){if(options.query.type=="share"){this.reportShareIn(options.query.shareid,options.query.userid,options.shareTicket||"",options.query.shareinfoid||"")}else if(options.query.type=="wxad"){this.reportAdIn(options.query.adid,options.query.gdt_vid,options.query.weixinadinfo)}else if(options.query.type){this.reportLinkIn(options.query.adid,options.referrerInfo?options.referrerInfo.appId:"")}};Report.reportLogin=function(gold,level,leveltype){if(gold===void 0){gold=0}if(level===void 0){level=0}if(leveltype===void 0){leveltype=0}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,gold:gold,level_kt:level,level_jl:leveltype};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/login.action",data).then(function(res){mpsdk.log("上报login事件成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报login事件失败")})};Report.reportGold=function(changeGold,newGold,param1,reason){if(changeGold===void 0){changeGold=0}if(newGold===void 0){newGold=0}if(param1===void 0){param1=""}if(reason===void 0){reason=0}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,change_gold:changeGold,new_gold:newGold,param1:param1,reason:reason};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/gold.action",data).then(function(res){mpsdk.log("上报金币变化成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报金币变化失败")})};Report.reportEvent=function(eventId,param1,param2){if(eventId===void 0){eventId=0}if(param1===void 0){param1=""}if(param2===void 0){param2=""}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,eventid:eventId,param1:encodeURIComponent(param1),param2:encodeURIComponent(param2)};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/event.action",data).then(function(res){mpsdk.log("上报事件日志成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报事件日志失败")})};Report.reportEventVideoAdShow=function(adUnitId){if(adUnitId===void 0){adUnitId=""}this.reportEvent(999331,adUnitId)};Report.reportEventVideoAdEnd=function(adUnitId){if(adUnitId===void 0){adUnitId=""}this.reportEvent(999332,adUnitId)};Report.reportShareIn=function(shareId,shareUser,shareTicket,param1){if(param1===void 0){param1=""}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,from_share_id:shareId,from_sing_or_group:shareTicket?1:0,from_share_userid:shareUser,param1:param1};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/shareIn.action",data).then(function(res){mpsdk.log("上报shareIn事件成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报shareIn事件失败")})};Report.reportLinkIn=function(adId,appId,param1){if(param1===void 0){param1=""}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,my_adid:adId,from_appid:appId,param1:account.anonymous_openid?account.anonymous_openid:""};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer2+"/MiniGameLog/log/linkIn.action",data).then(function(res){mpsdk.log("上报linkIn事件成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报linkIn事件失败")})};Report.reportAdIn=function(linkId,adId,adInfo,param1){if(param1===void 0){param1=""}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,my_adid:linkId,gdt_vid:adId,weixinadinfo:adInfo,param1:account.anonymous_openid?account.anonymous_openid:""};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer2+"/MiniGameLog/log/wxadIn.action",data).then(function(res){mpsdk.log("上报adIn事件成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报adIn事件失败")})};Report.reportOnlineTimeCount=function(){return __awaiter(this,void 0,void 0,function(){var onlineTimeTotal_1,onlineTimeCount_1,d,quickReport,slowReport,account,data,error_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,2,,3]);onlineTimeTotal_1=Number(mpsdk.Platform.instance.getStorage("online_time_total")||0)+1;onlineTimeCount_1=Number(mpsdk.Platform.instance.getStorage("online_time_count")||0)+1;mpsdk.Platform.instance.setStorage("online_time_total",onlineTimeTotal_1,false);mpsdk.Platform.instance.setStorage("online_time_count",onlineTimeCount_1,false);if(!mpsdk.Env.init){return[2]}d=new Date;if(d.getTime()-Report.onlineTimeCountLastReportTime<59*1e3){return[2]}quickReport=onlineTimeTotal_1<5*60&&onlineTimeCount_1>60;slowReport=onlineTimeTotal_1>=5*60&&onlineTimeCount_1>5*60;if(!quickReport&&!slowReport){return[2]}Report.onlineTimeCountLastReportTime=d.getTime();return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();data={gameId:mpsdk.Env.gameId,openId:account.openid,pastTime:onlineTimeCount_1};mpsdk.Platform.instance.httpRequest(mpsdk.Env.publicServer+"/OnlineTimeReport/data/report.action",data).then(function(res){if(!res.totalTime||isNaN(res.totalTime)){mpsdk.log("同步在线时长失败，服务器返回错误，1分钟后再报",JSON.stringify(res));return}mpsdk.Platform.instance.setStorage("online_time_count",0,false);mpsdk.log("同步在线时长成功","onlineTimeTotal",onlineTimeTotal_1,"onlineTimeCount",onlineTimeCount_1)}).catch(function(res){mpsdk.log("同步在线时长失败，HTTP错误，1分钟后再报",JSON.stringify(res))});return[3,3];case 2:error_1=_a.sent();mpsdk.log("reportOnlineTimeCount error:",error_1);return[3,3];case 3:return[2]}})})};Report.reportNewUserLog=function(stepId,param1,param2,userid){if(param1===void 0){param1=""}if(param2===void 0){param2=""}if(userid===void 0){userid=""}if(mpsdk.Platform.instance.getStorage("sdk-new-user-log-pass")){mpsdk.log("已通过新用户打点，无需再打点。");return}if(!mpsdk.Env.init){return}userid=userid?userid:mpsdk.Account.getClientUserId();if(stepId==mpsdk.constant.NewUserLogEnum.ACTION_WX_LOGIN_END){if(param1==mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS){var diffTime=(new Date).getTime()-Number(param2);param2=""+diffTime;mpsdk.log("新用户打点: userid="+userid+", stepid="+stepId+", param1="+param1+", param2="+param2+", 耗时[毫秒]="+diffTime)}else{mpsdk.log("新用户打点: userid="+userid+", stepid="+stepId+", param1="+param1+", param2="+param2)}}else if(stepId==mpsdk.constant.NewUserLogEnum.ACTION_PT_LOGIN_END){var param2Array=param2.split("_");var diffTime=(new Date).getTime()-Number(param2Array[0]);var clientUUID=mpsdk.Account.getClientUUID();var failsError=param2Array[1];if(param1==mpsdk.constant.NewUserLogStatusEnum.STATUS_REPORT_SUCCESS){param2=clientUUID+"_"+"success_"+diffTime}else{param2=clientUUID+"_"+"fail_"+diffTime+"_"+failsError}mpsdk.log("新用户打点: userid="+userid+", stepid="+stepId+", param1="+param1+", param2="+param2+", 耗时[毫秒]="+diffTime)}else{mpsdk.log("新用户打点: userid="+userid+", stepid="+stepId+", param1="+param1+", param2="+param2)}var data={gameid:mpsdk.Env.gameId,userid:userid,stepid:stepId,param1:param1,param2:encodeURIComponent(param2)};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/newUser.action",data).then(function(res){mpsdk.log("上报新用户日志成功",JSON.stringify(data))}).catch(function(e){mpsdk.log("上报新用户日志失败",JSON.stringify(data))})};Report.setNewUserLogPass=function(isPass){mpsdk.log("设置是否通过新用户打点:",isPass);mpsdk.Platform.instance.setStorage("sdk-new-user-log-pass",isPass)};Report.reportHotLaunch=function(options){if(!mpsdk.Env.init||!options){return}Promise.all([mpsdk.Account.getAccountSafe(),mpsdk.Hack.getOpenLevel("")]).then(function(_a){var account=_a[0],hackData=_a[1];var mip=hackData&&hackData.ipAddr?hackData.ipAddr:"";var accountSource=mpsdk.utils.parseAccountSource(options);var systemInfo=mpsdk.Platform.instance.getSystem();var data={gameid:mpsdk.Env.gameId,userId:account.openid,unionId:account.unionid,sourceType:accountSource.sourceType,sourceId:accountSource.sourceId,ip:mip,model:encodeURIComponent(systemInfo.model?systemInfo.model:""),loginTime:(new Date).getTime(),actionId:1};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/sdkLogin.action",data).then(function(res){mpsdk.log("上报热启动来源事件成功",JSON.stringify(data))})}).catch(function(e){mpsdk.log("上报热启动来源事件失败",e)})};Report.onlineTimeCountLastReportTime=0;return Report}();mpsdk.Report=Report})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Reward=function(){function Reward(){}Reward.hbAdd=function(dataKey){if(dataKey===void 0){dataKey="hongbao"}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/addLotteryGift.action",data).then(function(res){if(res&&res.giftValue&&res.giftValue>0){resolve(res);mpsdk.log("发放红包成功",JSON.stringify(res))}else{reject();mpsdk.log("发放红包失败",JSON.stringify(res))}})}).catch(function(){reject();mpsdk.log("openid超时未就绪，发放红包失败")})})};Reward.hbList=function(dataKey){if(dataKey===void 0){dataKey="hongbao"}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getGiftHistory.action",data).then(function(res){if(res&&res.gifts){resolve(res.gifts);mpsdk.log("查询玩家红包记录成功，共",res.gifts.length,"条记录")}else{resolve([]);mpsdk.log("查询玩家红包记录失败",JSON.stringify(res))}})}).catch(function(){resolve([]);mpsdk.log("openid超时未就绪，查询玩家红包记录失败")})})};Reward.hbAmount=function(dataKey){if(dataKey===void 0){dataKey="hongbao"}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getGiftValue.action",data).then(function(res){if(res&&res.giftValue!=undefined){resolve(res.giftValue);mpsdk.log("查询玩家红包总额成功",JSON.stringify(res))}else{resolve(0);mpsdk.log("查询玩家红包总额失败",JSON.stringify(res))}})}).catch(function(){resolve(0);mpsdk.log("openid超时未就绪，查询玩家红包总额失败")})})};Reward.hbDouble=function(giftId,dataKey){if(dataKey===void 0){dataKey="hongbao"}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:dataKey,giftId:giftId};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/doubleGift.action",data).then(function(res){if(res&&res.giftValue&&res.giftValue>0){resolve(res.giftValue);mpsdk.log("红包翻倍成功",JSON.stringify(res))}else{reject();mpsdk.log("红包翻倍失败",JSON.stringify(res))}})}).catch(function(){reject();mpsdk.log("openid超时未就绪，红包翻倍失败")})})};return Reward}();mpsdk.Reward=Reward})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var SNS=function(){function SNS(){}SNS.rankUpload=function(datakey,value,params){if(!datakey||value==undefined||value==null){return}mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,show:params,dataKey:datakey,dataValue:value};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setData.action",data).then(function(res){mpsdk.log("上报排行榜数据成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报排行榜数据失败")})};SNS.friendBind=function(friendOpenId){if(!friendOpenId){return}mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId1:friendOpenId,unionId1:"",openId2:account.openid,unionId2:account.unionid};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/addFriend.action",data).then(function(res){mpsdk.log("加好友结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，加好友失败")})};SNS.friendList=function(dataKey){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getFriend.action",data).then(function(res){resolve(res);mpsdk.log("获取好友列表结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，获取好友列表失败")})})};SNS.rankList=function(dataKey){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getWorld.action",data).then(function(res){resolve(res);mpsdk.log("获取世界排行结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，获取世界排行失败")})})};SNS.rankListHistory=function(dataKey){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getRank.action",data).then(function(res){resolve(res);mpsdk.log("获取上期排行结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，获取上期排行失败")})})};SNS.inviteAccept=function(inviter,payload,type,lastLoginTime,extend){if(type===void 0){type=0}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,sourceId:inviter};if(payload){data.param=payload}if(type){data.type=type;data.lastLoginTime=Number(lastLoginTime)}if(extend){data.extend=extend}mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setSource.action",data).then(function(res){if(res&&res.error==0){resolve();mpsdk.log("接受邀请成功",JSON.stringify(res))}else{mpsdk.log("接受邀请失败",JSON.stringify(res))}})}).catch(function(){mpsdk.log("openid超时未就绪，接受邀请失败")})})};SNS.reportInviteeEvent=function(inviter,taskKey,taskValue){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,sourceId:inviter,taskKey:taskKey?encodeURIComponent(taskKey):"",taskVal:taskValue?encodeURIComponent(taskValue):""};mpsdk.log("上报受邀者信息: ",JSON.stringify(data));mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setSourceTask.action",data).then(function(res){if(res&&res.error==0){resolve();mpsdk.log("上报受邀者信息成功")}else{mpsdk.log("上报受邀者信息失败",JSON.stringify(res))}})}).catch(function(){mpsdk.log("openid超时未就绪，上报受邀者信息失败")})})};SNS.inviteResultList=function(type){if(type===void 0){type=0}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,type:type};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getFriendShow.action",data).then(function(res){if(res&&res.error===0){resolve(res);mpsdk.log("获取邀请结果列表成功",JSON.stringify(res))}else{mpsdk.log("获取邀请结果列表失败",JSON.stringify(res))}})}).catch(function(){mpsdk.log("openid超时未就绪，获取邀请结果列表失败")})})};SNS.inviteResult=function(type){if(type===void 0){type=0}return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,type:type};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getFriendShow2.action",data).then(function(res){if(res&&res.error===0){resolve(res.friends);mpsdk.log("获取邀请结果列表成功",JSON.stringify(res))}else{reject(res);mpsdk.log("获取邀请结果列表失败",JSON.stringify(res))}}).catch(function(){reject("获取邀请结果列表失败，HTTP请求失败")})}).catch(function(){reject("openid超时未就绪，获取邀请结果列表失败");mpsdk.log("openid超时未就绪，获取邀请结果列表失败")})})};SNS.joinLottery=function(condition1,condition2,params){if(!condition1||!condition2){return}mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,unionId:account.unionid,show:params,parameter1:condition1,parameter2:condition2};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/setAccount.action",data).then(function(res){mpsdk.log("参与抽奖结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，参与抽奖失败")})};SNS.getRandUserInfo=function(){return __awaiter(this,void 0,void 0,function(){var response;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getRandAvatorInfo.action")];case 1:response=_a.sent();if(response.result!==0){throw response}return[2,response.data]}})})};SNS.saveEvent=function(eventId,targetUserOpenId,param){return __awaiter(this,void 0,void 0,function(){var account,data,response;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();data={gameId:mpsdk.Env.gameId,openId:targetUserOpenId,eventId:eventId,eventUser:account.openid,param:param};return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/saveEvent.action",data)];case 2:response=_a.sent();if(response.error!==0){throw response}return[2]}})})};SNS.getEvents=function(){return __awaiter(this,void 0,void 0,function(){var account,data,response;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();data={gameId:mpsdk.Env.gameId,openId:account.openid};return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getEvents.action",data)];case 2:response=_a.sent();if(response.error!==0){throw response}return[2,response.list]}})})};SNS.checkPrize=function(launchOptions){var result={unionId:mpsdk.utils.value(launchOptions,"referrerInfo.extraData.unionId"),prizeType:mpsdk.utils.value(launchOptions,"referrerInfo.extraData.prize_type"),prizeId:mpsdk.utils.value(launchOptions,"referrerInfo.extraData.prize_id")};if(result.unionId&&result.prizeType&&result.prizeId){return result}else{return null}};SNS.consumePrize=function(unionId,prizeType,prizeId){return __awaiter(this,void 0,void 0,function(){var data,response;return __generator(this,function(_a){switch(_a.label){case 0:if(!unionId||!prizeType||!prizeId){throw"参数错误"}data={gameId:mpsdk.Env.gameId,unionId:unionId,type:prizeType,bonusId:prizeId};return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getBonus.action",data)];case 1:response=_a.sent();if(response.result!==0){throw response}return[2]}})})};SNS.getMyPreviousRankAward=function(dataKey){return new Promise(function(resolve,reject){mpsdk.Account.getAccountSafe().then(function(account){var data={gameId:mpsdk.Env.gameId,openId:account.openid,dataKey:dataKey};mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getRankAward.action",data).then(function(res){resolve(res);mpsdk.log("获取自己上期排名结果",JSON.stringify(res))})}).catch(function(){mpsdk.log("openid超时未就绪，获取上期排行失败")})})};return SNS}();mpsdk.SNS=SNS})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var Share=function(){function Share(){}Share.loadShareInfoList=function(){var _this=this;if(!this.shareInfoPromise){this.shareInfoPromise=new Promise(function(resolve,reject){_this.shareInfoList=mpsdk.Platform.instance.getStorage("shareInfoList")||[];mpsdk.Platform.instance.httpRequest(mpsdk.Env.cdnServer+"/ad/"+mpsdk.Env.gamePath+"/share.json").then(function(res){if(typeof res!="object"){mpsdk.log("加载分享配置失败，服务器返回错误",res)}else{_this.shareInfoList=res;mpsdk.Platform.instance.setStorage("shareInfoList",res);mpsdk.log("加载分享配置成功","共"+res.length+"条")}resolve(_this.shareInfoList)}).catch(function(){resolve(_this.shareInfoList)})})}return this.shareInfoPromise};Share.getShareImage=function(id){return __awaiter(this,void 0,void 0,function(){var _i,_a,shareImage;return __generator(this,function(_b){switch(_b.label){case 0:if(!this.shareInfoPromise){this.loadShareInfoList()}return[4,this.shareInfoPromise];case 1:_b.sent();for(_i=0,_a=this.shareInfoList;_i<_a.length;_i++){shareImage=_a[_i];if(shareImage.id==id){return[2,shareImage]}}throw"未找到指定分享图："+id}})})};Share.getShareInfo=function(nickname){if(!this.shareInfoList||!this.shareInfoList.length||typeof this.shareInfoList!="object"){mpsdk.log("获取随机分享信息失败，分享配置尚未就绪，返回值为undefined，请注意容错");return}var shareList=this.shareInfoList.filter(function(value,index,array){return!mpsdk.Hack.appStatus||mpsdk.Hack.appStatus.level!="0"||Number(value.illegal)!=1},this);var shareInfo=mpsdk.utils.tableAlgorithm(shareList,"table");if(nickname){shareInfo.text=shareInfo.text.replace("{nickname}",nickname)}mpsdk.log("获取随机分享内容成功",JSON.stringify(shareInfo));return shareInfo};Share.genShareInfo=function(defaultShareInfo){var _this=this;var sid=mpsdk.Account.getAccount().sid;var shareTitlePrefix="";if(sid&&mpsdk.Env.openLevelData&&mpsdk.Env.openLevelData["sdkShareFrontWordOnOff"]&&mpsdk.Env.openLevelData["sdkShareFrontWordOnOff"]==="1"){var sidNum=parseInt(sid.slice(0,7));var str=sid.slice(7);var name_1=mpsdk.EngineUtility.EncodeNumberToUtf8Character(sidNum);shareTitlePrefix="["+name_1+"@你,"+str+"]";mpsdk.log("分享前缀",shareTitlePrefix)}defaultShareInfo.prefix=shareTitlePrefix;defaultShareInfo.title=shareTitlePrefix+defaultShareInfo.title;if(defaultShareInfo.imageId&&this.shareInfoList&&this.shareInfoList.length){var specialShareImage=void 0;for(var i=0;i<this.shareInfoList.length;i++){if(this.shareInfoList[i].id==defaultShareInfo.imageId){specialShareImage=this.shareInfoList[i];break}}if(specialShareImage){var shareInfo_1=__assign({},defaultShareInfo);shareInfo_1.prefix=shareTitlePrefix;shareInfo_1.title=shareTitlePrefix+(shareInfo_1.nickName?specialShareImage.text.replace("{nickname}",shareInfo_1.nickName):specialShareImage.text);shareInfo_1.image=specialShareImage.image;shareInfo_1.imageId=specialShareImage.id;delete shareInfo_1.nickName;delete shareInfo_1.scoreValue;mpsdk.log("生成固定分享内容成功",JSON.stringify(shareInfo_1));return shareInfo_1}}defaultShareInfo.imageId=0;if(!this.shareInfoList||!this.shareInfoList.length||typeof this.shareInfoList!="object"){mpsdk.log("获取随机分享信息失败，使用默认分享信息");return defaultShareInfo}var shareImageList=this.shareInfoList.filter(function(item){if(item.version){if(!defaultShareInfo.version||item.version!=defaultShareInfo.version){return false}}else{if(defaultShareInfo.version){return false}}return _this.checkFilter(item,defaultShareInfo)},this);var tempShareImageList=shareImageList;if(!shareImageList.length&&defaultShareInfo.version){tempShareImageList=this.shareInfoList.filter(function(item){if(item.version){return false}return _this.checkFilter(item,defaultShareInfo)},this)}if(!tempShareImageList.length){mpsdk.log("随机分享被完全过滤，使用默认分享信息");return defaultShareInfo}var shareImage=mpsdk.utils.tableAlgorithm(tempShareImageList,"table");if(!shareImage){return defaultShareInfo}var shareInfo=__assign({},defaultShareInfo);shareInfo.prefix=shareTitlePrefix;shareInfo.title=shareTitlePrefix+(shareInfo.nickName?shareImage.text.replace("{nickname}",shareInfo.nickName):shareImage.text);shareInfo.image=shareImage.image;shareInfo.imageId=shareImage.id;delete shareInfo.nickName;delete shareInfo.scoreValue;mpsdk.log("生成随机分享内容成功",JSON.stringify(shareInfo));return shareInfo};Share.checkFilter=function(item,defaultShareInfo){if(!mpsdk.Hack.appStatus){return true}if(Number(item.illegal)===1&&Number(mpsdk.Hack.appStatus.level)===0){mpsdk.log("分享图",item.id,"不符合审核要求，被过滤");return false}if(Number(item.illegal)===1&&!mpsdk.Hack.isStrongFission()){mpsdk.log("分享图",item.id,"非强烈变用户，该分享图被过滤");return false}if(item.city){var currentCity=mpsdk.utils.value(mpsdk.Hack.appStatus,"ipArea.city");var currentProvince=mpsdk.utils.value(mpsdk.Hack.appStatus,"ipArea.province");if(mpsdk.utils.checkAbroadCity(mpsdk.Hack.appStatus)){mpsdk.log("分享图",item.id,"仅限中国大陆地区使用");return false}if(currentCity&&item.city.indexOf(currentCity)!=-1){mpsdk.log("分享图",item.id,"未对",currentCity,"地区用户开放");return false}else if(currentProvince&&item.city.indexOf(currentProvince)!=-1){mpsdk.log("分享图",item.id,"未对",currentProvince,"地区用户开放");return false}}var currentScore=defaultShareInfo.scoreValue||0;var limitScore=Number(item.number)||0;if(currentScore<limitScore){mpsdk.log("分享图",item.id,"未对当前玩家开放");return false}return true};Share.genShareImage=function(backImageUrl,headImageUrl){return __awaiter(this,void 0,void 0,function(){var backImage,backImagePromise,headImage,headImagePromise,canvas,context,borderWidth,borderRadius,headLeft,headTop,headWidth,headHeight,tempFilePath;return __generator(this,function(_a){switch(_a.label){case 0:backImage=wx.createImage();backImage.src=backImageUrl;backImagePromise=new Promise(function(resolve,reject){backImage.onload=resolve;backImage.onerror=reject});headImage=wx.createImage();headImage.src=headImageUrl;headImagePromise=new Promise(function(resolve,reject){headImage.onload=resolve;headImage.onerror=reject});return[4,backImagePromise];case 1:_a.sent();return[4,headImagePromise];case 2:_a.sent();canvas=wx.createCanvas();canvas.width=backImage.width;canvas.height=backImage.height;context=canvas.getContext("2d");borderWidth=backImage.height*.01;borderRadius=10;headLeft=backImage.width*.1;headTop=backImage.height*.3;headWidth=backImage.height*.4;headHeight=headWidth;context.drawImage(backImage,0,0);context.drawImage(headImage,headLeft,headTop,headWidth,headHeight);mpsdk.utils.drawRoundRect(context,headLeft,headTop,headWidth,headHeight,borderRadius,borderWidth);tempFilePath=canvas.toTempFilePathSync({x:0,y:0,width:backImage.width,height:backImage.height,destWidth:backImage.width,destHeight:backImage.height});return[2,tempFilePath]}})})};Share.getShareLink=function(serial,path,query,shareInfoId){if(path===void 0){path="/pages/index/index"}return path+"?"+this.getShareQuery(serial,query,shareInfoId)};Share.getShareQuery=function(serial,query,shareInfoId){if(typeof query!="object"){query={}}query["type"]="share";query["shareid"]="share_"+mpsdk.Env.gameId+"_"+serial;query["userid"]=mpsdk.Account.getAccount().openid;query["sharetime"]=(new Date).getTime();if(shareInfoId){query["shareinfoid"]=shareInfoId}return mpsdk.utils.httpBuildQuery(query)};Share.reportShareOut=function(serial,shareInfoId,shareTicket,param1){if(shareInfoId===void 0){shareInfoId=""}if(shareTicket===void 0){shareTicket=""}if(param1===void 0){param1=""}mpsdk.Env.init&&mpsdk.Account.getAccountSafe().then(function(account){var data={gameid:mpsdk.Env.gameId,userid:account.openid,share_char_id:"share_"+mpsdk.Env.gameId+"_"+serial,share_pic_id:shareInfoId,sing_or_group:shareTicket,param1:param1};mpsdk.Platform.instance.httpRequest(mpsdk.Env.reportServer1+"/MiniGameLog/log/shareOut.action",data).then(function(res){mpsdk.log("上报shareOut事件成功",JSON.stringify(data))})}).catch(function(){mpsdk.log("openid超时未就绪，上报shareOut事件失败")})};Share.commonShare=function(shareInfo,success,fail,thisObject){var shareObject=mpsdk.Platform.instance.share(shareInfo,success,fail,thisObject);mpsdk.log("获得分享信息",JSON.stringify(shareObject));return shareObject};Share.shareInfoList=[];return Share}();mpsdk.Share=Share})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var constant;(function(constant){var ActiveType;(function(ActiveType){ActiveType[ActiveType["GET_USER_INFO"]=1]="GET_USER_INFO";ActiveType[ActiveType["START_GAME"]=2]="START_GAME"})(ActiveType=constant.ActiveType||(constant.ActiveType={}));var ActiveValue;(function(ActiveValue){ActiveValue[ActiveValue["UNKNOWN"]=0]="UNKNOWN";ActiveValue[ActiveValue["ACTIVE"]=1]="ACTIVE";ActiveValue[ActiveValue["INACTIVE"]=2]="INACTIVE"})(ActiveValue=constant.ActiveValue||(constant.ActiveValue={}));var NewUserLogEnum;(function(NewUserLogEnum){NewUserLogEnum[NewUserLogEnum["ACTION_WX_LOGIN_BEGIN"]=1]="ACTION_WX_LOGIN_BEGIN";NewUserLogEnum[NewUserLogEnum["ACTION_WX_LOGIN_END"]=2]="ACTION_WX_LOGIN_END";NewUserLogEnum[NewUserLogEnum["ACTION_PT_LOGIN_BEGIN"]=3]="ACTION_PT_LOGIN_BEGIN";NewUserLogEnum[NewUserLogEnum["ACTION_PT_LOGIN_END"]=4]="ACTION_PT_LOGIN_END"})(NewUserLogEnum=constant.NewUserLogEnum||(constant.NewUserLogEnum={}));var NewUserLogStatusEnum;(function(NewUserLogStatusEnum){NewUserLogStatusEnum["STATUS_REPORT_SUCCESS"]="1";NewUserLogStatusEnum["STATUS_REPORT_FAILS"]="0"})(NewUserLogStatusEnum=constant.NewUserLogStatusEnum||(constant.NewUserLogStatusEnum={}))})(constant=mpsdk.constant||(mpsdk.constant={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var GifImage=function(){function GifImage(){this.identifier="0";this.sorted=false;this.interlace=false;this.transparentIndex=-1;this.lzwMinCodeSize=0;this.comments=[];this.text="";this.left=0;this.top=0;this.width=0;this.height=0;this.delay=0;this.disposal=0}return GifImage}();gif.GifImage=GifImage})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var ImageCanvas=function(){function ImageCanvas(width,height,bgColor){this.width=width;this.imageData=new Array(width*height);for(var i=0;i<this.imageData.length;i++){this.imageData[i]=bgColor}}ImageCanvas.prototype.drawImage=function(pixels,top,left,width,transparentIndex){for(var i=0;i<pixels.length;i++){if(pixels[i]==transparentIndex){continue}var x=i%width+left;var y=Math.floor(i/width)+top;var p=y*this.width+x;this.imageData[p]=pixels[i]}};return ImageCanvas}();gif.ImageCanvas=ImageCanvas})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var ByteArrayConverter=function(){function ByteArrayConverter(){this.__out=[];this.__remNumBits=0;this.__remVal=0}ByteArrayConverter.prototype.push=function(code,numBits){while(numBits>0){this.__remVal=(code<<this.__remNumBits&255)+this.__remVal;if(numBits+this.__remNumBits>=8){this.__out[this.__out.length]=this.__remVal;numBits=numBits-(8-this.__remNumBits);code=code>>8-this.__remNumBits;this.__remVal=0;this.__remNumBits=0}else{this.__remNumBits=numBits+this.__remNumBits;numBits=0}}};ByteArrayConverter.prototype.flush=function(){this.push(0,8);this.__remNumBits=0;this.__remVal=0;var out=this.__out;this.__out=[];return out};return ByteArrayConverter}();var lzw=function(){function lzw(){}lzw.encode=function(actualCodes,numBits){var bb=new ByteArrayConverter;var clearCode=1<<numBits;var endOfInfoCode=clearCode+1;var nextCode=0;var curNumCodeBits=0;var dict={};function resetAllParamsAndTablesToStartUpState(){nextCode=endOfInfoCode+1;curNumCodeBits=numBits+1;dict=Object.create(null)}resetAllParamsAndTablesToStartUpState();bb.push(clearCode,curNumCodeBits);var concatedCodesKey="";for(var i=0,len=actualCodes.length;i<len;++i){var code=actualCodes[i];var dictKey=String.fromCharCode(code);if(!(dictKey in dict))dict[dictKey]=code;var oldKey=concatedCodesKey;concatedCodesKey+=dictKey;if(!(concatedCodesKey in dict)){bb.push(dict[oldKey],curNumCodeBits);if(nextCode<=4095){dict[concatedCodesKey]=nextCode;if(nextCode===1<<curNumCodeBits)curNumCodeBits++;nextCode++}else{bb.push(clearCode,curNumCodeBits);resetAllParamsAndTablesToStartUpState();dict[dictKey]=code}concatedCodesKey=dictKey}}bb.push(dict[concatedCodesKey],curNumCodeBits);bb.push(endOfInfoCode,curNumCodeBits);return bb.flush()};lzw.decode=function(minCodeSize,data){var pos=0;var readCode=function(size){var code=0;for(var i=0;i<size;i++){if(data.charCodeAt(pos>>3)&1<<(pos&7)){code|=1<<i}pos++}return code};var output=[];var clearCode=1<<minCodeSize;var eoiCode=clearCode+1;var codeSize=minCodeSize+1;var dict=[];var clear=function(){dict=[];codeSize=minCodeSize+1;for(var i=0;i<clearCode;i++){dict[i]=[i]}dict[clearCode]=[];dict[eoiCode]=null};var code=0;var last=0;while(true){last=code;code=readCode(codeSize);if(code===clearCode){clear();continue}if(code===eoiCode)break;if(code<dict.length){if(last!==clearCode){dict[dict.length]=dict[last].concat(dict[code][0])}}else{if(code!==dict.length)throw new Error("Invalid LZW code.");dict[dict.length]=dict[last].concat(dict[last][0])}output.splice.apply(output,[output.length,0].concat(dict[code]));if(dict.length===1<<codeSize&&codeSize<12){codeSize++}}return output};return lzw}();gif.lzw=lzw})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var GifReader=function(){function GifReader(data){this._valid=false;this._sorted=false;this._backgroundIndex=-1;this._colorDepth=0;this._loopCount=0;this._height=0;this._width=0;this._animated=false;this._images=[];if(!data){return}if(data.byteLength){this._dv=new DataView(data);this.parseGifInfo()}else if(data._dv){data._animated&&(this._animated=data._animated);data._backgroundIndex&&(this._backgroundIndex=data._backgroundIndex);data._colorDepth&&(this._colorDepth=data._colorDepth);data._dv&&(this._dv=new DataView(mpsdk.utils.string2Buffer(data._dv)));data._globalHeadData&&(this._globalHeadData=mpsdk.utils.string2Buffer(data._globalHeadData));data._globalPalette&&(this._globalPalette=mpsdk.utils.string2Buffer(data._globalPalette));data._height&&(this._height=data._height);data._images&&(this._images=data._images);data._loopCount&&(this._loopCount=data._loopCount);data._sorted&&(this._sorted=data._sorted);data._valid&&(this._valid=data._valid);data._width&&(this._width=data._width);if(data._animated){for(var i=0;i<data._images.length;i++){this._images[i].localPalette=mpsdk.utils.string2Buffer(data._images[i].localPalette);this._images[i].frameData=mpsdk.utils.string2Buffer(data._images[i].frameData)}}}}Object.defineProperty(GifReader.prototype,"valid",{get:function(){return this._valid},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"globalPalette",{get:function(){return this._globalPalette},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"sorted",{get:function(){return this._sorted},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"backgroundIndex",{get:function(){return this._backgroundIndex},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"colorDepth",{get:function(){return this._colorDepth},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"globalHeadData",{get:function(){return this._globalHeadData},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"loopCount",{get:function(){return this._loopCount},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"animated",{get:function(){return this._animated},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"images",{get:function(){return this._images},enumerable:true,configurable:true});Object.defineProperty(GifReader.prototype,"dataView",{get:function(){return this._dv},enumerable:true,configurable:true});GifReader.prototype.parseGifInfo=function(){if(["GIF89a","GIF87a"].indexOf(this.getString(this._dv,0,6))==-1){this._valid=false;return}this._valid=true;this._width=this._dv.getUint16(6,true);this._height=this._dv.getUint16(8,true);this._backgroundIndex=this._dv.getUint8(11);var m_cr_s_pixel=this.getBitArray(this._dv.getUint8(10));this._colorDepth=this.bitToInt(m_cr_s_pixel.slice(1,4))+1;this._sorted=m_cr_s_pixel[4]?true:false;if(m_cr_s_pixel[0]){var globalPaletteSize=this.getPaletteSize(m_cr_s_pixel);this._globalPalette=this._dv.buffer.slice(13,13+globalPaletteSize)}this._globalHeadData=this._dv.buffer.slice(0,this._globalPalette?13+this._globalPalette.byteLength:13);var index=0;var image=new gif.GifImage;var pos=image.start=this._globalHeadData.byteLength;while(true){try{var block=this._dv.getUint8(pos);switch(block){case 33:image.start=pos;var type=this._dv.getUint8(pos+1);switch(type){case 249:var length_1=this._dv.getUint8(pos+2);if(length_1===4){var unpackedField=this.getBitArray(this._dv.getUint8(pos+3));image.disposal=parseInt(unpackedField.slice(3,6).join(""),2);image.delay=this.getDuration(this._dv.getUint16(pos+4,true));image.transparentIndex=this._dv.getUint8(pos+6);pos+=8}else{pos++}break;case 255:var appBlock=this.readSubBlock(this._dv,pos+2,true);if(appBlock.data.substr(0,8)==="NETSCAPE"){this._loopCount=appBlock.data.charCodeAt(11)}pos+=2+appBlock.size;break;case 206:var nameBlock=this.readSubBlock(this._dv,pos+2,true);image.identifier=nameBlock.data;pos+=2+nameBlock.size;break;case 254:var commentBlock=this.readSubBlock(this._dv,pos+2,true);image.comments[image.comments.length]=commentBlock.data;pos+=2+commentBlock.size;break;case 1:var plainBlock=this.readSubBlock(this._dv,pos+2,true);image.text=plainBlock.data;pos+=2+plainBlock.size;break}break;case 44:image.left=this._dv.getUint16(pos+1,true);image.top=this._dv.getUint16(pos+3,true);image.width=this._dv.getUint16(pos+5,true);image.height=this._dv.getUint16(pos+7,true);var m_i_s_r_pixel=this.getBitArray(this._dv.getUint8(pos+9));image.interlace=m_i_s_r_pixel[1]?true:false;image.sorted=m_i_s_r_pixel[2]?true:false;if(m_i_s_r_pixel[0]){var localPaletteSize=this.getPaletteSize(m_i_s_r_pixel);image.localPalette=this._dv.buffer.slice(pos+10,pos+10+localPaletteSize);pos+=10+localPaletteSize}else{image.localPalette=this._globalPalette;pos+=10}image.lzwMinCodeSize=this._dv.getUint8(pos);pos++;var subBlock=this.readSubBlock(this._dv,pos,true);image.rawData=subBlock.data;pos+=subBlock.size;this._images[this._images.length]=image;index++;image=new gif.GifImage;image.start=pos;image.identifier=index.toString();if(this._images.length>1&&!this._animated){this._animated=true}break;case 59:return;default:pos++;break}}catch(e){console.log("解析GIF数据发生异常",e);this._valid=false;return}if(pos>=this._dv.byteLength){return}}};GifReader.prototype.getPixels=function(index){if(index<0){index=0}else if(index>this._images.length-1){index=this._images.length-1}var image=this._images[index];if(image.pixels){return image.pixels}var pixels=gif.lzw.decode(image.lzwMinCodeSize,image.rawData);if(image.interlace){pixels=this.deinterlace(pixels,image.width)}var canvas=new gif.ImageCanvas(this._width,this._height,this._backgroundIndex);if(index!=0){canvas.drawImage(this.getPixels(index-1),0,0,this._width,this._images[index-1].transparentIndex)}canvas.drawImage(pixels,image.top,image.left,image.width,image.transparentIndex);image.pixels=canvas.imageData;return image.pixels};GifReader.prototype.getFrame=function(index){if(index<0){index=0}else if(index>this._images.length-1){index=this._images.length-1}var image=this._images[index];if(image.frameData){return image.frameData}if(index==0){image.frameData=this._dv.buffer.slice(0,this._images[1].start);return image.frameData}var imageDescriptor=new ArrayBuffer(11);var iddv=new DataView(imageDescriptor);iddv.setUint8(0,44);iddv.setUint16(1,0,true);iddv.setUint16(3,0,true);iddv.setUint16(5,this._width,true);iddv.setUint16(7,this._height,true);iddv.setUint8(9,0);iddv.setUint8(10,image.lzwMinCodeSize);var lzwData=gif.lzw.encode(this.getPixels(index),this._colorDepth);var packedData=this.makeSubBlock(lzwData);image.frameData=this.concatArrayBuffer(this._globalHeadData,imageDescriptor,packedData,new Uint8Array([59]).buffer);return image.frameData};GifReader.prototype.concatArrayBuffer=function(){var buffers=[];for(var _i=0;_i<arguments.length;_i++){buffers[_i]=arguments[_i]}var byteLength=0;for(var _a=0,buffers_1=buffers;_a<buffers_1.length;_a++){var b=buffers_1[_a];byteLength+=b.byteLength}var concatBuffer=new ArrayBuffer(byteLength);var pos=0;for(var _b=0,buffers_2=buffers;_b<buffers_2.length;_b++){var b=buffers_2[_b];new Uint8Array(concatBuffer,pos,b.byteLength).set(new Uint8Array(b));pos+=b.byteLength}return concatBuffer};GifReader.prototype.getBitArray=function(num){var bits=[];for(var i=7;i>=0;i--){bits[bits.length]=!!(num&1<<i)?1:0}return bits};GifReader.prototype.bitToInt=function(bitArray){return bitArray.reduce(function(s,n){return s*2+n},0)};GifReader.prototype.getPaletteSize=function(palette){return 3*Math.pow(2,1+this.bitToInt(palette.slice(5,8)))};GifReader.prototype.getDuration=function(duration){return duration/100*1e3};GifReader.prototype.getString=function(dv,pos,length){var charCode=new Array(length);for(var i=0;i<length;i++){charCode[i]=String.fromCharCode(dv.getUint8(pos+i))}return charCode.join("")};GifReader.prototype.readSubBlock=function(dv,pos,read){if(read===void 0){read=false}var subBlock={size:0,data:""};while(true){var size=dv.getUint8(pos+subBlock.size);if(size===0){subBlock.size++;break}if(read){subBlock.data+=this.getString(dv,pos+subBlock.size+1,size)}subBlock.size+=size+1}return subBlock};GifReader.prototype.makeSubBlock=function(data){var newArray=[];var i=0;while(true){var subData=data.slice(i,i+255);i+=255;if(subData.length==255){newArray[newArray.length]=255;newArray.splice.apply(newArray,[newArray.length,0].concat(subData))}else if(subData.length==0){newArray[newArray.length]=0;break}else{newArray[newArray.length]=subData.length;newArray.splice.apply(newArray,[newArray.length,0].concat(subData));newArray[newArray.length]=0;break}}return new Uint8Array(newArray).buffer};GifReader.prototype.deinterlace=function(pixels,width){var newPixels=new Array(pixels.length);var rows=pixels.length/width;var cpRow=function(toRow,fromRow){var fromPixels=pixels.slice(fromRow*width,(fromRow+1)*width);newPixels.splice.apply(newPixels,[toRow*width,width].concat(fromPixels))};var offsets=[0,4,2,1];var steps=[8,8,4,2];var fromRow=0;for(var pass=0;pass<4;pass++){for(var toRow=offsets[pass];toRow<rows;toRow+=steps[pass]){cpRow(toRow,fromRow);fromRow++}}return newPixels};return GifReader}();gif.GifReader=GifReader})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var EgretGifMovie=function(){function EgretGifMovie(url,callbackFunc,callbackObject){this.url=url;this.textureCache=[];this.frameIndex=0;this.callbackFunc=callbackFunc;this.callbackObject=callbackObject;this.movie=new egret.Bitmap;this.movie.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.destroy,this)}EgretGifMovie.loadByUrl=function(url,callbackFunc,callbackObject,workerType,workerPath){if(workerType===void 0){workerType=""}if(workerPath===void 0){workerPath=""}var gifMovie=new EgretGifMovie(url,callbackFunc,callbackObject);if(EgretGifMovie.gifCache[url]){gifMovie.loadCache(EgretGifMovie.gifCache[url]);return}if(workerType&&workerPath){if(workerType!=EgretGifMovie.workerType||workerPath!=EgretGifMovie.workerPath){if(workerType=="wx"&&mpsdk.Platform.platformType=="wx"){EgretGifMovie.workerType=workerType;EgretGifMovie.workerPath=workerPath;EgretGifMovie.worker&&worker.terminate();EgretGifMovie.worker=wx.createWorker(workerPath);EgretGifMovie.worker.onMessage(function(res){if(res.msg=="gif"){EgretGifMovie.gifCache[res.id]||(EgretGifMovie.gifCache[res.id]=new gif.GifReader(res.reader));var i=EgretGifMovie.workerListener.length;while(i--){if(EgretGifMovie.workerListener[i].url==res.id){EgretGifMovie.workerListener[i].loadCache(EgretGifMovie.gifCache[res.id]);EgretGifMovie.workerListener.splice(i,1)}}}else{mpsdk.log("收到worker进程错误消息",JSON.stringify(res))}})}}if(EgretGifMovie.worker){EgretGifMovie.workerListener[EgretGifMovie.workerListener.length]=gifMovie}}RES.getResByUrl(url.trim(),gifMovie.loadBuffer,gifMovie,RES.ResourceItem.TYPE_BIN)};EgretGifMovie.prototype.loadBuffer=function(sourceArrayBuffer,url){if(EgretGifMovie.worker&&EgretGifMovie.workerType=="wx"){EgretGifMovie.worker.postMessage({msg:"gif",id:this.url,buffer:sourceArrayBuffer})}else{EgretGifMovie.gifCache[url]=new gif.GifReader(sourceArrayBuffer);this.reader=EgretGifMovie.gifCache[url];this.compFunc()}};EgretGifMovie.prototype.loadCache=function(gifReader){this.reader=gifReader;this.compFunc()};EgretGifMovie.prototype.compFunc=function(){var _this=this;if(!this.reader.valid||!this.reader.animated){egret.BitmapData.create("arraybuffer",this.reader.dataView.buffer,function(bitmapData){var texture=new egret.Texture;texture.bitmapData=bitmapData;_this.movie.texture=texture;_this.callbackFunc.call(_this.callbackObject,_this)});return}this.callbackFunc.call(this.callbackObject,this);this.timer=new egret.Timer(1,1);this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.play,this);this.timer.start()};EgretGifMovie.prototype.play=function(){var _this=this;if(!this.timer){return}var currentIndex=this.frameIndex;++this.frameIndex>=this.reader.images.length&&(this.frameIndex=0);this.timer.delay=this.reader.images[currentIndex].delay<20?100:this.reader.images[currentIndex].delay;if(!this.textureCache[currentIndex]){var frameBuffer=this.reader.getFrame(currentIndex);egret.BitmapData.create("arraybuffer",frameBuffer,function(bitmapData){if(!_this.timer){return}var texture=new egret.Texture;texture.bitmapData=bitmapData;_this.textureCache[currentIndex]=texture;_this.movie.texture=_this.textureCache[currentIndex];_this.timer.start()})}else{this.movie.texture=this.textureCache[currentIndex];this.timer.start()}};EgretGifMovie.prototype.destroy=function(){if(!this.timer){return}this.timer.stop();for(var _i=0,_a=this.textureCache;_i<_a.length;_i++){var t=_a[_i];t.dispose()}delete this.textureCache;delete this.reader;delete this.movie;delete this.timer};EgretGifMovie.gifCache={};EgretGifMovie.workerListener=[];return EgretGifMovie}();gif.EgretGifMovie=EgretGifMovie})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var CocosGifMovie=function(){function CocosGifMovie(url,callbackFunc,callbackObject){this.url=url;this.movie=new cc.Node;this.sprite=this.movie.addComponent(cc.Sprite);this.textureCache=[];this.frameIndex=0;this.callbackFunc=callbackFunc;this.callbackObject=callbackObject}CocosGifMovie.loadByUrl=function(url,callbackFunc,callbackObject){var gifMovie=new CocosGifMovie(url,callbackFunc,callbackObject);if(CocosGifMovie.gifCache[url]){gifMovie.loadCache(CocosGifMovie.gifCache[url])}else{var xhr=cc.loader.getXMLHttpRequest();xhr.responseType="arraybuffer";xhr.onreadystatechange=function(){if(xhr.readyState==4&&(xhr.status>=200&&xhr.status<400)){gifMovie.loadBuffer(xhr.response,url)}};xhr.open("GET",url,true);xhr.send()}};CocosGifMovie.prototype.loadBuffer=function(sourceArrayBuffer,url){CocosGifMovie.gifCache[url]=new gif.GifReader(sourceArrayBuffer);this.reader=CocosGifMovie.gifCache[url];this.compFunc()};CocosGifMovie.prototype.loadCache=function(gifReader){this.reader=gifReader;this.compFunc()};CocosGifMovie.prototype.compFunc=function(){var _this=this;if(!this.reader.valid||!this.reader.animated){cc.loader.load(this.url,function(err,texture){_this.sprite.spriteFrame=new cc.SpriteFrame(texture);_this.callbackFunc.call(_this.callbackObject,_this)});return}this.timer=1;this.callbackFunc.call(this.callbackObject,this);this.play()};CocosGifMovie.prototype.play=function(){var _this=this;if(!this.timer){return}var currentIndex=this.frameIndex;++this.frameIndex>=this.reader.images.length&&(this.frameIndex=0);var delay=this.reader.images[currentIndex].delay<20?100:this.reader.images[currentIndex].delay;if(!this.textureCache[currentIndex]){var pixels=this.reader.getPixels(currentIndex);var colorBuffer=new Uint8Array(this.reader.images[currentIndex].localPalette);var textureBuffer=new Uint8Array(pixels.length*4);for(var i=0;i<pixels.length;i++){textureBuffer[i*4]=colorBuffer[pixels[i]*3];textureBuffer[i*4+1]=colorBuffer[pixels[i]*3+1];textureBuffer[i*4+2]=colorBuffer[pixels[i]*3+2];textureBuffer[i*4+3]=255}var texture=void 0;if(cc["RenderTexture"]["initWithSize"]){texture=new cc.RenderTexture;texture.initWithSize(this.reader.width,this.reader.height)}else{texture=new cc.Texture2D}texture.initWithData(textureBuffer,cc.Texture2D.PixelFormat.RGBA8888,this.reader.width,this.reader.height);if(this.movie.width&&this.movie.height){texture.width=this.movie.width;texture.height=this.movie.height}this.textureCache[currentIndex]=new cc.SpriteFrame(texture)}var width=this.movie.width;var height=this.movie.height;this.sprite.spriteFrame=this.textureCache[currentIndex];if(width&&height){this.movie.width=width;this.movie.height=height}mpsdk.Platform.instance.setTimeout(function(){_this.play()},delay)};CocosGifMovie.prototype.dispose=function(){if(!this.timer){return}this.timer=0;for(var _i=0,_a=this.textureCache;_i<_a.length;_i++){var t=_a[_i];t.destroy()}this.sprite.destroy();delete this.textureCache;delete this.reader};CocosGifMovie.gifCache={};return CocosGifMovie}();gif.CocosGifMovie=CocosGifMovie})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ext;(function(ext){var PDD=function(){function PDD(){}PDD.getGoodsList=function(gameId){return __awaiter(this,void 0,void 0,function(){var account,goods,oldArr,maxItem,i;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.extServer+"/v1/pdd/recommend",{openid:account.openid,game_id:gameId||mpsdk.Env.gameId},"get",0)];case 2:goods=_a.sent();if(!goods.data){return[2,[]]}oldArr=new Array;oldArr=oldArr.concat(goods.data);goods.data.sort(function(a,b){return b.coupon_discount-a.coupon_discount});maxItem=goods.data[0];for(i=0;i<oldArr.length;i++){if(oldArr[i].goods_id==maxItem.goods_id){oldArr.splice(i,1)}}oldArr.unshift(maxItem);return[2,oldArr]}})})};PDD.getRandomGoods=function(maxPrice,minPrice){if(minPrice===void 0){minPrice=0}return __awaiter(this,void 0,void 0,function(){var account,data,goodsList;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();data={openid:account.openid,game_id:mpsdk.Env.gameId};return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.extServer+"/v1/pdd/goods",data)];case 2:goodsList=_a.sent();return[2,this.getNeedGoods(goodsList.data.goods_list,minPrice,maxPrice)]}})})};PDD.getRedbagGoods=function(){return __awaiter(this,void 0,void 0,function(){var account,data,goods;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Account.getAccountSafe()];case 1:account=_a.sent();data={openid:account.openid,game_id:mpsdk.Env.gameId};return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.extServer+"/v1/pdd/recommend",data,"get",0)];case 2:goods=_a.sent();return[2,goods.data[Math.floor(Math.random()*goods.data.length)]]}})})};PDD.getNeedGoods=function(list,minPrice,maxPrice,isRandom){if(isRandom===void 0){isRandom=true}var needArr=[];var pddRepeatList=mpsdk.Platform.instance.getStorage("pdd_repeat_goods")||[];if(pddRepeatList.length>50){pddRepeatList=[];mpsdk.Platform.instance.setStorage("pdd_repeat_goods",[])}needArr=list.filter(function(item){if(item.coupon_discount==0||!item.coupon_discount){return false}else if(item.coupon_discount<=minPrice||item.coupon_discount>maxPrice){return false}else if(pddRepeatList.indexOf(item.goods_id)!=-1){return false}return true});var item;if(needArr.length<=0){return null}if(isRandom){item=needArr[Math.floor(Math.random()*needArr.length)]}else{item=needArr[0]}pddRepeatList.push(item.goods_id);mpsdk.Platform.instance.setStorage("pdd_repeat_goods",pddRepeatList);return item};return PDD}();ext.PDD=PDD})(ext=mpsdk.ext||(mpsdk.ext={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){function init(gameId,gamePath,options,isNeedUnionid){if(isNeedUnionid===void 0){isNeedUnionid=false}if(mpsdk.Env.init){log("请勿重复初始化SDK");return mpsdk.Account.getAccountSafe().then(function(account){return account.openid})}mpsdk.Env.gameId=gameId;mpsdk.Env.gamePath=gamePath;mpsdk.Env.init=true;mpsdk.Env.isNeedUnionid=isNeedUnionid;if(options){mpsdk.Env.launchOptions=JSON.parse(JSON.stringify(options))}else{mpsdk.Env.launchOptions=mpsdk.Platform.instance.getLaunchOptions()}log("SDK初始化/启动参数","gameId=",gameId,"gamePath=",gamePath,"launchOptions",JSON.stringify(mpsdk.Env.launchOptions));mpsdk.Platform.instance.onHide();mpsdk.Platform.instance.setInterval(mpsdk.Report.reportOnlineTimeCount,1e3);return new Promise(function(resolve,reject){mpsdk.Platform.instance.getUserAccount(mpsdk.Env.launchOptions).then(function(account){if(mpsdk.Account.setAccount(account)){var accountSource=mpsdk.utils.parseAccountSource(mpsdk.Env.launchOptions);log("上报用户来源成功","sourceType=",accountSource.sourceType,"sourceId=",accountSource.sourceId);mpsdk.Report.reportAppRun(mpsdk.Env.launchOptions);resolve(account.openid);mpsdk.Share.loadShareInfoList();mpsdk.Ad.loadAdData()}else{log("初始化用户账号失败",JSON.stringify(account));reject("初始化用户账号失败")}}).catch(function(e){log("初始化失败:",e);reject(e)})})}mpsdk.init=init;function initWithAccount(gameId,gamePath,account,options,isNeedUnionid){if(isNeedUnionid===void 0){isNeedUnionid=false}if(mpsdk.Env.init){log("请勿重复初始化SDK");return}mpsdk.Env.gameId=gameId;mpsdk.Env.gamePath=gamePath;mpsdk.Env.init=true;mpsdk.Env.isNeedUnionid=isNeedUnionid;if(options){mpsdk.Env.launchOptions=JSON.parse(JSON.stringify(options))}else{mpsdk.Env.launchOptions=mpsdk.Platform.instance.getLaunchOptions()}mpsdk.Share.loadShareInfoList();mpsdk.Ad.loadAdData();log("SDK初始化/启动参数","gameId=",gameId,"gamePath=",gamePath,"account=",account,"launchOptions=",JSON.stringify(mpsdk.Env.launchOptions));mpsdk.Platform.instance.setInterval(mpsdk.Report.reportOnlineTimeCount,1e3);mpsdk.Platform.instance.onHide();if(mpsdk.Account.setAccount(account)){var accountSource=mpsdk.utils.parseAccountSource(mpsdk.Env.launchOptions);mpsdk.Account.setAccountSource(accountSource.sourceType,accountSource.sourceId);mpsdk.Report.reportAppRun(mpsdk.Env.launchOptions)}else{log("初始化用户账号失败",JSON.stringify(account))}}mpsdk.initWithAccount=initWithAccount;function log(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}mpsdk.Env.showLog&&console.log.apply(console,["mpsdk"].concat(args))}mpsdk.log=log;function checkUpdate(){var d=new Date;var lastUpdate=d.toLocaleDateString()+"/"+Math.floor(d.getHours()/12);if(mpsdk.Platform.instance.getStorage("lastUpdate")==lastUpdate){return}mpsdk.Platform.instance.setStorage("lastUpdate",lastUpdate);if(["egret","cocos"].indexOf(mpsdk.Platform.platformType)==-1&&mpsdk.Platform.instance.getSystem().platform!="devtools"){return}var css="background:#CC3399;color:#FFFF99";console.log("mpsdk %csdk.funcell123.com仅在调试环境检测SDK版本更新，如果发生错误可关闭合法域名校验或忽略此问题（不必添加到合法域名）",css);mpsdk.Platform.instance.httpRequest("http://sdk.funcell123.com/mpsdk/media/version.php").then(function(res){if(res.version!=mpsdk.Env.version||res.build!=mpsdk.Env.build){console.log("mpsdk %c当前版本号："+mpsdk.Env.version+" build "+mpsdk.Env.build,css);console.log("mpsdk %c最新版本号："+res.version+" build "+res.build,css);console.log("mpsdk %c建议更新SDK，详情：http://sdk.funcell123.com/mpsdk",css)}})}mpsdk.checkUpdate=checkUpdate;function getStatus(gameId){gameId=gameId||mpsdk.Env.gameId;return new Promise(function(resolve,reject){if(!gameId){log("获取状态控制参数失败，请先初始化SDK或传入gameId参数");return}mpsdk.Platform.instance.httpRequest(mpsdk.Env.loginServer+"/MiniGame/data/getIp.action?gameId="+gameId).then(function(res){if(!res.open){log("获取状态控制参数失败，服务端状态控制参数未设置");return}try{var status_1=JSON.parse(res.open);status_1.ipCheck=res.check.toString();status_1.ipCheck=="0"&&(status_1.status="0");resolve(status_1)}catch(e){log("获取状态控制参数失败，参数解析错误");return}})})}mpsdk.getStatus=getStatus;function getOpenLevel(codeVer,gameId){return mpsdk.Hack.getOpenLevel(codeVer,gameId)}mpsdk.getOpenLevel=getOpenLevel;function getServerTime(){return __awaiter(this,void 0,void 0,function(){var serverTime;return __generator(this,function(_a){switch(_a.label){case 0:return[4,mpsdk.Platform.instance.httpRequest(mpsdk.Env.friendServer+"/MiniFriend/data/getServerTime.action")];case 1:serverTime=_a.sent();return[2,serverTime.ServerTime]}})})}mpsdk.getServerTime=getServerTime})(mpsdk||(mpsdk={}));mpsdk.log("version",mpsdk.Env.version,"build",mpsdk.Env.build);if(typeof worker=="object"&&worker.onMessage){worker.onMessage(function(res){if(res&&res.msg=="gif"&&res.id&&res.buffer){var reader=new mpsdk.gif.GifReader(res.buffer);if(reader.valid){for(var i=0;i<reader.images.length;i++){reader.getFrame(i)}}var serializeReader=reader;serializeReader._dv=mpsdk.utils.buffer2String(reader.dataView.buffer);if(reader.valid){serializeReader._globalHeadData=mpsdk.utils.buffer2String(reader.globalHeadData);serializeReader._globalPalette=mpsdk.utils.buffer2String(reader.globalPalette);for(var i=0;i<reader.images.length;i++){serializeReader._images[i].localPalette=mpsdk.utils.buffer2String(reader.images[i].localPalette);serializeReader._images[i].frameData=mpsdk.utils.buffer2String(reader.images[i].frameData)}}worker.postMessage({msg:"gif",id:res.id,reader:serializeReader})}})}else{mpsdk.checkUpdate();if(typeof wx=="object"&&!wx.redirectTo){window["mpsdk"]=mpsdk}else if(typeof module!="undefined"){module.exports=mpsdk}else{window["mpsdk"]=mpsdk}}var mpsdk;(function(mpsdk){var gif;(function(gif){var CocosGifAnim=function(){function CocosGifAnim(){}CocosGifAnim.getGifAnim=function(pngPath,jsonPath,single){return new Promise(function(resolve,reject){cc.loader.load([pngPath,jsonPath],function(err,result){if(err){console.log(err);reject&&reject(err)}else{var json=result.getContent(jsonPath);var png=result.getContent(pngPath);var list=[];for(var i=0;i<json.frames.length;i++){var index=parseInt(json.frames[i]["filename"].split(".")[0]);var frame=json.frames[i].frame;var mSprite=new cc.SpriteFrame(png,cc.rect(frame.x,frame.y,frame.w,frame.h));list[index]=mSprite}var mAnimation=single.addComponent(cc.Animation);var clip=cc.AnimationClip.createWithSpriteFrames(list,16);clip.name="gifAnim";clip.wrapMode=cc.WrapMode.Loop;mAnimation.addClip(clip);mAnimation.play("gifAnim");resolve&&resolve(mAnimation)}})})};return CocosGifAnim}();gif.CocosGifAnim=CocosGifAnim})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var gif;(function(gif){var LayaGifAnimLoader=function(){function LayaGifAnimLoader(){}LayaGifAnimLoader.Load=function(pngPath,jsonPath,titlePath,iconname,isBold){var _this=this;return new Promise(function(resolve,reject){if(pngPath.indexOf(".gif")>=0){console.log("LayaGifAnimLoader::Load->不支持Gif格式的图",pngPath);reject&&reject(null);return}if(jsonPath){Laya.loader.load([pngPath,jsonPath],Laya.Handler.create(_this,function(result){var json=Laya.loader.getRes(jsonPath);var png=Laya.loader.getRes(pngPath);var jsonlist=[];for(var i=0;i<json.frames.length;i++){var index=parseInt(json.frames[i]["filename"].split(".")[0]);var frame=json.frames[i].frame;jsonlist[index]=frame}var move=new LayaGifAnim;move.Init(jsonlist,png,titlePath,iconname,isBold);resolve&&resolve(move)}))}else{Laya.loader.load(pngPath,Laya.Handler.create(_this,function(result){var png=result;var move=new LayaGifAnim;move.Init([],png,titlePath,iconname,isBold);resolve&&resolve(move)}))}Laya.loader.on(Laya.Event.ERROR,_this,function(err){console.log("LayaGifAnimLoader::Load->加载动图出错 ",err);reject&&reject(err)})})};LayaGifAnimLoader.Pool=[];return LayaGifAnimLoader}();gif.LayaGifAnimLoader=LayaGifAnimLoader;var LayaGifAnim=function(){function LayaGifAnim(){this._nowpage=0;this._frame=0}LayaGifAnim.prototype.Init=function(jsonlist,tx,titleurl,iconname,isBold){var _this=this;this._texList=[];this.View=new Laya.Sprite;this._icon=new Laya.Sprite;this._title=new Laya.Sprite;if(jsonlist==null||jsonlist.length==0){this._texList.push(tx)}else{for(var i=0;i<jsonlist.length;i++){var frame=jsonlist[i];var tex=Laya.Texture.createFromTexture(tx,frame.x,frame.y,frame.w,frame.h);this._texList.push(tex)}}this._icon.width=this._texList[0].width;this._icon.height=this._texList[0].height;this.View.addChild(this._icon);if(iconname&&iconname.length>0){if(titleurl){Laya.loader.load(titleurl,Laya.Handler.create(this,function(tex){tex.width=_this._icon.width;tex.height=_this._icon.height/4;_this._title.texture=tex}))}this.View.addChild(this._title);this._title.y=this._icon.height;this._title.width=this._icon.width;this._title.height=this._icon.height/4;if(iconname.length>5){iconname=iconname.substr(0,4)+"..."}this._titleTxt=new Laya.Text;this._titleTxt.width=this._title.width;this._titleTxt.height=this._title.height;this._titleTxt.fontSize=Math.floor(this._title.width-10)/5;this._title.addChild(this._titleTxt);this._titleTxt.align="center";this._titleTxt.valign="middle";this._titleTxt.zOrder=10;this._titleTxt.text=iconname;this._titleTxt.bold=isBold}this.View.width=this._icon.width;this.View.height=this._icon.height+this._title.height;this.changeFrame()};LayaGifAnim.prototype.changeFrame=function(){if(this._texList==null){return}if(this._nowpage>=this._texList.length){this._nowpage=0}this._icon.graphics.clear();this._icon.graphics.drawTexture(this._texList[this._nowpage],0,0);this._nowpage++};LayaGifAnim.prototype.Update=function(){this._frame++;if(this._texList.length>1&&this._frame%3==0){this.changeFrame()}};LayaGifAnim.prototype.Destroy=function(){this.View.removeSelf();this.View.destroy(true);for(var _i=0,_a=this._texList;_i<_a.length;_i++){var i=_a[_i];i.destroy(true)}this._texList=[]};return LayaGifAnim}();gif.LayaGifAnim=LayaGifAnim})(gif=mpsdk.gif||(mpsdk.gif={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ui;(function(ui){var CCADGridUI=function(){function CCADGridUI(){}CCADGridUI.init=function(itemCount){var _this=this;this.mWidgetList=[];this.mRootNode=new cc.Node("SuggestBottom");this.mRootNode.setContentSize(600,500);var tempNode=new cc.Node("bg");tempNode.parent=this.mRootNode;tempNode.setPosition(cc.Vec2.ZERO);var tempWidget=tempNode.addComponent(cc.Widget);this.initWidget(tempWidget,0,0,0,0);this.mBgSprite=tempNode.addComponent(cc.Sprite);this.getBase64SpFrame(this.mBgBase64,function(frame){frame.insetLeft=22;frame.insetTop=22;frame.insetRight=47;frame.insetBottom=47;_this.mBgSprite.type=cc.Sprite.Type.SLICED;_this.mBgSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;_this.mBgSprite.spriteFrame=frame});var temp1Node=new cc.Node("bgFrame");temp1Node.parent=this.mRootNode;temp1Node.setPosition(cc.Vec2.ZERO);var temp1Widget=tempNode.addComponent(cc.Widget);this.initWidget(temp1Widget,0,0,0,0);this.mFrameSprite=temp1Node.addComponent(cc.Sprite);this.getBase64SpFrame(this.mFrameBase64,function(frame){frame.insetLeft=9;frame.insetTop=9;frame.insetRight=9;frame.insetBottom=9;_this.mFrameSprite.type=cc.Sprite.Type.SLICED;_this.mFrameSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;_this.mFrameSprite.spriteFrame=frame});var nodeScroll=new cc.Node("nodeScroll");nodeScroll.parent=this.mRootNode;nodeScroll.setPosition(cc.Vec2.ZERO);var nodeScrollWidget=nodeScroll.addComponent(cc.Widget);this.initWidget(nodeScrollWidget,0,0,0,0);this.mScrollView=nodeScroll.addComponent(cc.ScrollView);this.mScrollView.horizontal=false;this.mScrollView.vertical=false;this.mScrollView.inertia=false;var nodeView=new cc.Node("nodeView");nodeView.parent=nodeScroll;nodeView.setPosition(cc.Vec2.ZERO);nodeView.addComponent(cc.Mask);var nodeViewWidget=nodeView.addComponent(cc.Widget);this.initWidget(nodeViewWidget,0,0,0,0);this.mContent=new cc.Node("mContent");this.mContent.parent=nodeView;this.mContent.setPosition(cc.Vec2.ZERO);var mContentWidget=this.mContent.addComponent(cc.Widget);this.mScrollView.content=this.mContent;this.initWidget(mContentWidget,0,0,0,0);console.log(this.mContent.getContentSize());var layout=this.mContent.addComponent(cc.Layout);layout.type=cc.Layout.Type.GRID;layout.resizeMode=cc.Layout.ResizeMode.CONTAINER;layout.startAxis=cc.Layout.AxisDirection.HORIZONTAL;layout.horizontalDirection=cc.Layout.HorizontalDirection.LEFT_TO_RIGHT;layout.verticalDirection=cc.Layout.VerticalDirection.TOP_TO_BOTTOM;layout.paddingLeft=20;layout.paddingRight=20;layout.paddingTop=15;layout.paddingBottom=15;layout.spacingX=10;layout.spacingY=10;this.mSignleCache=new cc.Node("itemCacheNode");this.mSignleCache.setContentSize(180,230);this.mSignleCache.setPosition(cc.Vec2.ZERO);this.mSignleCache.active=true;var singleLayout=this.mSignleCache.addComponent(cc.Layout);singleLayout.type=cc.Layout.Type.VERTICAL;singleLayout.resizeMode=cc.Layout.ResizeMode.NONE;singleLayout.verticalDirection=cc.Layout.VerticalDirection.TOP_TO_BOTTOM;singleLayout.paddingTop=0;singleLayout.paddingBottom=0;singleLayout.spacingY=0;var itemIconNode=new cc.Node("itemIconNode");itemIconNode.setContentSize(180,180);itemIconNode.setPosition(cc.Vec2.ZERO);itemIconNode.parent=this.mSignleCache;var itemBgSprite=itemIconNode.addComponent(cc.Sprite);itemBgSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;itemBgSprite.enabled=true;var itemTitleNode=new cc.Node("itemTitleNode");itemTitleNode.setContentSize(180,50);itemTitleNode.setPosition(cc.Vec2.ZERO);itemTitleNode.parent=this.mSignleCache;var itemTitleSprite=itemTitleNode.addComponent(cc.Sprite);itemTitleSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;itemTitleSprite.enabled=true;var itemTitleLabelNode=new cc.Node("itemTitleLabelNode");itemTitleLabelNode.setContentSize(180,50);itemTitleLabelNode.setPosition(cc.Vec2.ZERO);itemTitleLabelNode.parent=itemTitleNode;var itemTitleLabel=itemTitleLabelNode.addComponent(cc.RichText);itemTitleLabel.fontSize=28;itemTitleLabel.horizontalAlign=cc.macro.TextAlignment.CENTER;itemTitleLabel.maxWidth=180;itemTitleLabel.lineHeight=50;itemTitleLabel.useSystemFont=true;itemTitleLabel.enabled=true};CCADGridUI.create=function(dataList,background,border){var _this=this;var itemCount=dataList.length>6?6:dataList.length;if(this.mRootNode){this.mRootNode.destroyAllChildren();this.mRootNode.destroy()}this.init(itemCount);this.mHorizonList=[];var _loop_2=function(i){var mSingle=cc.instantiate(this_2.mSignleCache);mSingle.parent=this_2.mContent;if(dataList[i]["atlas_photo"]&&dataList[i]["atlas_config"]){mpsdk.gif.CocosGifAnim.getGifAnim(dataList[i]["atlas_photo"],dataList[i]["atlas_config"],this_2.getItemIconNode(mSingle)).then(function(){})}else{this_2.loadUrlRes(dataList[i]["icon"],this_2.getItemIconNode(mSingle))}this_2.setItemNameNode(dataList[i],mSingle);mSingle.on(cc.Node.EventType.TOUCH_END,function(){mpsdk.Ad.click(dataList[i])});this_2.mHorizonList.push(mSingle)};var this_2=this;for(var i=0;i<itemCount;i++){_loop_2(i)}CCADGridUI.mRootNode.on("size-changed",function(){_this.itemAdapt(itemCount)});this.mScrollView.node.on(cc.Node.EventType.TOUCH_START,function(){});this.mBgSprite.node.color=new cc.Color(background.getR(),background.getG(),background.getB());this.mBgSprite.node.opacity=background.getA();if(border){this.mFrameSprite.node.active=true;this.mFrameSprite.node.color=new cc.Color(border.getR(),border.getG(),border.getB());this.mFrameSprite.node.opacity=border.getA()}else{this.mFrameSprite.node.active=false}this.itemAdapt(itemCount);return this.mRootNode};CCADGridUI.itemAdapt=function(itemCount){var w=600;var h=500;if(itemCount==3){w=600;h=260}else if(itemCount==2){w=410;h=260}else if(itemCount==1){w=220;h=260}this.mRootNode.setContentSize(w,h);for(var _i=0,_a=this.mWidgetList;_i<_a.length;_i++){var a=_a[_i];a.updateAlignment()}var contentLayout=this.mContent.getComponent(cc.Layout);contentLayout.updateLayout();var itemLayoutArray=contentLayout.getComponentsInChildren(cc.Layout);itemLayoutArray.forEach(function(itemLayout){itemLayout.updateLayout()});this.mScrollView.scrollToLeft(0)};CCADGridUI.setItemNameNode=function(itemData,itemNode){if(!itemData||!itemNode)return;if(cc.isValid(itemNode)){var nameNode=itemNode.getChildByName("itemTitleNode");nameNode.width=180;nameNode.height=50;var nameLabelNode=nameNode.getChildByName("itemTitleLabelNode");var name_2=itemData["title"];var nameBg=itemData["title_bg"];var isBold=itemData["is_bold"];if(name_2&&name_2.length>5){name_2=name_2.substring(0,4)+"..."}nameLabelNode.width=180;nameLabelNode.height=50;if(nameBg){this.loadUrlRes(nameBg,nameNode)}if(isBold&&isBold=="2"){name_2="<b>"+name_2+"</b>"}nameLabelNode.getComponent(cc.RichText).string=name_2}};CCADGridUI.getItemIconNode=function(itemNode){var itemIconNode=itemNode.getChildByName("itemIconNode");itemIconNode.width=180;itemIconNode.height=180;return itemIconNode};CCADGridUI.loadUrlRes=function(url,imgNode){if(!url||!imgNode)return;var resetImgScale=function(spriteFrame){if(cc.isValid(imgNode)){var w=imgNode.width;var h=imgNode.height;imgNode.getComponent(cc.Sprite).spriteFrame=spriteFrame;imgNode.width=w;imgNode.height=h}};cc.loader.load({url:url,type:"png"},function(err,texture){if(err){cc.error(err.message||err);return}resetImgScale(new cc.SpriteFrame(texture))}.bind(this))};CCADGridUI.getBase64SpFrame=function(baseStr,callback){var img=new Image;img.src=baseStr;img.onload=function(){var textrue=new cc.Texture2D;textrue.initWithElement(img);textrue.handleLoadedTexture();var newFrame=new cc.SpriteFrame(textrue);callback&&callback(newFrame)}};CCADGridUI.initWidget=function(mWidget,top,left,right,bottom){this.mWidgetList.push(mWidget);mWidget.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE;if(top!==undefined){mWidget.isAlignTop=true;mWidget.top=top}if(left!==undefined){mWidget.isAlignLeft=true;mWidget.left=left}if(right!==undefined){mWidget.isAlignRight=true;mWidget.right=right}if(bottom!==undefined){mWidget.isAlignBottom=true;mWidget.bottom=bottom}};CCADGridUI.setBgFrame=function(mFrame){this.mFrameSprite.spriteFrame=mFrame};CCADGridUI.setBg=function(mBgSprite){this.mBgSprite.spriteFrame=mBgSprite};CCADGridUI.mBgBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAABoCAYAAABPP4jqAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFGRTc0RUYzM0NDMDExRTk5QzdFQTg3RTAxOTlBN0FEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFGRTc0RUY0M0NDMDExRTk5QzdFQTg3RTAxOTlBN0FEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUZFNzRFRjEzQ0MwMTFFOTlDN0VBODdFMDE5OUE3QUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUZFNzRFRjIzQ0MwMTFFOTlDN0VBODdFMDE5OUE3QUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6tPwHyAAADr0lEQVR42uzcS0hUYRQH8OPozEiSWWpWhBVJb9RKiyJt0dOVWBa1qEVKbwiqTbRo0SaIICLohQUJvegFERRZYDNqqaUTRTHRA9/DZEpkVk7YOTP32ud1amo1c6f/gf9iztyR+5t757ufmxOzfcV0+ovK5Czi5HEWcMZxrBS+6uE0cxo5Do6T8yzUh+JCvF/C2cyZR5FVCZxpWtZpvVrOaU7Zv2JTOCc4xWSemqelgLON4zUeYAnyoQ2cBpNB1VrNeao5/nhl5YDzQw6Ks1LmwiWUxZk0PZtGJI/298JV33q/UPeHDmp+85JcVRX0rOYB+Xx96iHjFUe53oxRFqg0Tr124EBlLVxKRaV7KXVcesReSm9bE90sO0KNVfeMb7VwcjgeeRGbm5FKyjcwf+D+tsRS4abdtHb7fkoYPiKi71s5v7mLC8hmjye3q5b6+/v1txI5kzmXVewOzh71Dwh02ZoSU/1YJ8+cQ1abnV411KhtuXU7ZbXWF6iN6ruz85abDqqXnLecf5C1yL8az1Wfo7LwFG/ZR2au4q37jAuo+HIs2s7o11XNX0FJKWmmxiYlp9Gc/JXG9iKLtgX8tfouWErRUPKYNFSeYHPVzoSps6ICmz5liMN/G49RO4kjU6ICmzgq1dgaK1jboN2S1RYV2CA7PKuF/qMCFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGD/d+xntfG1tycqYIZpfVJ9gm1XO58+eqMCG8TRLthBM0Zb37qjAtvkfm5s1QvWoXZcNRVRgXVV3ze2HIJ1qp2Gh3ep+4PH1NDuTg89ddw1tp2CfUKBCbIDP+xrpw6ZGnvt5CHy9X1XW3X6bSw1aD6qfCsVV8+aEirnHeSq+n36RE2RZ1NgXrC/3I2P/WM5J07NNA208tYFunHmsDo+VOomadNC1VmplZz1FJgv6v/AizoHtb1/TekZMyJ6XqoMhr147ADdv3rOCG3lFOp7CRUrDXk4FalHdzS9Iefty+RpeSffAFnt8WSPH0YWS/g2Xz98PurytvPd94juXDpFV44f9F+UILWTU62/iAkyk1zmih7ljDLxGtXF2UXKbOPf7Y3lAPmhXjcp9IZ2/uV/+4+A3Osy7rpUfSxFeNVq57uKAkOch1SoafNlWmT6sz5aX6bmhnu0vuzy27Q9gj5avz7Uh34KMADL1+NYuYA3AwAAAABJRU5ErkJggg==";CCADGridUI.mFrameBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAB5SURBVHja7M8xDkFBFEDRM+NXfqKg0SgswR6sSamyDrEGpUqvsgdKtYj8PI0VjKlk7gJOclNErLHFA4GkrB6nFBEX7HHEqBAcMMOuwx0HPP3WDef83Zyr0zirXAMb2MD/Al+VvHfGApNK4DJFxAYrXNEVQgOm6D8DAJXuGl33vXhMAAAAAElFTkSuQmCC";CCADGridUI.mHorizonList=[];CCADGridUI.mWidgetList=[];return CCADGridUI}();ui.CCADGridUI=CCADGridUI})(ui=mpsdk.ui||(mpsdk.ui={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ui;(function(ui){var CCADListUI=function(){function CCADListUI(){}CCADListUI.init=function(){var _this=this;this.nowIndex=0;this.mWidgetList=[];this.mRootNode=new cc.Node("SuggestBottom");this.mRootNode.setContentSize(630,200);var tempNode=new cc.Node("bg");tempNode.parent=this.mRootNode;var tempWidget=tempNode.addComponent(cc.Widget);this.initWidget(tempWidget,0,0,0,0);this.mBgSprite=tempNode.addComponent(cc.Sprite);this.getBase64SpFrame(this.mBgBase64,function(frame){frame.insetLeft=22;frame.insetTop=22;frame.insetRight=47;frame.insetBottom=47;_this.mBgSprite.type=cc.Sprite.Type.SLICED;_this.mBgSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;_this.mBgSprite.spriteFrame=frame});var temp1Node=new cc.Node("bgFrame");temp1Node.parent=this.mRootNode;var temp1Widget=tempNode.addComponent(cc.Widget);this.initWidget(temp1Widget,0,0,0,0);this.mFrameSprite=temp1Node.addComponent(cc.Sprite);this.getBase64SpFrame(this.mFrameBase64,function(frame){frame.insetLeft=9;frame.insetTop=9;frame.insetRight=9;frame.insetBottom=9;_this.mFrameSprite.type=cc.Sprite.Type.SLICED;_this.mBgSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;_this.mFrameSprite.spriteFrame=frame});var nodeScroll=new cc.Node("nodeScroll");nodeScroll.parent=this.mRootNode;var nodeScrollWidget=nodeScroll.addComponent(cc.Widget);this.initWidget(nodeScrollWidget,0,50,5,0);this.mScrollView=nodeScroll.addComponent(cc.ScrollView);this.mScrollView.horizontal=true;this.mScrollView.vertical=false;nodeScroll.setPosition(cc.Vec2.ZERO);var nodeView=new cc.Node("nodeView");nodeView.parent=nodeScroll;nodeView.setPosition(cc.Vec2.ZERO);nodeView.addComponent(cc.Mask);this.mNodeView=nodeView;var nodeViewWidget=nodeView.addComponent(cc.Widget);this.initWidget(nodeViewWidget,0,0,0,0);this.mContent=new cc.Node("mContent");this.mContent.parent=nodeView;this.mContent.setPosition(cc.Vec2.ZERO);var mContentWidget=this.mContent.addComponent(cc.Widget);this.mScrollView.content=this.mContent;this.initWidget(mContentWidget,15,undefined,undefined,15);console.log(this.mContent.getContentSize());var layout=this.mContent.addComponent(cc.Layout);layout.type=cc.Layout.Type.HORIZONTAL;layout.resizeMode=cc.Layout.ResizeMode.NONE;layout.horizontalDirection=cc.Layout.HorizontalDirection.LEFT_TO_RIGHT;layout.paddingLeft=0;layout.paddingRight=0;layout.spacingX=10;var nodeLabelLike=new cc.Node;nodeLabelLike.parent=this.mRootNode;var nodeLabelWidget=nodeLabelLike.addComponent(cc.Widget);nodeLabelLike.width=40;this.initWidget(nodeLabelWidget,5,5,undefined,5);nodeLabelLike.color=cc.Color.WHITE;this.mLikeLabel=nodeLabelLike.addComponent(cc.Label);this.mLikeLabel.string="猜你喜欢";this.mLikeLabel.verticalAlign=cc.Label.VerticalAlign.CENTER;this.mLikeLabel.overflow=cc.Label.Overflow.SHRINK;this.mSignleCache=new cc.Node("itemCacheNode");this.mSignleCache.setContentSize(135,170);this.mSignleCache.setPosition(cc.Vec2.ZERO);this.mSignleCache.active=true;var singleLayout=this.mSignleCache.addComponent(cc.Layout);singleLayout.type=cc.Layout.Type.VERTICAL;singleLayout.resizeMode=cc.Layout.ResizeMode.NONE;singleLayout.verticalDirection=cc.Layout.VerticalDirection.TOP_TO_BOTTOM;singleLayout.paddingTop=0;singleLayout.paddingBottom=0;singleLayout.spacingY=0;var itemIconNode=new cc.Node("itemIconNode");itemIconNode.setContentSize(135,135);itemIconNode.setPosition(cc.Vec2.ZERO);itemIconNode.parent=this.mSignleCache;var itemBgSprite=itemIconNode.addComponent(cc.Sprite);itemBgSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;itemBgSprite.enabled=true;var itemTitleNode=new cc.Node("itemTitleNode");itemTitleNode.setContentSize(135,35);itemTitleNode.setPosition(cc.Vec2.ZERO);itemTitleNode.parent=this.mSignleCache;var itemTitleSprite=itemTitleNode.addComponent(cc.Sprite);itemTitleSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM;itemTitleSprite.enabled=true;var itemTitleLabelNode=new cc.Node("itemTitleLabelNode");itemTitleLabelNode.setContentSize(135,35);itemTitleLabelNode.setPosition(cc.Vec2.ZERO);itemTitleLabelNode.parent=itemTitleNode;var itemTitleLabel=itemTitleLabelNode.addComponent(cc.RichText);itemTitleLabel.fontSize=24;itemTitleLabel.horizontalAlign=cc.macro.TextAlignment.CENTER;itemTitleLabel.maxWidth=135;itemTitleLabel.lineHeight=35;itemTitleLabel.useSystemFont=true;itemTitleLabel.enabled=true;this.actionAnim=cc.sequence(cc.scaleTo(.3,1.3,1.3),cc.scaleTo(1,1,1))};CCADListUI.create=function(dataList,background,border){var _this=this;this.MaxCount=dataList.length;this.MaxPage=Math.max(this.MaxCount-4,0);this.nowShowCount=this.MaxCount>4?4:this.MaxCount;if(this.mRootNode){this.mRootNode.destroyAllChildren();this.mRootNode.destroy()}this.init();this.mHorizonList=[];var _loop_3=function(i){var mSingle=cc.instantiate(this_3.mSignleCache);mSingle.parent=this_3.mContent;if(dataList[i]["atlas_photo"]&&dataList[i]["atlas_config"]){mpsdk.gif.CocosGifAnim.getGifAnim(dataList[i]["atlas_photo"],dataList[i]["atlas_config"],this_3.getItemIconNode(mSingle)).then(function(){})}else{this_3.loadUrlRes(dataList[i]["icon"],this_3.getItemIconNode(mSingle))}this_3.setItemNameNode(dataList[i],mSingle);mSingle.on(cc.Node.EventType.TOUCH_END,function(){mpsdk.Ad.click(dataList[i])});this_3.mHorizonList.push(mSingle)};var this_3=this;for(var i=0;i<this.MaxCount;i++){_loop_3(i)}CCADListUI.mRootNode.on("size-changed",function(){_this.itemAdapt()});this.mScrollView.node.on(cc.Node.EventType.TOUCH_START,function(){var list=CCADListUI.mHorizonList;for(var i=0;i<list.length;i++){_this.getItemIconNode(list[i]).getComponent(cc.Sprite).enabled=true}});this.mBgSprite.node.color=new cc.Color(background.getR(),background.getG(),background.getB());this.mBgSprite.node.opacity=background.getA();if(border){this.mFrameSprite.node.active=true;this.mFrameSprite.node.color=new cc.Color(border.getR(),border.getG(),border.getB());this.mFrameSprite.node.opacity=border.getA()}else{this.mFrameSprite.node.active=false}this.itemAdapt();this.playAnim();return this.mRootNode};CCADListUI.itemAdapt=function(){for(var _i=0,_a=this.mWidgetList;_i<_a.length;_i++){var a=_a[_i];a.updateAlignment()}var MaxWidth=this.mNodeView.width;var MaxHeight=this.mNodeView.height;var singleWidth=MaxWidth/this.nowShowCount;var val=Math.min(singleWidth-10,MaxHeight);val-=3;if(val<40)return;for(var _b=0,_c=this.mHorizonList;_b<_c.length;_b++){var a=_c[_b];a.setContentSize(135,170)}val=135;var spacing=(MaxWidth-val*this.nowShowCount)/(this.nowShowCount+1);this.mContent.width=this.mHorizonList.length*(spacing+val)+val;console.log("mContent.width:",this.mContent.width," , spacing:",spacing," , MaxWidth:",MaxWidth," , MaxHeight:",MaxHeight);var contentLayout=this.mContent.getComponent(cc.Layout);contentLayout.spacingX=spacing;contentLayout.updateLayout();var itemLayoutArray=contentLayout.getComponentsInChildren(cc.Layout);itemLayoutArray.forEach(function(itemLayout){itemLayout.updateLayout()});this.MaxPage=Math.max(this.mHorizonList.length-4,0);this.MaxPage=this.MaxPage>0?this.MaxPage:0;this.mScrollView.scrollToLeft(0)};CCADListUI.playAnim=function(){var _this=this;this.mScrollView.unscheduleAllCallbacks();this.mScrollView.schedule(function(){if(CCADListUI.nowIndex<=0){CCADListUI.nowAngel=1}else if(CCADListUI.nowIndex>=CCADListUI.mHorizonList.length-_this.nowShowCount){CCADListUI.nowAngel=-1}CCADListUI.nowIndex+=CCADListUI.nowAngel>0?1:-1;CCADListUI.mScrollView.scrollToPercentHorizontal(CCADListUI.nowIndex/(CCADListUI.mHorizonList.length-_this.nowShowCount),2);var ran=Math.floor(Math.random()*_this.nowShowCount);var list=CCADListUI.mHorizonList;for(var i=0;i<list.length;i++){for(var i_1=0;i_1<list.length;i_1++){if(i_1<CCADListUI.nowIndex-1||i_1>CCADListUI.nowIndex+_this.nowShowCount){_this.getItemIconNode(list[i_1]).getComponent(cc.Sprite).enabled=false}else{_this.getItemIconNode(list[i_1]).getComponent(cc.Sprite).enabled=true}}}var currentIndex=ran+CCADListUI.nowIndex;if(currentIndex<0){currentIndex=0}else if(currentIndex>=list.length){currentIndex=list.length-1}CCADListUI.mHorizonList[currentIndex].runAction(CCADListUI.actionAnim)},5)};CCADListUI.setItemNameNode=function(itemData,itemNode){if(!itemData||!itemNode)return;if(cc.isValid(itemNode)){var nameNode=itemNode.getChildByName("itemTitleNode");nameNode.width=135;nameNode.height=35;var nameLabelNode=nameNode.getChildByName("itemTitleLabelNode");var name_3=itemData["title"];var nameBg=itemData["title_bg"];var isBold=itemData["is_bold"];if(name_3&&name_3.length>5){name_3=name_3.substring(0,4)+"..."}nameLabelNode.width=135;nameLabelNode.height=135;if(nameBg){this.loadUrlRes(nameBg,nameNode)}if(isBold&&isBold=="2"){name_3="<b>"+name_3+"</b>"}nameLabelNode.getComponent(cc.RichText).string=name_3}};CCADListUI.getItemIconNode=function(itemNode){var itemIconNode=itemNode.getChildByName("itemIconNode");itemIconNode.width=135;itemIconNode.height=135;return itemIconNode};CCADListUI.loadUrlRes=function(url,imgNode){if(!url||!imgNode)return;var resetImgScale=function(spriteFrame){if(cc.isValid(imgNode)){var w=imgNode.width;var h=imgNode.height;imgNode.getComponent(cc.Sprite).spriteFrame=spriteFrame;imgNode.width=w;imgNode.height=h}};cc.loader.load({url:url,type:"png"},function(err,texture){if(err){cc.error(err.message||err);return}resetImgScale(new cc.SpriteFrame(texture))}.bind(this))};CCADListUI.getBase64SpFrame=function(baseStr,callback){var img=new Image;img.src=baseStr;img.onload=function(){var textrue=new cc.Texture2D;textrue.initWithElement(img);textrue.handleLoadedTexture();var newFrame=new cc.SpriteFrame(textrue);callback&&callback(newFrame)}};CCADListUI.initWidget=function(mWidget,top,left,right,bottom){this.mWidgetList.push(mWidget);mWidget.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE;if(top!==undefined){mWidget.isAlignTop=true;mWidget.top=top}if(left!==undefined){mWidget.isAlignLeft=true;mWidget.left=left}if(right!==undefined){mWidget.isAlignRight=true;mWidget.right=right}if(bottom!==undefined){mWidget.isAlignBottom=true;mWidget.bottom=bottom}};CCADListUI.setBgFrame=function(mFrame){this.mFrameSprite.spriteFrame=mFrame};CCADListUI.setBg=function(mBgSprite){this.mBgSprite.spriteFrame=mBgSprite};CCADListUI.getLikeLabel=function(){return this.mLikeLabel};CCADListUI.getGifAnim=function(pngPath,jsonPath,single){return new Promise(function(resolve,reject){cc.loader.load([pngPath,jsonPath],function(err,result){if(err){console.log(err);reject&&reject(err)}else{var json=result.getContent(jsonPath);var png=result.getContent(pngPath);var list=[];for(var i=0;i<json.frames.length;i++){var frame=json.frames[i].frame;var mSprite=new cc.SpriteFrame(png,cc.rect(frame.x,frame.y,frame.w,frame.h));list[i]=mSprite}var mAnimation=single.addComponent(cc.Animation);var clip=cc.AnimationClip.createWithSpriteFrames(list,8);clip.name="gifAnim";clip.wrapMode=cc.WrapMode.Loop;mAnimation.addClip(clip);mAnimation.play("gifAnim");resolve&&resolve(mAnimation)}})})};CCADListUI.mBgBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAABoCAYAAABPP4jqAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFGRTc0RUYzM0NDMDExRTk5QzdFQTg3RTAxOTlBN0FEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFGRTc0RUY0M0NDMDExRTk5QzdFQTg3RTAxOTlBN0FEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUZFNzRFRjEzQ0MwMTFFOTlDN0VBODdFMDE5OUE3QUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUZFNzRFRjIzQ0MwMTFFOTlDN0VBODdFMDE5OUE3QUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6tPwHyAAADr0lEQVR42uzcS0hUYRQH8OPozEiSWWpWhBVJb9RKiyJt0dOVWBa1qEVKbwiqTbRo0SaIICLohQUJvegFERRZYDNqqaUTRTHRA9/DZEpkVk7YOTP32ud1amo1c6f/gf9iztyR+5t757ufmxOzfcV0+ovK5Czi5HEWcMZxrBS+6uE0cxo5Do6T8yzUh+JCvF/C2cyZR5FVCZxpWtZpvVrOaU7Zv2JTOCc4xWSemqelgLON4zUeYAnyoQ2cBpNB1VrNeao5/nhl5YDzQw6Ks1LmwiWUxZk0PZtGJI/298JV33q/UPeHDmp+85JcVRX0rOYB+Xx96iHjFUe53oxRFqg0Tr124EBlLVxKRaV7KXVcesReSm9bE90sO0KNVfeMb7VwcjgeeRGbm5FKyjcwf+D+tsRS4abdtHb7fkoYPiKi71s5v7mLC8hmjye3q5b6+/v1txI5kzmXVewOzh71Dwh02ZoSU/1YJ8+cQ1abnV411KhtuXU7ZbXWF6iN6ruz85abDqqXnLecf5C1yL8az1Wfo7LwFG/ZR2au4q37jAuo+HIs2s7o11XNX0FJKWmmxiYlp9Gc/JXG9iKLtgX8tfouWErRUPKYNFSeYHPVzoSps6ICmz5liMN/G49RO4kjU6ICmzgq1dgaK1jboN2S1RYV2CA7PKuF/qMCFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGCBBRZYYIEFFlhggQUWWGD/d+xntfG1tycqYIZpfVJ9gm1XO58+eqMCG8TRLthBM0Zb37qjAtvkfm5s1QvWoXZcNRVRgXVV3ze2HIJ1qp2Gh3ep+4PH1NDuTg89ddw1tp2CfUKBCbIDP+xrpw6ZGnvt5CHy9X1XW3X6bSw1aD6qfCsVV8+aEirnHeSq+n36RE2RZ1NgXrC/3I2P/WM5J07NNA208tYFunHmsDo+VOomadNC1VmplZz1FJgv6v/AizoHtb1/TekZMyJ6XqoMhr147ADdv3rOCG3lFOp7CRUrDXk4FalHdzS9Iefty+RpeSffAFnt8WSPH0YWS/g2Xz98PurytvPd94juXDpFV44f9F+UILWTU62/iAkyk1zmih7ljDLxGtXF2UXKbOPf7Y3lAPmhXjcp9IZ2/uV/+4+A3Osy7rpUfSxFeNVq57uKAkOch1SoafNlWmT6sz5aX6bmhnu0vuzy27Q9gj5avz7Uh34KMADL1+NYuYA3AwAAAABJRU5ErkJggg==";CCADListUI.mFrameBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAB5SURBVHja7M8xDkFBFEDRM+NXfqKg0SgswR6sSamyDrEGpUqvsgdKtYj8PI0VjKlk7gJOclNErLHFA4GkrB6nFBEX7HHEqBAcMMOuwx0HPP3WDef83Zyr0zirXAMb2MD/Al+VvHfGApNK4DJFxAYrXNEVQgOm6D8DAJXuGl33vXhMAAAAAElFTkSuQmCC";CCADListUI.mHorizonList=[];CCADListUI.MaxCount=0;CCADListUI.MaxPage=0;CCADListUI.nowIndex=0;CCADListUI.animPosX=0;CCADListUI.nowAngel=1;CCADListUI.nowShowCount=0;CCADListUI.mWidgetList=[];return CCADListUI}();ui.CCADListUI=CCADListUI})(ui=mpsdk.ui||(mpsdk.ui={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ui;(function(ui){var LayaADGridUI=function(){function LayaADGridUI(){}LayaADGridUI.createBg=function(){this.View.width=this._width;this.View.height=this._height;if(this._bg==null){this._bg=new Laya.Sprite;this.View.addChild(this._bg)}this._bg.graphics.clear();this._bg.graphics.drawRect(0,0,this._width,this._height,this._bgColor,this._lineColor);this._bg.width=this._width;this._bg.height=this._height;this._bg.alpha=.6;if(this._iconPanel==null){this._iconPanel=new Laya.Sprite;this._viewPortPanel=new Laya.Sprite;this.View.addChild(this._viewPortPanel);this._viewPortPanel.addChild(this._iconPanel);Laya.timer.frameLoop(1,this,this.update)}this._viewPortPanel.width=this._iconPanel.width=this._width*.9;this._viewPortPanel.height=this._iconPanel.height=this._height*.8;this._viewPortPanel.x=this._width*.05;this._viewPortPanel.y=this._height*.1;this._viewPortPanel.scrollRect=new Laya.Rectangle(0,0,this._viewPortPanel.width,this._viewPortPanel.height)};LayaADGridUI.createMovieItem=function(data,index){var _this=this;var photourl=data["atlas_photo"];var configurl=data["atlas_config"];var titleurl=data["title_bg"];var iconurl=data["icon"];var iconname=data["title"];var isBold=data["is_bold"]?data["is_bold"]==2:false;var pngurl=photourl?photourl:iconurl;if(pngurl==null){return}var w=this._viewPortPanel.width/LayaADGridUI._hlen;var h=this._viewPortPanel.height/LayaADGridUI._vlen;var max=w>h?h:w;mpsdk.gif.LayaGifAnimLoader.Load(pngurl,configurl,titleurl,iconname,isBold).then(function(mAnim){var cw=mAnim.View.width;var ch=mAnim.View.height;var scale=max/ch;var tw=cw*scale;var th=ch*scale;var hgap=max-cw;mAnim.View.scale(scale,scale);mAnim.View.pivot(cw/2,th/2);mAnim.View.x=tw/2+(tw+hgap)*(index%LayaADGridUI._hlen);mAnim.View.y=th/2+(th+hgap)*Math.floor(index/LayaADGridUI._hlen);_this._iconPanel.addChild(mAnim.View);_this._iconPanel.width=mAnim.View.x+tw-tw/2;mAnim.View.on(Laya.Event.CLICK,_this,function(){if(_this._downX>=0){return}mpsdk.Ad.click(data)});_this._movieList.push(mAnim)}).catch(function(){if(photourl==null){return}var tempData=data;tempData["atlas_photo"]=null;tempData["atlas_config"]=null;_this.createMovieItem(tempData,index)})};LayaADGridUI.createMovieList=function(dataList){var len=dataList.length;for(var i=0;i<len;i++){this.createMovieItem(dataList[i],i)}};LayaADGridUI.removeMovieList=function(){if(this._movieList==null){this._movieList=[];return}var len=this._movieList.length;for(var i=len-1;i>=0;i--){var m=this._movieList[i];m.Destroy();this._movieList.splice(i,1)}};LayaADGridUI.updateIconPanel=function(){};LayaADGridUI.updateMovie=function(){for(var _i=0,_a=this._movieList;_i<_a.length;_i++){var i=_a[_i];i.Update()}};LayaADGridUI.update=function(e){this.updateIconPanel();this.updateMovie()};LayaADGridUI.Create=function(dataList,bgcolor,linecolor){if(bgcolor===void 0){bgcolor="#000000"}if(linecolor===void 0){linecolor=""}this._bgColor=bgcolor;this._lineColor=linecolor;this.removeMovieList();this.createBg();this.createMovieList(dataList);return this.View};Object.defineProperty(LayaADGridUI,"View",{get:function(){if(this._root==null){this._root=new Laya.Sprite}return this._root},enumerable:true,configurable:true});LayaADGridUI._width=600;LayaADGridUI._height=500;LayaADGridUI._hlen=3;LayaADGridUI._vlen=2;LayaADGridUI._bgColor="#000000";LayaADGridUI._lineColor="#ffffff";LayaADGridUI._downX=-1;return LayaADGridUI}();ui.LayaADGridUI=LayaADGridUI})(ui=mpsdk.ui||(mpsdk.ui={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ui;(function(ui){var LayaADListUI=function(){function LayaADListUI(){}LayaADListUI.createBg=function(){this.View.width=this._width;this.View.height=this._height;if(this._bg==null){this._bg=new Laya.Sprite;this.View.addChild(this._bg)}this._bg.graphics.clear();this._bg.graphics.drawRect(0,0,this._width,this._height,this._bgColor,this._lineColor);this._bg.width=this._width;this._bg.height=this._height;this._bg.alpha=.6;if(this._cnxhtitle==null){this._cnxhtitle=new Laya.Text;this.View.addChild(this._cnxhtitle)}this._cnxhtitle.x=this._width*.02;this._cnxhtitle.y=this._height*.1;this._cnxhtitle.width=this._width*.06;this._cnxhtitle.height=this._height*.8;this._cnxhtitle.leading=2;this._cnxhtitle.fontSize=Math.floor(this._cnxhtitle.height/4)-2;this._cnxhtitle.color=this._lineColor;this._cnxhtitle.text="猜\n你\n喜\n欢";if(this._iconPanel==null){this._iconPanel=new Laya.Sprite;this._viewPortPanel=new Laya.Sprite;this.View.addChild(this._viewPortPanel);this._viewPortPanel.addChild(this._iconPanel);this._viewPortPanel.on(Laya.Event.MOUSE_DOWN,this,this.onDown);this._viewPortPanel.on(Laya.Event.MOUSE_MOVE,this,this.onMove);this._viewPortPanel.on(Laya.Event.MOUSE_OUT,this,this.onUp);this._viewPortPanel.on(Laya.Event.MOUSE_UP,this,this.onUp);Laya.timer.frameLoop(1,this,this.update)}this._viewPortPanel.width=this._iconPanel.width=this._width*.85;this._viewPortPanel.height=this._iconPanel.height=this._height*.8;this._viewPortPanel.x=this._width*.1;this._viewPortPanel.y=this._height*.1;this._viewPortPanel.scrollRect=new Laya.Rectangle(0,0,this._viewPortPanel.width,this._viewPortPanel.height)};LayaADListUI.createMovieItem=function(data,index){var _this=this;var photourl=data["atlas_photo"];var configurl=data["atlas_config"];var titleurl=data["title_bg"];var iconurl=data["icon"];var iconname=data["title"];var isBold=data["is_bold"]?data["is_bold"]==2:false;var pngurl=photourl?photourl:iconurl;if(pngurl==null){return}var w=(this._viewPortPanel.width-10)/4;w=w>LayaADListUI._viewPortPanel.height?LayaADListUI._viewPortPanel.height:w;mpsdk.gif.LayaGifAnimLoader.Load(pngurl,configurl,titleurl,iconname,isBold).then(function(mAnim){var cw=mAnim.View.width;var scale=w/cw;var tw=cw*scale;mAnim.View.scale(scale,scale);mAnim.View.pivot(cw/2,cw/2);mAnim.View.y=0+tw/2;mAnim.View.x=tw/2+(tw+10)*index;_this._iconPanel.addChild(mAnim.View);_this._iconPanel.width=mAnim.View.x+tw-tw/2;mAnim.View.on(Laya.Event.CLICK,_this,function(){if(_this._downX>=0){return}mpsdk.Ad.click(data)});_this._movieList.push(mAnim)}).catch(function(){if(photourl==null){return}var tempData=data;tempData["atlas_photo"]=null;tempData["atlas_config"]=null;_this.createMovieItem(tempData,index)})};LayaADListUI.createMovieList=function(dataList){var len=dataList.length;for(var i=0;i<len;i++){this.createMovieItem(dataList[i],i)}};LayaADListUI.removeMovieList=function(){if(this._movieList==null){this._movieList=[];return}var len=this._movieList.length;for(var i=len-1;i>=0;i--){var m=this._movieList[i];m.Destroy();this._movieList.splice(i,1)}};LayaADListUI.updateIconPanel=function(){if(this._downX>=0){return}var right=-(this._iconPanel.width-this._viewPortPanel.width);this._anidelay-=Laya.timer.delta;if(right>0||this._anidelay>0){return}this._iconPanel.x+=this._speed;if(this._iconPanel.x<=right){this._iconPanel.x=right;this._speed=this.SPEED;this._anidelay=1e3}if(this._iconPanel.x>=0){this._iconPanel.x=0;this._speed=-this.SPEED;this._anidelay=1e3}};LayaADListUI.updateMovie=function(){for(var _i=0,_a=this._movieList;_i<_a.length;_i++){var i=_a[_i];i.Update()}};LayaADListUI.update=function(e){this.updateIconPanel();this.updateMovie()};LayaADListUI.Create=function(dataList,bgcolor,linecolor){if(bgcolor===void 0){bgcolor="#000000"}if(linecolor===void 0){linecolor="#ffffff"}this._bgColor=bgcolor;this._lineColor=linecolor;this.removeMovieList();this.createBg();this.createMovieList(dataList);return this.View};LayaADListUI.onDown=function(e){this._downX=e.stageX};LayaADListUI.onMove=function(e){if(this._downX<0){return}var dx=e.stageX-this._downX;this._iconPanel.x+=dx;this._downX=e.stageX;if(dx>0)this._speed=this.SPEED;if(dx<0)this._speed=-this.SPEED};LayaADListUI.onUp=function(){this._downX=-1};Object.defineProperty(LayaADListUI,"View",{get:function(){if(this._root==null){this._root=new Laya.Sprite}return this._root},enumerable:true,configurable:true});LayaADListUI.SPEED=1;LayaADListUI._width=600;LayaADListUI._height=200;LayaADListUI._bgColor="#000000";LayaADListUI._lineColor="#ffffff";LayaADListUI._speed=-1;LayaADListUI._downX=-1;LayaADListUI._anidelay=0;return LayaADListUI}();ui.LayaADListUI=LayaADListUI})(ui=mpsdk.ui||(mpsdk.ui={}))})(mpsdk||(mpsdk={}));var mpsdk;(function(mpsdk){var ui;(function(ui){var LayaADSingleUI=function(){function LayaADSingleUI(){}LayaADSingleUI.init=function(){if(this._movieList==null){this._movieList=[];Laya.timer.frameLoop(1,this,this.update)}};LayaADSingleUI.createMovieItem=function(data,parent){var _this=this;var photourl=data["atlas_photo"];var configurl=data["atlas_config"];var titleurl=data["title_bg"];var iconurl=data["icon"];var iconname=data["title"];var isBold=data["is_bold"]?data["is_bold"]==2:false;if(this._showName==false)iconname="";var pngurl=photourl?photourl:iconurl;if(pngurl==null){return}mpsdk.gif.LayaGifAnimLoader.Load(pngurl,configurl,titleurl,iconname,isBold).then(function(mAnim){var cw=mAnim.View.width;var scale=_this._size/cw;mAnim.View.scale(scale,scale);mAnim.View.x=0;mAnim.View.y=0;parent.addChild(mAnim.View);_this._movieList.push(mAnim);mAnim.View.on(Laya.Event.CLICK,_this,function(){mpsdk.Ad.click(data)})}).catch(function(){if(photourl==null){return}var tempData=data;tempData["atlas_photo"]=null;tempData["atlas_config"]=null;_this.createMovieItem(tempData,parent)})};LayaADSingleUI.updateMovie=function(){var len=this._movieList.length;for(var i=len-1;i>=0;i--){if(this._movieList[i]&&this._movieList[i].View.parent&&this._movieList[i].View.parent.parent){this._movieList[i].Update()}else{if(this._movieList[i])this._movieList[i].Destroy();this._movieList.splice(i,1)}}};LayaADSingleUI.update=function(e){this.updateMovie()};LayaADSingleUI.Create=function(icondata,size,showname){if(size===void 0){size=100}if(showname===void 0){showname=true}this._size=size;this._showName=showname;this.init();var sp=new Laya.Sprite;sp.width=sp.height=size;this.createMovieItem(icondata,sp);return sp};return LayaADSingleUI}();ui.LayaADSingleUI=LayaADSingleUI})(ui=mpsdk.ui||(mpsdk.ui={}))})(mpsdk||(mpsdk={}));
/* global window, exports, define */

!function() {
    'use strict'

    var re = {
        not_string: /[^s]/,
        not_bool: /[^t]/,
        not_type: /[^T]/,
        not_primitive: /[^v]/,
        number: /[diefg]/,
        numeric_arg: /[bcdiefguxX]/,
        json: /[j]/,
        not_json: /[^j]/,
        text: /^[^\x25]+/,
        modulo: /^\x25{2}/,
        placeholder: /^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,
        key: /^([a-z_][a-z_\d]*)/i,
        key_access: /^\.([a-z_][a-z_\d]*)/i,
        index_access: /^\[(\d+)\]/,
        sign: /^[+-]/
    }

    function sprintf(key) {
        // `arguments` is not an array, but should be fine for this call
        return sprintf_format(sprintf_parse(key), arguments)
    }

    function vsprintf(fmt, argv) {
        return sprintf.apply(null, [fmt].concat(argv || []))
    }

    function sprintf_format(parse_tree, argv) {
        var cursor = 1, tree_length = parse_tree.length, arg, output = '', i, k, ph, pad, pad_character, pad_length, is_positive, sign
        for (i = 0; i < tree_length; i++) {
            if (typeof parse_tree[i] === 'string') {
                output += parse_tree[i]
            }
            else if (typeof parse_tree[i] === 'object') {
                ph = parse_tree[i] // convenience purposes only
                if (ph.keys) { // keyword argument
                    arg = argv[cursor]
                    for (k = 0; k < ph.keys.length; k++) {
                        if (arg == undefined) {
                            throw new Error(sprintf('[sprintf] Cannot access property "%s" of undefined value "%s"', ph.keys[k], ph.keys[k-1]))
                        }
                        arg = arg[ph.keys[k]]
                    }
                }
                else if (ph.param_no) { // positional argument (explicit)
                    arg = argv[ph.param_no]
                }
                else { // positional argument (implicit)
                    arg = argv[cursor++]
                }

                if (re.not_type.test(ph.type) && re.not_primitive.test(ph.type) && arg instanceof Function) {
                    arg = arg()
                }

                if (re.numeric_arg.test(ph.type) && (typeof arg !== 'number' && isNaN(arg))) {
                    throw new TypeError(sprintf('[sprintf] expecting number but found %T', arg))
                }

                if (re.number.test(ph.type)) {
                    is_positive = arg >= 0
                }

                switch (ph.type) {
                    case 'b':
                        arg = parseInt(arg, 10).toString(2)
                        break
                    case 'c':
                        arg = String.fromCharCode(parseInt(arg, 10))
                        break
                    case 'd':
                    case 'i':
                        arg = parseInt(arg, 10)
                        break
                    case 'j':
                        arg = JSON.stringify(arg, null, ph.width ? parseInt(ph.width) : 0)
                        break
                    case 'e':
                        arg = ph.precision ? parseFloat(arg).toExponential(ph.precision) : parseFloat(arg).toExponential()
                        break
                    case 'f':
                        arg = ph.precision ? parseFloat(arg).toFixed(ph.precision) : parseFloat(arg)
                        break
                    case 'g':
                        arg = ph.precision ? String(Number(arg.toPrecision(ph.precision))) : parseFloat(arg)
                        break
                    case 'o':
                        arg = (parseInt(arg, 10) >>> 0).toString(8)
                        break
                    case 's':
                        arg = String(arg)
                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)
                        break
                    case 't':
                        arg = String(!!arg)
                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)
                        break
                    case 'T':
                        arg = Object.prototype.toString.call(arg).slice(8, -1).toLowerCase()
                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)
                        break
                    case 'u':
                        arg = parseInt(arg, 10) >>> 0
                        break
                    case 'v':
                        arg = arg.valueOf()
                        arg = (ph.precision ? arg.substring(0, ph.precision) : arg)
                        break
                    case 'x':
                        arg = (parseInt(arg, 10) >>> 0).toString(16)
                        break
                    case 'X':
                        arg = (parseInt(arg, 10) >>> 0).toString(16).toUpperCase()
                        break
                }
                if (re.json.test(ph.type)) {
                    output += arg
                }
                else {
                    if (re.number.test(ph.type) && (!is_positive || ph.sign)) {
                        sign = is_positive ? '+' : '-'
                        arg = arg.toString().replace(re.sign, '')
                    }
                    else {
                        sign = ''
                    }
                    pad_character = ph.pad_char ? ph.pad_char === '0' ? '0' : ph.pad_char.charAt(1) : ' '
                    pad_length = ph.width - (sign + arg).length
                    pad = ph.width ? (pad_length > 0 ? pad_character.repeat(pad_length) : '') : ''
                    output += ph.align ? sign + arg + pad : (pad_character === '0' ? sign + pad + arg : pad + sign + arg)
                }
            }
        }
        return output
    }

    var sprintf_cache = Object.create(null)

    function sprintf_parse(fmt) {
        if (sprintf_cache[fmt]) {
            return sprintf_cache[fmt]
        }

        var _fmt = fmt, match, parse_tree = [], arg_names = 0
        while (_fmt) {
            if ((match = re.text.exec(_fmt)) !== null) {
                parse_tree.push(match[0])
            }
            else if ((match = re.modulo.exec(_fmt)) !== null) {
                parse_tree.push('%')
            }
            else if ((match = re.placeholder.exec(_fmt)) !== null) {
                if (match[2]) {
                    arg_names |= 1
                    var field_list = [], replacement_field = match[2], field_match = []
                    if ((field_match = re.key.exec(replacement_field)) !== null) {
                        field_list.push(field_match[1])
                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {
                            if ((field_match = re.key_access.exec(replacement_field)) !== null) {
                                field_list.push(field_match[1])
                            }
                            else if ((field_match = re.index_access.exec(replacement_field)) !== null) {
                                field_list.push(field_match[1])
                            }
                            else {
                                throw new SyntaxError('[sprintf] failed to parse named argument key')
                            }
                        }
                    }
                    else {
                        throw new SyntaxError('[sprintf] failed to parse named argument key')
                    }
                    match[2] = field_list
                }
                else {
                    arg_names |= 2
                }
                if (arg_names === 3) {
                    throw new Error('[sprintf] mixing positional and named placeholders is not (yet) supported')
                }

                parse_tree.push(
                    {
                        placeholder: match[0],
                        param_no:    match[1],
                        keys:        match[2],
                        sign:        match[3],
                        pad_char:    match[4],
                        align:       match[5],
                        width:       match[6],
                        precision:   match[7],
                        type:        match[8]
                    }
                )
            }
            else {
                throw new SyntaxError('[sprintf] unexpected placeholder')
            }
            _fmt = _fmt.substring(match[0].length)
        }
        return sprintf_cache[fmt] = parse_tree
    }

    /**
     * export to either browser or node.js
     */
    /* eslint-disable quote-props */
    if (typeof exports !== 'undefined') {
        exports['sprintf'] = sprintf
        exports['vsprintf'] = vsprintf
    }
    if (typeof window !== 'undefined') {
        window['sprintf'] = sprintf
        window['vsprintf'] = vsprintf

        if (typeof define === 'function' && define['amd']) {
            define(function() {
                return {
                    'sprintf': sprintf,
                    'vsprintf': vsprintf
                }
            })
        }
    }
    /* eslint-enable quote-props */
}(); // eslint-disable-line